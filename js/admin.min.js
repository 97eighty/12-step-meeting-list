jQuery(function(){function t(e,t){if(!e||!t){jQuery("div#map").html("");return}var n=new google.maps.LatLng(e,t),r=new google.maps.Map(document.getElementById("map"),{zoom:16,zoomControl:!1,scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,center:n}),i=new google.maps.Marker({position:n,map:r})}var e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:myAjax.ajaxurl+"?action=location&q=%QUERY",ttl:10}});e.initialize();jQuery("input#location").typeahead(null,{displayKey:"value",source:e.ttAdapter()}).on("typeahead:autocompleted",function(e,n){jQuery("input[name=address]").val(n.address);jQuery("input[name=latitude]").val(n.latitude);jQuery("input[name=longitude]").val(n.longitude);jQuery("select[name=region] option[value='"+n.region+"']").attr("selected","selected");t(n.latitude,n.longitude)});jQuery("input#address").blur(function(){var e=jQuery(this).val();if(!e.length){t();jQuery("input#latitude").val("");jQuery("input#longitude").val("");return}jQuery.getJSON("https://maps.googleapis.com/maps/api/geocode/json",{address:e,sensor:!1},function(n){jQuery("input#address").val(n.results[0].formatted_address);var r=n.results[0].geometry.location.lat,i=n.results[0].geometry.location.lng;jQuery("input#latitude").val(r);jQuery("input#longitude").val(i);t(r,i);if(e!=n.results[0].formatted_address){e=n.results[0].formatted_address;jQuery("select#region option").each(function(){if(e.indexOf(jQuery(this).text())!=-1){jQuery(this).attr("selected","selected");return!1}})}})});t(jQuery("input#latitude").val(),jQuery("input#longitude").val())});