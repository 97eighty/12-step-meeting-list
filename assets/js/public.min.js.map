{"version":3,"sources":["jquery.mark.js","public.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACngBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"public.min.js","sourcesContent":["/*!***************************************************\n * mark.js v7.0.2\n * https://github.com/julmot/mark.js\n * Copyright (c) 2014–2016, Julian Motz\n * Released under the MIT license https://git.io/vwTVl\n *****************************************************/\n\n\"use strict\";\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (factory, window, document) {\n    if (typeof define === \"function\" && define.amd) {\n        define([\"jquery\"], function (jQuery) {\n            return factory(window, document, jQuery);\n        });\n    } else if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && module.exports) {\n        module.exports = factory(window, document, require(\"jquery\"));\n    } else {\n        factory(window, document, jQuery);\n    }\n})(function (window, document, $) {\n    var Mark = function () {\n        function Mark(ctx) {\n            _classCallCheck(this, Mark);\n\n            this.ctx = ctx;\n        }\n\n        _createClass(Mark, [{\n            key: \"log\",\n            value: function log(msg) {\n                var level = arguments.length <= 1 || arguments[1] === undefined ? \"debug\" : arguments[1];\n\n                var log = this.opt.log;\n                if (!this.opt.debug) {\n                    return;\n                }\n                if ((typeof log === \"undefined\" ? \"undefined\" : _typeof(log)) === \"object\" && typeof log[level] === \"function\") {\n                    log[level](\"mark.js: \" + msg);\n                }\n            }\n        }, {\n            key: \"escapeStr\",\n            value: function escapeStr(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            }\n        }, {\n            key: \"createRegExp\",\n            value: function createRegExp(str) {\n                str = this.escapeStr(str);\n                if (Object.keys(this.opt.synonyms).length) {\n                    str = this.createSynonymsRegExp(str);\n                }\n                if (this.opt.diacritics) {\n                    str = this.createDiacriticsRegExp(str);\n                }\n                str = this.createMergedBlanksRegExp(str);\n                str = this.createAccuracyRegExp(str);\n                return str;\n            }\n        }, {\n            key: \"createSynonymsRegExp\",\n            value: function createSynonymsRegExp(str) {\n                var syn = this.opt.synonyms;\n                for (var index in syn) {\n                    if (syn.hasOwnProperty(index)) {\n                        var value = syn[index],\n                            k1 = this.escapeStr(index),\n                            k2 = this.escapeStr(value);\n                        str = str.replace(new RegExp(\"(\" + k1 + \"|\" + k2 + \")\", \"gmi\"), \"(\" + k1 + \"|\" + k2 + \")\");\n                    }\n                }\n                return str;\n            }\n        }, {\n            key: \"createDiacriticsRegExp\",\n            value: function createDiacriticsRegExp(str) {\n                var dct = [\"aÀÁÂÃÄÅàáâãäåĀāąĄ\", \"cÇçćĆčČ\", \"dđĐďĎ\", \"eÈÉÊËèéêëěĚĒēęĘ\", \"iÌÍÎÏìíîïĪī\", \"lłŁ\", \"nÑñňŇńŃ\", \"oÒÓÔÕÕÖØòóôõöøŌō\", \"rřŘ\", \"sŠšśŚ\", \"tťŤ\", \"uÙÚÛÜùúûüůŮŪū\", \"yŸÿýÝ\", \"zŽžżŻźŹ\"];\n                var handled = [];\n                str.split(\"\").forEach(function (ch) {\n                    dct.every(function (dct) {\n                        if (dct.indexOf(ch) !== -1) {\n                            if (handled.indexOf(dct) > -1) {\n                                return false;\n                            }\n\n                            str = str.replace(new RegExp(\"[\" + dct + \"]\", \"gmi\"), \"[\" + dct + \"]\");\n                            handled.push(dct);\n                        }\n                        return true;\n                    });\n                });\n                return str;\n            }\n        }, {\n            key: \"createMergedBlanksRegExp\",\n            value: function createMergedBlanksRegExp(str) {\n                return str.replace(/[\\s]+/gmi, \"[\\\\s]*\");\n            }\n        }, {\n            key: \"createAccuracyRegExp\",\n            value: function createAccuracyRegExp(str) {\n                var _this = this;\n\n                var acc = this.opt.accuracy,\n                    val = typeof acc === \"string\" ? acc : acc.value,\n                    ls = typeof acc === \"string\" ? [] : acc.limiters,\n                    lsJoin = \"\";\n                ls.forEach(function (limiter) {\n                    lsJoin += \"|\" + _this.escapeStr(limiter);\n                });\n                switch (val) {\n                    case \"partially\":\n                        return \"()(\" + str + \")\";\n                    case \"complementary\":\n                        return \"()([^\\\\s\" + lsJoin + \"]*\" + str + \"[^\\\\s\" + lsJoin + \"]*)\";\n                    case \"exactly\":\n                        return \"(^|\\\\s\" + lsJoin + \")(\" + str + \")(?=$|\\\\s\" + lsJoin + \")\";\n                }\n            }\n        }, {\n            key: \"getSeparatedKeywords\",\n            value: function getSeparatedKeywords(sv) {\n                var _this2 = this;\n\n                var stack = [];\n                sv.forEach(function (kw) {\n                    if (!_this2.opt.separateWordSearch) {\n                        if (kw.trim()) {\n                            stack.push(kw);\n                        }\n                    } else {\n                        kw.split(\" \").forEach(function (kwSplitted) {\n                            if (kwSplitted.trim()) {\n                                stack.push(kwSplitted);\n                            }\n                        });\n                    }\n                });\n                return {\n                    \"keywords\": stack,\n                    \"length\": stack.length\n                };\n            }\n        }, {\n            key: \"getElements\",\n            value: function getElements() {\n                var ctx = void 0,\n                    stack = [];\n                if (typeof this.ctx === \"undefined\") {\n                    ctx = [];\n                } else if (this.ctx instanceof HTMLElement) {\n                    ctx = [this.ctx];\n                } else if (Array.isArray(this.ctx)) {\n                    ctx = this.ctx;\n                } else {\n                    ctx = Array.prototype.slice.call(this.ctx);\n                }\n                ctx.forEach(function (ctx) {\n                    if (stack.indexOf(ctx) === -1) {\n                        stack.push(ctx);\n                        var childs = ctx.querySelectorAll(\"*\");\n                        if (childs.length) {\n                            stack = stack.concat(Array.prototype.slice.call(childs));\n                        }\n                    }\n                });\n                if (!ctx.length) {\n                    this.log(\"Empty context\", \"warn\");\n                }\n                return {\n                    \"elements\": stack,\n                    \"length\": stack.length\n                };\n            }\n        }, {\n            key: \"matches\",\n            value: function matches(el, selector) {\n                return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);\n            }\n        }, {\n            key: \"matchesExclude\",\n            value: function matchesExclude(el, exclM) {\n                var _this3 = this;\n\n                var remain = true;\n                var excl = this.opt.exclude.concat([\"script\", \"style\", \"title\"]);\n                if (!this.opt.iframes) {\n                    excl = excl.concat([\"iframe\"]);\n                }\n                if (exclM) {\n                    excl = excl.concat([\"*[data-markjs='true']\"]);\n                }\n                excl.every(function (sel) {\n                    if (_this3.matches(el, sel)) {\n                        return remain = false;\n                    }\n                    return true;\n                });\n                return !remain;\n            }\n        }, {\n            key: \"onIframeReady\",\n            value: function onIframeReady(ifr, successFn, errorFn) {\n                try {\n                    (function () {\n                        var ifrWin = ifr.contentWindow,\n                            bl = \"about:blank\",\n                            compl = \"complete\";\n                        var callCallback = function callCallback() {\n                            try {\n                                if (ifrWin.document === null) {\n                                    throw new Error(\"iframe inaccessible\");\n                                }\n                                successFn(ifrWin.document);\n                            } catch (e) {\n                                errorFn();\n                            }\n                        };\n                        var isBlank = function isBlank() {\n                            var src = ifr.getAttribute(\"src\").trim(),\n                                href = ifrWin.location.href;\n                            return href === bl && src !== bl && src;\n                        };\n                        var observeOnload = function observeOnload() {\n                            var listener = function listener() {\n                                try {\n                                    if (!isBlank()) {\n                                        ifr.removeEventListener(\"load\", listener);\n                                        callCallback();\n                                    }\n                                } catch (e) {\n                                    errorFn();\n                                }\n                            };\n                            ifr.addEventListener(\"load\", listener);\n                        };\n                        if (ifrWin.document.readyState === compl) {\n                            if (isBlank()) {\n                                observeOnload();\n                            } else {\n                                callCallback();\n                            }\n                        } else {\n                            observeOnload();\n                        }\n                    })();\n                } catch (e) {\n                    errorFn();\n                }\n            }\n        }, {\n            key: \"forEachElementInIframe\",\n            value: function forEachElementInIframe(ifr, cb) {\n                var _this4 = this;\n\n                var end = arguments.length <= 2 || arguments[2] === undefined ? function () {} : arguments[2];\n\n                var open = 0;\n                var checkEnd = function checkEnd() {\n                    if (--open < 1) {\n                        end();\n                    }\n                };\n                this.onIframeReady(ifr, function (con) {\n                    var stack = Array.prototype.slice.call(con.querySelectorAll(\"*\"));\n                    if ((open = stack.length) === 0) {\n                        checkEnd();\n                    }\n                    stack.forEach(function (el) {\n                        if (el.tagName.toLowerCase() === \"iframe\") {\n                            (function () {\n                                var j = 0;\n                                _this4.forEachElementInIframe(el, function (iel, len) {\n                                    cb(iel, len);\n                                    if (len - 1 === j) {\n                                        checkEnd();\n                                    }\n                                    j++;\n                                }, checkEnd);\n                            })();\n                        } else {\n                            cb(el, stack.length);\n                            checkEnd();\n                        }\n                    });\n                }, function () {\n                    var src = ifr.getAttribute(\"src\");\n                    _this4.log(\"iframe '\" + src + \"' could not be accessed\", \"warn\");\n                    checkEnd();\n                });\n            }\n        }, {\n            key: \"forEachElement\",\n            value: function forEachElement(cb) {\n                var _this5 = this;\n\n                var end = arguments.length <= 1 || arguments[1] === undefined ? function () {} : arguments[1];\n                var exclM = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];\n\n                var _getElements = this.getElements();\n\n                var stack = _getElements.elements;\n                var open = _getElements.length;\n\n                var checkEnd = function checkEnd() {\n                    if (--open === 0) {\n                        end();\n                    }\n                };\n                checkEnd(++open);\n                stack.forEach(function (el) {\n                    if (!_this5.matchesExclude(el, exclM)) {\n                        if (el.tagName.toLowerCase() === \"iframe\") {\n                            _this5.forEachElementInIframe(el, function (iel) {\n                                if (!_this5.matchesExclude(iel, exclM)) {\n                                    cb(iel);\n                                }\n                            }, checkEnd);\n                            return;\n                        } else {\n                                cb(el);\n                            }\n                    }\n                    checkEnd();\n                });\n            }\n        }, {\n            key: \"forEachNode\",\n            value: function forEachNode(cb) {\n                var end = arguments.length <= 1 || arguments[1] === undefined ? function () {} : arguments[1];\n\n                this.forEachElement(function (n) {\n                    for (n = n.firstChild; n; n = n.nextSibling) {\n                        if (n.nodeType === 3 && n.textContent.trim()) {\n                            cb(n);\n                        }\n                    }\n                }, end);\n            }\n        }, {\n            key: \"wrapMatches\",\n            value: function wrapMatches(node, regex, custom, filterCb, eachCb) {\n                var hEl = !this.opt.element ? \"mark\" : this.opt.element,\n                    index = custom ? 0 : 2;\n                var match = void 0;\n                while ((match = regex.exec(node.textContent)) !== null) {\n                    if (!filterCb(match[index])) {\n                        continue;\n                    }\n\n                    var pos = match.index;\n                    if (!custom) {\n                        pos += match[index - 1].length;\n                    }\n                    var startNode = node.splitText(pos);\n\n                    node = startNode.splitText(match[index].length);\n                    if (startNode.parentNode !== null) {\n                        var repl = document.createElement(hEl);\n                        repl.setAttribute(\"data-markjs\", \"true\");\n                        if (this.opt.className) {\n                            repl.setAttribute(\"class\", this.opt.className);\n                        }\n                        repl.textContent = match[index];\n                        startNode.parentNode.replaceChild(repl, startNode);\n                        eachCb(repl);\n                    }\n                    regex.lastIndex = 0;\n                }\n            }\n        }, {\n            key: \"unwrapMatches\",\n            value: function unwrapMatches(node) {\n                var parent = node.parentNode;\n                var docFrag = document.createDocumentFragment();\n                while (node.firstChild) {\n                    docFrag.appendChild(node.removeChild(node.firstChild));\n                }\n                parent.replaceChild(docFrag, node);\n                parent.normalize();\n            }\n        }, {\n            key: \"markRegExp\",\n            value: function markRegExp(regexp, opt) {\n                var _this6 = this;\n\n                this.opt = opt;\n                this.log(\"Searching with expression \\\"\" + regexp + \"\\\"\");\n                var totalMatches = 0;\n                var eachCb = function eachCb(element) {\n                    totalMatches++;\n                    _this6.opt.each(element);\n                };\n                this.forEachNode(function (node) {\n                    _this6.wrapMatches(node, regexp, true, function (match) {\n                        return _this6.opt.filter(node, match, totalMatches);\n                    }, eachCb);\n                }, function () {\n                    if (totalMatches === 0) {\n                        _this6.opt.noMatch(regexp);\n                    }\n                    _this6.opt.done(totalMatches);\n                });\n            }\n        }, {\n            key: \"mark\",\n            value: function mark(sv, opt) {\n                var _this7 = this;\n\n                this.opt = opt;\n\n                var _getSeparatedKeywords = this.getSeparatedKeywords(typeof sv === \"string\" ? [sv] : sv);\n\n                var kwArr = _getSeparatedKeywords.keywords;\n                var kwArrLen = _getSeparatedKeywords.length;\n\n                var totalMatches = 0;\n                if (kwArrLen === 0) {\n                    this.opt.done(totalMatches);\n                }\n                kwArr.forEach(function (kw) {\n                    var regex = new RegExp(_this7.createRegExp(kw), \"gmi\"),\n                        matches = 0;\n                    var eachCb = function eachCb(element) {\n                        matches++;\n                        totalMatches++;\n                        _this7.opt.each(element);\n                    };\n                    _this7.log(\"Searching with expression \\\"\" + regex + \"\\\"\");\n                    _this7.forEachNode(function (node) {\n                        _this7.wrapMatches(node, regex, false, function () {\n                            return _this7.opt.filter(node, kw, matches, totalMatches);\n                        }, eachCb);\n                    }, function () {\n                        if (matches === 0) {\n                            _this7.opt.noMatch(kw);\n                        }\n                        if (kwArr[kwArrLen - 1] === kw) {\n                            _this7.opt.done(totalMatches);\n                        }\n                    });\n                });\n            }\n        }, {\n            key: \"unmark\",\n            value: function unmark(opt) {\n                var _this8 = this;\n\n                this.opt = opt;\n                var sel = this.opt.element ? this.opt.element : \"*\";\n                sel += \"[data-markjs]\";\n                if (this.opt.className) {\n                    sel += \".\" + this.opt.className;\n                }\n                this.log(\"Removal selector \\\"\" + sel + \"\\\"\");\n                this.forEachElement(function (el) {\n                    if (_this8.matches(el, sel)) {\n                        _this8.unwrapMatches(el);\n                    }\n                }, function () {\n                    _this8.opt.done();\n                }, false);\n            }\n        }, {\n            key: \"opt\",\n            set: function set(val) {\n                this._opt = _extends({}, {\n                    \"element\": \"\",\n                    \"className\": \"\",\n                    \"exclude\": [],\n                    \"iframes\": false,\n                    \"separateWordSearch\": true,\n                    \"diacritics\": true,\n                    \"synonyms\": {},\n                    \"accuracy\": \"partially\",\n                    \"each\": function each() {},\n                    \"noMatch\": function noMatch() {},\n                    \"filter\": function filter() {\n                        return true;\n                    },\n                    \"done\": function done() {},\n                    \"debug\": false,\n                    \"log\": window.console\n                }, val);\n            },\n            get: function get() {\n                return this._opt;\n            }\n        }]);\n\n        return Mark;\n    }();\n\n    $.fn.mark = function (sv, opt) {\n        new Mark(this).mark(sv, opt);\n        return this;\n    };\n    $.fn.markRegExp = function (regexp, opt) {\n        new Mark(this).markRegExp(regexp, opt);\n        return this;\n    };\n    $.fn.unmark = function (opt) {\n        new Mark(this).unmark(opt);\n        return this;\n    };\n    return $;\n}, window, document);\n","jQuery(function($){\n\t\n\t//single meeting page feedback form\n\t$('#meeting #feedback a[href=\"#report\"]').click(function(e){\n\t\te.preventDefault();\n\t\t$(this).closest('#feedback').attr('class', 'form');\n\t});\n\t\n\t$('#meeting #feedback a[href=\"#cancel\"]').click(function(e){\n\t\te.preventDefault();\n\t\t$(this).closest('#feedback').attr('class', '');\n\t});\n\t\n\t$('#meeting #feedback form').validate({\n\t\tonfocusout:false,\n    \tonkeyup: function(element) { },\n\t\thighlight: function(element, errorClass, validClass) {\n\t\t\t$(element).closest('div.form-group').addClass('has-error');\n\t\t},\n\t\tunhighlight: function(element, errorClass, validClass) {\n\t\t\t$(element).closest('div.form-group').removeClass('has-error');\n\t\t},\n\t\terrorPlacement: function(error, element) {\n\t\t\treturn; //don't show message on page, simply highlight\n\t\t}, \n\t\tsubmitHandler: function(form){\n\t\t\tvar $form = $(form),\n\t\t\t\t$feedback = $form.closest('#feedback'), \n\t\t\t\t$alert = $feedback.find('.alert').first();\n\t\t\t$.post(myAjax.ajaxurl, $form.serialize(), function(data) {\n\t\t\t\t$alert.removeClass('alert-danger').addClass('alert-warning').html(data);\n\t\t\t\t$feedback.attr('class', 'confirm');\n\t\t\t}).fail(function(response) {\n\t\t\t\t$alert.removeClass('alert-warning').addClass('alert-danger').html('Email was not sent.');\n\t\t\t\t$feedback.attr('class', 'confirm');\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\t});\n\t\n\t//meetings list page\n\tvar userMarker;\n\tif ((location.protocol === 'https:') && navigator.geolocation) {\n\t\t$('li.geolocator').removeClass('hidden');\n\t}\n\n\t//run search (triggered by dropdown toggle or form submit)\n\tfunction doSearch() {\n\n\t\t//prepare data for ajax\n\t\tvar data = { \n\t\t\taction: 'meetings',\n\t\t\tsearch: $('#search input[name=query]').val().trim(),\n\t\t\tday: \t$('#day li.active a').attr('data-id'),\n\t\t\ttime:   $('#time li.active a').attr('data-id'),\n\t\t\tregion: $('#region li.active a').attr('data-id'),\n\t\t\ttype:   $('#type li.active a').attr('data-id'),\n\t\t}\n\t\t\n\t\t//get current query string for history and appending to links\n\t\tvar querystring = {};\n\t\tif (data.search) querystring.sq = data.search;\n\t\tquerystring.d = data.day ? data.day : 'any';\n\t\tif (data.time) querystring.i = data.time;\n\t\tif (data.region) querystring.r = data.region;\n\t\tif (data.type) querystring.t = data.type;\n\t\tquerystring.v = $('#meetings .toggle-view.active').attr('data-id');\n\t\tquerystring = jQuery.param(querystring);\n\t\t//console.log('querystring is ' + querystring)\n\t\t\n\t\t//save the query in the query string, if the browser is up to it\n\t\tif (history.pushState) {\n\t\t\tvar url = window.location.protocol + '//' + window.location.host + window.location.pathname;\n\t\t\tif (querystring.length) url = url + '?' + querystring;\n\t\t\tif (location.search.indexOf('post_type=meetings') > -1) {\n\t\t\t\turl = url + ((url.indexOf('?') > -1) ? '&' : '?') + 'post_type=meetings';\n\t\t\t}\n\t\t\twindow.history.pushState({path:url}, '', url);\n\t\t}\n\t\t\n\t\t//debugging\n\t\t//console.log(myAjax.ajaxurl)\n\t\t//console.log(data);\n\n\t\t//request new meetings result\n\t\tjQuery.post(myAjax.ajaxurl, data, function(response){\n\t\t\tif (!response.length) {\n\n\t\t\t\t//if keyword and no results, clear other parameters and search again\n\t\t\t\tif (data.search && (typeof data.day !== 'undefined' || typeof data.region !== 'undefined' || typeof data.time !== 'undefined' || typeof data.type !== 'undefined')) {\n\t\t\t\t\t$('#day li').removeClass('active').first().addClass('active');\n\t\t\t\t\t$('#time li').removeClass('active').first().addClass('active');\n\t\t\t\t\t$('#region li').removeClass('active').first().addClass('active');\n\t\t\t\t\t$('#type li').removeClass('active').first().addClass('active');\n\n\t\t\t\t\t//set selected text\n\t\t\t\t\t$('#day span.selected').html($('#day li:first-child a').html());\n\t\t\t\t\t$('#time span.selected').html($('#time li:first-child a').html());\n\t\t\t\t\t$('#region span.selected').html($('#region li:first-child a').html());\n\t\t\t\t\t$('#type span.selected').html($('#type li:first-child a').html());\n\t\t\t\t\treturn doSearch();\n\t\t\t\t}\n\n\t\t\t\t$('#meetings table').addClass('hidden');\n\t\t\t\t$('#meetings #map').addClass('hidden');\n\t\t\t\t$('#alert').html('No results matched those criteria.').removeClass('hidden');\n\t\t\t} else {\n\t\t\t\t$('#meetings table').removeClass('hidden');\n\t\t\t\tif ($('#meetings #map').hasClass('hidden')) {\n\t\t\t\t\t$('#meetings #map').removeClass('hidden');\n\t\t\t\t\tgoogle.maps.event.trigger(map, 'resize');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t$('#alert').addClass('hidden');\n\n\t\t\t\tvar locations = [];\n\n\t\t\t\tvar tbody = $('#meetings_tbody').html('');\n\n\t\t\t\t//loop through JSON meetings\n\t\t\t\tjQuery.each(response, function(index, obj){\n\n\t\t\t\t\t//add gender designation\n\t\t\t\t\tif (jQuery.inArray('M', obj.types) != -1) {\n\t\t\t\t\t\tobj.name += ' <small>Men</small>';\n\t\t\t\t\t} else if (jQuery.inArray('W', obj.types) != -1) {\n\t\t\t\t\t\tobj.name += ' <small>Women</small>';\n\t\t\t\t\t}\n\n\t\t\t\t\t//save location info\n\t\t\t\t\tif (!locations[obj.location_id]) {\n\t\t\t\t\t\tlocations[obj.location_id] = {\n\t\t\t\t\t\t\tname: obj.location,\n\t\t\t\t\t\t\taddress: obj.address,\n\t\t\t\t\t\t\tlatitude: obj.latitude,\n\t\t\t\t\t\t\tlongitude: obj.longitude,\n\t\t\t\t\t\t\tcity: obj.city,\n\t\t\t\t\t\t\tstate: obj.state,\n\t\t\t\t\t\t\turl: obj.location_url,\n\t\t\t\t\t\t\tmeetings: []\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t//push meeting on to location\n\t\t\t\t\tlocations[obj.location_id].meetings[locations[obj.location_id].meetings.length] = {\n\t\t\t\t\t\tname : obj.name,\n\t\t\t\t\t\ttime : obj.time_formatted,\n\t\t\t\t\t\tday : obj.day,\n\t\t\t\t\t\tnotes : obj.notes,\n\t\t\t\t\t\turl : obj.url\n\t\t\t\t\t};\n\n\t\t\t\t\tvar sort_time = obj.day + '-' + (obj.time == '00:00' ? '23:59' : obj.time);\n\t\t\t\t\t\n\t\t\t\t\t//add new table row\n\t\t\t\t\ttbody.append('<tr>' + \n\t\t\t\t\t\t'<td class=\"time\" data-sort=\"' + sort_time + '\"><span>' + (data.day || !obj.day ? obj.time_formatted : days[obj.day] + '</span><span>' + obj.time_formatted) + '</span></td>' + \n\t\t\t\t\t\t'<td class=\"name\" data-sort=\"' + obj.name + '-' + sort_time + '\">' + formatLink(obj.url, obj.name, 'post_type') + '</td>' + \n\t\t\t\t\t\t'<td class=\"location\" data-sort=\"' + obj.location + '-' + sort_time + '\">' + obj.location + '</td>' + \n\t\t\t\t\t\t'<td class=\"address\" data-sort=\"' + obj.address + '-' + sort_time + '\">' + obj.address + '</td>' + \n\t\t\t\t\t\t'<td class=\"region\" data-sort=\"' + (obj.sub_region || obj.region || '') + '-' + sort_time + '\">' + (obj.sub_region || obj.region || '') + '</td>' + \n\t\t\t\t\t\t'<td class=\"types\" data-sort=\"' + decodeMeetingTypes(obj.types) + '-' + sort_time + '\">' + decodeMeetingTypes(obj.types) + '</td>' + \n\t\t\t\t\t'</tr>')\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tsortMeetings();\n\t\t\t\t\n\t\t\t\tif (data.search) $('#meetings .results tbody').mark(data.search);\n\n\t\t\t\t//remove old markers and reset bounds\n\t\t\t\tfor (var i = 0; i < markers.length; i++) markers[i].setMap(null);\n\t\t\t\tmarkers = [];\n\t\t\t\tbounds = new google.maps.LatLngBounds;\n\n\t\t\t\tloadMap(locations);\n\t\t\t}\n\t\t}, 'json');\t\n\t}\n\t\n\t//table sorting\n\t$('#meetings table thead').on('click', 'th', function(){\n\t\tvar sort = $(this).attr('class');\n\t\tvar order;\n\n\t\t//update header\n\t\tif ($(this).attr('data-sort')) {\n\t\t\torder = ($(this).attr('data-sort') == 'asc') ? 'desc' : 'asc';\n\t\t} else {\n\t\t\torder = 'asc';\n\t\t}\n\t\t$('#meetings table thead th').removeAttr('data-sort');\n\t\t$('#meetings table thead th.' + sort).attr('data-sort', order);\n\t\tsortMeetings();\n\t});\n\t\n\tfunction sortMeetings() {\n\t\tvar $sorted = $('#meetings table thead th[data-sort]').first();\n\t\tvar sort = $sorted.attr('class');\n\t\tvar order = $sorted.attr('data-sort');\n\t\tvar tbody = document.getElementById('meetings_tbody');\n\t\tvar store = [];\n\t\tvar sort_index = $('#meetings table thead th').index($sorted);\n\n\t\t//execute sort\n\t\tfor (var i = 0, len = tbody.rows.length; i < len; i++) {\n\t\t\tvar row = tbody.rows[i];\n\t\t\tstore.push([row.cells[sort_index].getAttribute('data-sort'), row]);\n\t\t}\n\t\tstore.sort(function(x,y){\n\t\t\tif (x[0] > y[0]) return (order == 'asc') ? 1 : -1;\n\t\t\tif (x[0] < y[0]) return (order == 'asc') ? -1 : 1;\n\t\t\treturn 0;\n\t\t});\n\t\tfor (var i = 0, len = store.length; i < len; i++){\n\t\t\ttbody.appendChild(store[i][1]);\n\t\t}\t\t\n\t}\n\t\n\t//capture submit event\n\t$('#meetings #search').submit(function(e){\n\t\tdoSearch();\n\t\treturn false;\n\t});\n\t\n\t//if already searching, mark results\n\tvar $search_field = $('#meetings #search input[name=query]');\n\tif ($search_field.size() && $search_field.val().length) {\n\t\t$('#meetings .results tbody').mark($search_field.val());\n\t}\n\n\t//capture dropdown change\n\t$('#meetings .controls').on('click', '.dropdown-menu a', function(e){\n\t\te.preventDefault();\n\n\t\t//day only one selected\n\t\tif ($(this).closest('.dropdown').attr('id') == 'day') {\n\t\t\t$('#day li').removeClass('active');\n\t\t\t$('#day span.selected').html($(this).html());\n\t\t}\n\n\t\t//times only one\n\t\tif ($(this).closest('.dropdown').attr('id') == 'time') {\n\t\t\t$('#time li').removeClass('active');\n\t\t\t$('#time span.selected').html($(this).html());\n\t\t}\n\n\t\t//location only one\n\t\tif ($(this).closest('.dropdown').attr('id') == 'region') {\n\t\t\t$('#region li').removeClass('active');\n\t\t\t$('#region span.selected').html($(this).html());\n\t\t}\n\n\t\t//type only one\n\t\tif ($(this).closest('.dropdown').attr('id') == 'type') {\n\t\t\t$('#type li').removeClass('active');\n\t\t\t$('#type span.selected').html($(this).html());\n\t\t}\n\n\t\t$(this).parent().toggleClass('active');\n\n\t\tupdateTitle();\n\t\tdoSearch();\n\t});\n\n\t//toggle between list and map\n\t$('#meetings #action .toggle-view').click(function(e){\n\t\te.preventDefault();\n\t\t\n\t\t//what's going on\n\t\tvar action = $(this).attr('data-id');\n\t\tvar previous = $('#meetings').attr('data-type');\n\n\t\t//save the query in the query string, if the browser is up to it\n\t\tif (history.pushState) {\n\t\t\tvar url = updateQueryString('v', action);\n\t\t\twindow.history.pushState({path:url}, '', url);\n\t\t}\n\t\t\n\t\t//toggle control, meetings div\n\t\tif (action == 'list') {\n\t\t\tcloseFullscreen();\n\t\t\t$('#meetings #action .toggle-view[data-id=list]').addClass('active');\n\t\t\t$('#meetings #action .toggle-view[data-id=map]').removeClass('active');\t\t\t\n\t\t} else if (action == 'map') {\n\t\t\t$('#meetings #action .toggle-view[data-id=map]').addClass('active');\n\t\t\t$('#meetings #action .toggle-view[data-id=list]').removeClass('active');\t\t\t\n\t\t}\n\n\t\t//set meetings div\n\t\t$('#meetings').attr('data-type', action);\n\t\t\n\t\t//wake up the map if needed\n\t\tif (action == 'map' && action != previous) {\n\t\t\tgoogle.maps.event.trigger(map, 'resize');\n\t\t\tmap.fitBounds(bounds);\n\t   \t\tif ((markers.length == 1) && $('#map').is(':visible')) {\n\t   \t\t\tmap.setZoom(14);\n\t   \t\t\tgoogle.maps.event.trigger(markers[0],'click');\n\t   \t\t}\n\t\t}\n\t});\n\n\t$('a[href=\"#geolocator\"]').click(function(e){\n\t\te.preventDefault();\n\t\t$(this).toggleClass('active');\n\n\t\tif ($(this).hasClass('active')) {\n\t\t\tnavigator.geolocation.getCurrentPosition(function(position) {\n\t\t\t\tvar pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n\n\t\t\t\tuserMarker = new google.maps.Marker({\n\t\t\t\t\ticon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',\n\t\t\t\t\tposition: pos,\n\t\t\t\t\tmap: map,\n\t\t\t\t\ttitle: 'You'\n\t\t\t\t});\n\n\t\t\t\tmap.setCenter(pos);\n\t\t\t\tmap.setZoom(13);\n\t\t\t}, function(err) {\n  \t\t\t\tconsole.log('ERROR(' + err.code + '): ' + err.message);\n  \t\t\t\t$(this).removeClass('active')\n  \t\t\t});\n\t\t} else if (userMarker !== undefined) {\n\t\t\tuserMarker.setMap(null);\n\t\t}\n\t});\n\n\t$('a[href=\"#fullscreen\"]').click(function(e){\n\t\te.preventDefault();\n\t\tvar center = map.getCenter();\n\t\t$(this).toggleClass('active');\n\t\tif ($(this).hasClass('active')) {\n\t\t\t$('body').addClass('tsml_fullscreen');\n\t\t\tvar height = $(window).height() - 79;\n\t\t\tif ($('body').hasClass('admin-bar')) height -= 32;\n\t\t\t$('#map').css('height', height);\n\t\t} else {\n\t\t\tcloseFullscreen();\n\t\t}\n\t\tgoogle.maps.event.trigger(map, 'resize');\n\t\tmap.setCenter(center);\n\t});\n\n\t//remove fullscreen with an escape key press\n\t$(document).keyup(function(e) {\n\t\tif (e.keyCode == 27) closeFullscreen();\n\t});\n\t\n\tfunction closeFullscreen() {\n\t\tif ($('body').hasClass('tsml_fullscreen')) {\n\t\t\t$('body').removeClass('tsml_fullscreen');\n\t\t\t$('a[href=\"#fullscreen\"]').removeClass('active');\n\t\t\t$('a[href=\"#fullscreen\"]').parent().removeClass('active');\n\t\t\t$('#map').css('height', 550);\n\t\t}\n\t}\n\t\n\t//save a string of the current state to the title bar, so that it prints nicely\n\tfunction updateTitle() {\n\t\tvar string = '';\n\t\tif ($('#meetings #day li.active').index()) {\n\t\t\tstring += $('#meetings #day span.selected').text();\n\t\t}\n\t\tif ($('#meetings #time li.active').index()) {\n\t\t\tstring += ' ' + $('#meetings #time span.selected').text();\n\t\t}\n\t\tif ($('#meetings #type li.active').index()) {\n\t\t\tstring += ' ' + $('#meetings #type span.selected').text();\n\t\t}\n\t\tstring += ' Meetings';\n\t\tif ($('#meetings #region li.active').index()) {\n\t\t\tstring += ' in ' + $('#meetings #region span.selected').text();\n\t\t}\n\t\tdocument.title = string;\n\t}\n\tif ($('body').hasClass('post-type-archive-meetings')) updateTitle();\n\t\n\t//decode meeting types for ajax table rows\n\tfunction decodeMeetingTypes(codes) {\n\t\tvar return_types = [];\n\t\tfor (var i = 0; i < codes.length; i++) {\n\t\t\treturn_types[return_types.length] = myAjax.types[codes[i]];\n\t\t}\n\t\treturn_types.sort();\n\t\treturn return_types.join(', ');\n\t}\n\t\n\t//resize fullscreen on resize\n\t$(window).resize(function(e){\n\t\tif ($('#meetings').hasClass('tsml_fullscreen')) {\n\t\t\tvar center = map.getCenter();\n\t\t\tvar height = $(window).height() - 79;\n\t\t\tif ($('body').hasClass('admin-bar')) height -= 32;\n\t\t\t$('#map').css('height', height);\n\t\t\tgoogle.maps.event.trigger(map, 'resize');\n\t\t\tmap.setCenter(center);\n\t\t}\n\t});\n\t\n});\n\n//globals\nvar markers = [];\nvar map = new google.maps.Map(document.getElementById('map'), {\n\tpanControl: false,\n\tmapTypeControl: false,\n\tmapTypeControlOptions: {\n\t\tmapTypeIds: [google.maps.MapTypeId.ROADMAP, 'map_style']\n\t}\n});\nvar bounds = new google.maps.LatLngBounds();\n\nvar days = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n\nvar infowindow = new google.maps.InfoWindow();\n\n\n//load map, called from archive-meetings.php\nfunction loadMap(locations) {\n\n\tfor (var location_id in locations) {\n\t\tif (locations.hasOwnProperty(location_id)) {\n\t\t\t//console.log(locations[location_id]);\n\t\t\t\n\t\t\tvar location = locations[location_id];\n\t\t\t\n\t\t\t//set new marker\n\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\tposition: {lat: location.latitude - 0, lng: location.longitude - 0},\n\t\t\t\tmap: map,\n\t\t\t\ttitle: location.name,\n\t\t\t});\n\n\t\t\t//create infowindow content\n\t\t\tmarker.content = '<div class=\"infowindow\"><h3>' + formatLink(location.url, location.name, 'post_type') + '</h3>' +\n\t\t\t\t'<address>' + location.address + '<br>' + location.city + (location.state ? ', ' + location.state : '') + '</address>';\n\t\t\t\t\n\t\t\tvar current_day = null;\n\t\t\tfor (var i = 0; i < location.meetings.length; i++) {\n\t\t\t\tvar meeting = location.meetings[i];\n\t\t\t\tif (current_day != meeting.day) {\n\t\t\t\t\tif (current_day) marker.content += '</dl>';\n\t\t\t\t\tcurrent_day = meeting.day;\n\t\t\t\t\tif (typeof days[current_day] !== 'undefined') marker.content += '<h5>' + days[current_day] + '</h5>';\n\t\t\t\t\tmarker.content += '<dl>';\n\t\t\t\t}\n\t\t\t\tmarker.content += '<dt>' + meeting.time + '</dt><dd>' + formatLink(meeting.url, meeting.name, 'post_type') + '</dd>';\n\t\t\t}\n\t\t\tmarker.content += '</dl></div>';\n\t\t\t\n\t\t\t//add infowindow event\n\t\t\tgoogle.maps.event.addListener(marker, 'click', (function(marker) {\n\t\t\t\treturn function() {\n\t\t\t\t\tinfowindow.setContent(marker.content);\n\t\t\t\t\tinfowindow.open(map, marker);\n\t\t\t\t}\n\t\t\t})(marker));\n\t\n\t\t\t//add to map bounds\n\t\t\tbounds.extend(marker.position);\n\t\t\t\n\t\t\tmarkers[markers.length] = marker;\n\t\t}\n\t}\n\n\tif (markers.length > 1) {\n\t\tmap.fitBounds(bounds);\n\t} else if (markers.length == 1) {\n\t\tmap.setCenter(bounds.getCenter());\n\t\tif (jQuery('#map').is(':visible')) google.maps.event.trigger(markers[0],'click');\n\t\tmap.setZoom(14);\n\t} else if (markers.length == 0) {\n\t\t//currently holds last position, not sure if that's good\n\t}\n\t\n}\n\n//format a link to a meeting result page, preserving all but the excluded query string keys\nfunction formatLink(url, text, exclude) {\n\tvar query_pairs = location.search.substr(1).split('&');\n\tvar new_query_pairs = [];\n\tfor (var i = 0; i < query_pairs.length; i++) {\n\t\tvar query_parts = query_pairs[i].split('=');\n\t\tif (query_parts[0] != exclude) new_query_pairs[new_query_pairs.length] = query_parts[0] + '=' + query_parts[1];\n\t}\n\tif (new_query_pairs.length) {\n\t\turl += ((url.indexOf('?') == -1) ? '?' : '&') + new_query_pairs.join('&');\n\t}\n\treturn '<a href=\"' + url + '\">' + text + '</a>';\n}\n\nfunction updateQueryString(key, value, url) {\n\tif (!url) url = window.location.href;\n\tvar re = new RegExp(\"([?&])\" + key + \"=.*?(&|#|$)(.*)\", \"gi\"), hash;\n\n\tif (re.test(url)) {\n\t\tif (typeof value !== 'undefined' && value !== null) {\n\t\t\treturn url.replace(re, '$1' + key + \"=\" + value + '$2$3');\n\t\t} else {\n\t\t\thash = url.split('#');\n\t\t\turl = hash[0].replace(re, '$1$3').replace(/(&|\\?)$/, '');\n\t\t\tif (typeof hash[1] !== 'undefined' && hash[1] !== null) url += '#' + hash[1];\n\t\t\treturn url;\n\t\t}\n\t} else {\n\t\tif (typeof value !== 'undefined' && value !== null) {\n\t\t\tvar separator = url.indexOf('?') !== -1 ? '&' : '?';\n\t\t\thash = url.split('#');\n\t\t\turl = hash[0] + separator + key + '=' + value;\n\t\t\tif (typeof hash[1] !== 'undefined' && hash[1] !== null) url += '#' + hash[1];\n\t\t\treturn url;\n\t\t} else {\n\t\t\treturn url;\n\t\t}\n\t}\n}\n"],"sourceRoot":"/source/"}