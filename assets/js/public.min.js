function createMap(t,e,n){if(tsml.mapbox_key)mapMode="mapbox",mapboxgl.accessToken=tsml.mapbox_key,tsmlmap||(tsmlmap=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9"}),tsmlmap.addControl(new mapboxgl.NavigationControl({showCompass:!1}))),bounds={north:!1,south:!1,east:!1,west:!1},locationIcon=window.btoa('<?xml version="1.0" encoding="utf-8"?><svg viewBox="-1.1 -1.086 43.182 63.273" xmlns="http://www.w3.org/2000/svg"><path fill="#f76458" stroke="#b3382c" stroke-width="3" d="M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z"/></svg>'),searchIcon=window.btoa('<?xml version="1.0" encoding="utf-8"?><svg viewBox="-1.1 -1.086 43.182 63.273" xmlns="http://www.w3.org/2000/svg"><path fill="#2c78b3" stroke="#2c52b3" stroke-width="3" d="M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z"/></svg>');else if(tsml.google_maps_key){if("object"!=typeof google)return void console.warn("google key present but google script not ready");mapMode="google",tsmlmap||(tsmlmap=new google.maps.Map(document.getElementById("map"),{disableDefaultUI:!0,scrollwheel:t,zoomControl:!0})),infowindow=new google.maps.InfoWindow,bounds=new google.maps.LatLngBounds}setMapMarkers(e,n)}function formatAddress(t,e){if(t=t.split(", "),e)return t[0];if("USA"==t[t.length-1]){t.pop();var n=t.pop();t[t.length-1]+=", "+n}return t.join("<br>")}function formatLink(t,e,n){if(!t)return e;if(location.search){for(var i=location.search.substr(1).split("&"),r=[],o=0;o<i.length;o++){var a=i[o].split("=");a[0]!=n&&(r[r.length]=a[0]+"="+a[1])}r.length&&(t+=(-1==t.indexOf("?")?"?":"&")+r.join("&"))}return'<a href="'+t+'">'+e+"</a>"}function removeSearchMarker(){searchLocation=null,"object"==typeof searchMarker&&searchMarker&&(searchMarker.setMap(null),searchMarker=null)}function setMapBounds(){if("google"==mapMode){if(markers.length>1)tsmlmap.fitBounds(bounds);else if(1==markers.length){var t=bounds.getCenter();markers[0].getClickable()?(tsmlmap.setCenter({lat:t.lat()+.0025,lng:t.lng()}),google.maps.event.trigger(markers[0],"click")):tsmlmap.setCenter({lat:t.lat(),lng:t.lng()}),tsmlmap.setZoom(15)}}else"mapbox"==mapMode&&(markers.length>1?tsmlmap.fitBounds([[bounds.west,bounds.south],[bounds.east,bounds.north]],{duration:0,padding:100}):1==markers.length&&(markers[0].getPopup()?(tsmlmap.setZoom(14).setCenter([bounds.east,bounds.north+.0025]),markers[0].togglePopup()):tsmlmap.setZoom(14).setCenter([bounds.east,bounds.north])))}function setMapMarker(t,e,n){if(e.lat||e.lng){var i;if("google"==mapMode)i=new google.maps.Marker({position:e,map:tsmlmap,title:t,icon:{path:"M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z",fillColor:"#f76458",fillOpacity:1,anchor:new google.maps.Point(40,50),strokeWeight:2,strokeColor:"#b3382c",scale:.6}}),n?google.maps.event.addListener(i,"click",function(t){return function(){infowindow.setContent('<div class="tsml_infowindow">'+n+"</div>"),infowindow.open(map,t)}}(i)):i.setClickable(!1);else if("mapbox"==mapMode){var r=document.createElement("div");if(r.className="marker",r.style.backgroundImage="url(data:image/svg+xml;base64,"+locationIcon+")",r.style.width="26px",r.style.height="38.4px",i=new mapboxgl.Marker(r).setLngLat(e),n){var o=new mapboxgl.Popup({offset:25});o.setHTML(n),i.setPopup(o)}i.addTo(tsmlmap)}return i}}function setMapMarkers(t,e){if(markers.length){for(var n=0;n<markers.length;n++)"google"==mapMode?markers[n].setMap(null):"mapbox"==mapMode&&markers[n].remove();markers=[]}removeSearchMarker(),e&&setSearchMarker(e);for(var i=Object.keys(t).map(function(e){return t[e]}).sort(function(t,e){return e.latitude-t.latitude}),n=0;n<i.length;n++){var r,o=i[n];if(o.url&&o.formatted_address&&(r="<h3>"+formatLink(o.url,o.name,"post_type")+"</h3><address>"+formatAddress(o.formatted_address)+"</address>",o.directions&&o.directions_url&&(r+='<a href="'+o.directions_url+'" class="btn btn-default">'+o.directions+"</a>"),o.meetings&&o.meetings.length)){for(var a=null,s=0;s<o.meetings.length;s++){var l=o.meetings[s];a!=l.day&&(a&&(r+="</dl>"),a=l.day,void 0!==tsml.days[a]&&(r+="<h5>"+tsml.days[a]+"</h5>"),r+="<dl>"),r+="<dt>"+l.time+"</dt><dd>"+formatLink(l.url,l.name,"post_type")+"</dd>"}r+="</dl>"}var u={lat:parseFloat(o.latitude),lng:parseFloat(o.longitude)},c=setMapMarker(o.name,u,r);"object"==typeof c&&c&&("google"==mapMode?bounds.extend(c.position):"mapbox"==mapMode&&((!bounds.north||u.lat>bounds.north)&&(bounds.north=u.lat),(!bounds.south||u.lat<bounds.south)&&(bounds.south=u.lat),(!bounds.east||u.lng>bounds.east)&&(bounds.east=u.lng),(!bounds.west||u.lng<bounds.west)&&(bounds.west=u.lng))),markers.push(c)}setMapBounds()}function setSearchMarker(t){if(removeSearchMarker(),t&&t.latitude)if("google"==mapMode)searchMarker=new google.maps.Marker({icon:{path:"M20.5,0.5 c11.046,0,20,8.656,20,19.333c0,10.677-12.059,21.939-20,38.667c-5.619-14.433-20-27.989-20-38.667C0.5,9.156,9.454,0.5,20.5,0.5z",fillColor:"#2c78b3",fillOpacity:1,anchor:new google.maps.Point(40,50),strokeWeight:2,strokeColor:"#2c52b3",scale:.6},position:new google.maps.LatLng(t.latitude,t.longitude),map:map}),bounds.extend(searchMarker.position);else if("mapbox"==mapMode){var e=document.createElement("div");e.className="marker",e.style.backgroundImage="url(data:image/svg+xml;base64,"+searchIcon+")",e.style.width="26px",e.style.height="38.4px",marker=new mapboxgl.Marker(e).setLngLat([t.longitude,t.latitude]).addTo(tsmlmap)}}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):t.Mark=e(t.jQuery)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;n(this,t),this.ctx=e,this.iframes=i,this.exclude=r,this.iframesTimeout=o}return i(t,[{key:"getContexts",value:function(){var t=void 0,e=[];return t=void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[],t.forEach(function(t){var n=e.filter(function(e){return e.contains(t)}).length>0;-1!==e.indexOf(t)||n||e.push(t)}),e}},{key:"getIframeContents",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=void 0;try{var r=t.contentWindow;if(i=r.document,!r||!i)throw new Error("iframe inaccessible")}catch(t){n()}i&&e(i)}},{key:"isIframeBlank",value:function(t){var e="about:blank",n=t.getAttribute("src").trim();return t.contentWindow.location.href===e&&n!==e&&n}},{key:"observeIframeLoad",value:function(t,e,n){var i=this,r=!1,o=null,a=function a(){if(!r){r=!0,clearTimeout(o);try{i.isIframeBlank(t)||(t.removeEventListener("load",a),i.getIframeContents(t,e,n))}catch(t){n()}}};t.addEventListener("load",a),o=setTimeout(a,this.iframesTimeout)}},{key:"onIframeReady",value:function(t,e,n){try{"complete"===t.contentWindow.document.readyState?this.isIframeBlank(t)?this.observeIframeLoad(t,e,n):this.getIframeContents(t,e,n):this.observeIframeLoad(t,e,n)}catch(t){n()}}},{key:"waitForIframes",value:function(t,e){var n=this,i=0;this.forEachIframe(t,function(){return!0},function(t){i++,n.waitForIframes(t.querySelector("html"),function(){--i||e()})},function(t){t||e()})}},{key:"forEachIframe",value:function(e,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=e.querySelectorAll("iframe"),s=a.length,l=0;a=Array.prototype.slice.call(a);var u=function(){--s<=0&&o(l)};s||u(),a.forEach(function(e){t.matches(e,r.exclude)?u():r.onIframeReady(e,function(t){n(e)&&(l++,i(t)),u()},u)})}},{key:"createIterator",value:function(t,e,n){return document.createNodeIterator(t,e,n,!1)}},{key:"createInstanceOnIframe",value:function(e){return new t(e.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(t,e,n){if(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING){if(null===e)return!0;if(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(t){var e=t.previousNode(),n=void 0;return n=null===e?t.nextNode():t.nextNode()&&t.nextNode(),{prevNode:e,node:n}}},{key:"checkIframeFilter",value:function(t,e,n,i){var r=!1,o=!1;return i.forEach(function(t,e){t.val===n&&(r=e,o=t.handled)}),this.compareNodeIframe(t,e,n)?(!1!==r||o?!1===r||o||(i[r].handled=!0):i.push({val:n,handled:!0}),!0):(!1===r&&i.push({val:n,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(t,e,n,i){var r=this;t.forEach(function(t){t.handled||r.getIframeContents(t.val,function(t){r.createInstanceOnIframe(t).forEachNode(e,n,i)})})}},{key:"iterateThroughNodes",value:function(t,e,n,i,r){for(var o=this,a=this.createIterator(e,t,i),s=[],l=[],u=void 0,c=void 0;function(){var t=o.getIteratorNode(a);return c=t.prevNode,u=t.node}();)this.iframes&&this.forEachIframe(e,function(t){return o.checkIframeFilter(u,c,t,s)},function(e){o.createInstanceOnIframe(e).forEachNode(t,function(t){return l.push(t)},i)}),l.push(u);l.forEach(function(t){n(t)}),this.iframes&&this.handleOpenIframes(s,t,n,i),r()}},{key:"forEachNode",value:function(t,e,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.getContexts(),a=o.length;a||r(),o.forEach(function(o){var s=function(){i.iterateThroughNodes(t,o,e,n,function(){--a<=0&&r()})};i.iframes?i.waitForIframes(o,s):s()})}}],[{key:"matches",value:function(t,e){var n="string"==typeof e?[e]:e,i=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;if(i){var r=!1;return n.every(function(e){return!i.call(t,e)||(r=!0,!1)}),r}return!1}}]),t}(),a=function(){function t(e){n(this,t),this.ctx=e,this.ie=!1;var i=window.navigator.userAgent;(i.indexOf("MSIE")>-1||i.indexOf("Trident")>-1)&&(this.ie=!0)}return i(t,[{key:"log",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",i=this.opt.log;this.opt.debug&&"object"===(void 0===i?"undefined":e(i))&&"function"==typeof i[n]&&i[n]("mark.js: "+t)}},{key:"escapeStr",value:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(t){return"disabled"!==this.opt.wildcards&&(t=this.setupWildcardsRegExp(t)),t=this.escapeStr(t),Object.keys(this.opt.synonyms).length&&(t=this.createSynonymsRegExp(t)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(t=this.setupIgnoreJoinersRegExp(t)),this.opt.diacritics&&(t=this.createDiacriticsRegExp(t)),t=this.createMergedBlanksRegExp(t),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(t=this.createJoinersRegExp(t)),"disabled"!==this.opt.wildcards&&(t=this.createWildcardsRegExp(t)),t=this.createAccuracyRegExp(t)}},{key:"createSynonymsRegExp",value:function(t){var e=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",i=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],a="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(r):this.escapeStr(r),s="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(o):this.escapeStr(o);""!==a&&""!==s&&(t=t.replace(new RegExp("("+this.escapeStr(a)+"|"+this.escapeStr(s)+")","gm"+n),i+"("+this.processSynomyms(a)+"|"+this.processSynomyms(s)+")"+i))}return t}},{key:"processSynomyms",value:function(t){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(t=this.setupIgnoreJoinersRegExp(t)),t}},{key:"setupWildcardsRegExp",value:function(t){return t=t.replace(/(?:\\)*\?/g,function(t){return"\\"===t.charAt(0)?"?":""}),t.replace(/(?:\\)*\*/g,function(t){return"\\"===t.charAt(0)?"*":""})}},{key:"createWildcardsRegExp",value:function(t){var e="withSpaces"===this.opt.wildcards;return t.replace(/\u0001/g,e?"[\\S\\s]?":"\\S?").replace(/\u0002/g,e?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(t){return t.replace(/[^(|)\\]/g,function(t,e,n){var i=n.charAt(e+1);return/[(|)\\]/.test(i)||""===i?t:t+"\0"})}},{key:"createJoinersRegExp",value:function(t){var e=[],n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&e.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&e.push("\\u00ad\\u200b\\u200c\\u200d"),e.length?t.split(/\u0000+/).join("["+e.join("")+"]*"):t}},{key:"createDiacriticsRegExp",value:function(t){var e=this.opt.caseSensitive?"":"i",n=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],i=[];return t.split("").forEach(function(r){n.every(function(n){if(-1!==n.indexOf(r)){if(i.indexOf(n)>-1)return!1;t=t.replace(new RegExp("["+n+"]","gm"+e),"["+n+"]"),i.push(n)}return!0})}),t}},{key:"createMergedBlanksRegExp",value:function(t){return t.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(t){var e=this,n=this.opt.accuracy,i="string"==typeof n?n:n.value,r="string"==typeof n?[]:n.limiters,o="";switch(r.forEach(function(t){o+="|"+e.escapeStr(t)}),i){case"partially":default:return"()("+t+")";case"complementary":return"()([^"+(o="\\s"+(o||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+t+"[^"+o+"]*)";case"exactly":return"(^|\\s"+o+")("+t+")(?=$|\\s"+o+")"}}},{key:"getSeparatedKeywords",value:function(t){var e=this,n=[];return t.forEach(function(t){e.opt.separateWordSearch?t.split(" ").forEach(function(t){t.trim()&&-1===n.indexOf(t)&&n.push(t)}):t.trim()&&-1===n.indexOf(t)&&n.push(t)}),{keywords:n.sort(function(t,e){return e.length-t.length}),length:n.length}}},{key:"isNumeric",value:function(t){return Number(parseFloat(t))==t}},{key:"checkRanges",value:function(t){var e=this;if(!Array.isArray(t)||"[object Object]"!==Object.prototype.toString.call(t[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(t),[];var n=[],i=0;return t.sort(function(t,e){return t.start-e.start}).forEach(function(t){var r=e.callNoMatchOnInvalidRanges(t,i),o=r.start,a=r.end;r.valid&&(t.start=o,t.length=a-o,n.push(t),i=a)}),n}},{key:"callNoMatchOnInvalidRanges",value:function(t,e){var n=void 0,i=void 0,r=!1;return t&&void 0!==t.start?(n=parseInt(t.start,10),i=n+parseInt(t.length,10),this.isNumeric(t.start)&&this.isNumeric(t.length)&&i-e>0&&i-n>0?r=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(t)),this.opt.noMatch(t))):(this.log("Ignoring invalid range: "+JSON.stringify(t)),this.opt.noMatch(t)),{start:n,end:i,valid:r}}},{key:"checkWhitespaceRanges",value:function(t,e,n){var i=void 0,r=!0,o=n.length,a=e-o,s=parseInt(t.start,10)-a;return s=s>o?o:s,i=s+parseInt(t.length,10),i>o&&(i=o,this.log("End range automatically set to the max value of "+o)),s<0||i-s<0||s>o||i>o?(r=!1,this.log("Invalid range: "+JSON.stringify(t)),this.opt.noMatch(t)):""===n.substring(s,i).replace(/\s+/g,"")&&(r=!1,this.log("Skipping whitespace only range: "+JSON.stringify(t)),this.opt.noMatch(t)),{start:s,end:i,valid:r}}},{key:"getTextNodes",value:function(t){var e=this,n="",i=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(t){i.push({start:n.length,end:(n+=t.textContent).length,node:t})},function(t){return e.matchesExclude(t.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){t({value:n,nodes:i})})}},{key:"matchesExclude",value:function(t){return o.matches(t,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(t,e,n){var i=this.opt.element?this.opt.element:"mark",r=t.splitText(e),o=r.splitText(n-e),a=document.createElement(i);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=r.textContent,r.parentNode.replaceChild(a,r),o}},{key:"wrapRangeInMappedTextNode",value:function(t,e,n,i,r){var o=this;t.nodes.every(function(a,s){var l=t.nodes[s+1];if(void 0===l||l.start>e){if(!i(a.node))return!1;var u=e-a.start,c=(n>a.end?a.end:n)-a.start,h=t.value.substr(0,a.start),p=t.value.substr(c+a.start);if(a.node=o.wrapRangeInTextNode(a.node,u,c),t.value=h+p,t.nodes.forEach(function(e,n){n>=s&&(t.nodes[n].start>0&&n!==s&&(t.nodes[n].start-=c),t.nodes[n].end-=c)}),n-=c,r(a.node.previousSibling,a.start),!(n>a.end))return!1;e=a.end}return!0})}},{key:"wrapMatches",value:function(t,e,n,i,r){var o=this,a=0===e?0:e+1;this.getTextNodes(function(e){e.nodes.forEach(function(e){e=e.node;for(var r=void 0;null!==(r=t.exec(e.textContent))&&""!==r[a];)if(n(r[a],e)){var s=r.index;if(0!==a)for(var l=1;l<a;l++)s+=r[l].length;e=o.wrapRangeInTextNode(e,s,s+r[a].length),i(e.previousSibling),t.lastIndex=0}}),r()})}},{key:"wrapMatchesAcrossElements",value:function(t,e,n,i,r){var o=this,a=0===e?0:e+1;this.getTextNodes(function(e){for(var s=void 0;null!==(s=t.exec(e.value))&&""!==s[a];){var l=s.index;if(0!==a)for(var u=1;u<a;u++)l+=s[u].length;var c=l+s[a].length;o.wrapRangeInMappedTextNode(e,l,c,function(t){return n(s[a],t)},function(e,n){t.lastIndex=n,i(e)})}r()})}},{key:"wrapRangeFromIndex",value:function(t,e,n,i){var r=this;this.getTextNodes(function(o){var a=o.value.length;t.forEach(function(t,i){var s=r.checkWhitespaceRanges(t,a,o.value),l=s.start,u=s.end;s.valid&&r.wrapRangeInMappedTextNode(o,l,u,function(n){return e(n,t,o.value.substring(l,u),i)},function(e){n(e,t)})}),i()})}},{key:"unwrapMatches",value:function(t){for(var e=t.parentNode,n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.removeChild(t.firstChild));e.replaceChild(n,t),this.ie?this.normalizeTextNode(e):e.normalize()}},{key:"normalizeTextNode",value:function(t){if(t){if(3===t.nodeType)for(;t.nextSibling&&3===t.nextSibling.nodeType;)t.nodeValue+=t.nextSibling.nodeValue,t.parentNode.removeChild(t.nextSibling);else this.normalizeTextNode(t.firstChild);this.normalizeTextNode(t.nextSibling)}}},{key:"markRegExp",value:function(t,e){var n=this;this.opt=e,this.log('Searching with expression "'+t+'"');var i=0,r="wrapMatches",o=function(t){i++,n.opt.each(t)};this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),this[r](t,this.opt.ignoreGroups,function(t,e){return n.opt.filter(e,t,i)},o,function(){0===i&&n.opt.noMatch(t),n.opt.done(i)})}},{key:"mark",value:function(t,e){var n=this;this.opt=e;var i=0,r="wrapMatches",o=this.getSeparatedKeywords("string"==typeof t?[t]:t),a=o.keywords,s=o.length,l=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(r="wrapMatchesAcrossElements"),0===s?this.opt.done(i):function t(e){var o=new RegExp(n.createRegExp(e),"gm"+l),u=0;n.log('Searching with expression "'+o+'"'),n[r](o,1,function(t,r){return n.opt.filter(r,e,i,u)},function(t){u++,i++,n.opt.each(t)},function(){0===u&&n.opt.noMatch(e),a[s-1]===e?n.opt.done(i):t(a[a.indexOf(e)+1])})}(a[0])}},{key:"markRanges",value:function(t,e){var n=this;this.opt=e;var i=0,r=this.checkRanges(t);r&&r.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(r)),this.wrapRangeFromIndex(r,function(t,e,i,r){return n.opt.filter(t,e,i,r)},function(t,e){i++,n.opt.each(t,e)},function(){n.opt.done(i)})):this.opt.done(i)}},{key:"unmark",value:function(t){var e=this;this.opt=t;var n=this.opt.element?this.opt.element:"*";n+="[data-markjs]",this.opt.className&&(n+="."+this.opt.className),this.log('Removal selector "'+n+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(t){e.unwrapMatches(t)},function(t){var i=o.matches(t,n),r=e.matchesExclude(t);return!i||r?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(t){this._opt=r({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},t)},get:function(){return this._opt}},{key:"iterator",get:function(){return new o(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),t}();return t.fn.mark=function(t,e){return new a(this.get()).mark(t,e),this},t.fn.markRegExp=function(t,e){return new a(this.get()).markRegExp(t,e),this},t.fn.markRanges=function(t,e){return new a(this.get()).markRanges(t,e),this},t.fn.unmark=function(t){return new a(this.get()).unmark(t),this},t}),function(t,e){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,l=arguments;return o=function(){i=null,n||(r=t.apply(s,l))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,l)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var l=new Date,u=e-(l-a);return n=this,i=arguments,u<=0?(clearTimeout(r),r=null,a=l,o=t.apply(n,i)):r||(r=setTimeout(s,u)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),o=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||s,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function o(e){return t.parseJSON(e)}function a(t){var e,n,i=[],r=s.length;for(e=0;e<r;e++)(n=s.key(e)).match(t)&&i.push(n.replace(t,""));return i}var s;try{s=window.localStorage,s.setItem("~~~","!"),s.removeItem("~~~")}catch(t){s=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(t){"QuotaExceededError"===t.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),o(this.ls.getItem(this._prefix(t)))},set:function(t,n,o){return e.isNumber(o)?this._safeSet(this._ttlKey(t),r(i()+o)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=a(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=o(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),a=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=!1===t.cache?new r(0):s}var i=0,o={},a=6,s=new r(10);return n.setMaxPendingRequests=function(t){a=t},n.resetCache=function(){s.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),c._cache.set(l,t)}function r(){e(!0)}function s(){i--,delete o[l],c.onDeckRequestArgs&&(c._get.apply(c,c.onDeckRequestArgs),c.onDeckRequestArgs=null)}var l,u,c=this;l=this._fingerprint(t),this.cancelled||l!==this.lastReq||((u=o[l])?u.done(n).fail(r):i<a?(i++,o[l]=this._send(t).done(n).fail(r).always(s)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,o;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},o=this._fingerprint(n),this.cancelled=!1,this.lastReq=o,(r=this._cache.get(o))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),s=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[l]=[],t[s]={},t}function o(t){for(var e={},n=[],i=0,r=t.length;i<r;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function a(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var o=t.length,a=e.length;n<o&&i<a;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var s="c",l="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,a;n.datums[o=n.identify(t)]=t,a=i(n.datumTokenizer(t)),e.each(a,function(t){var e,i,a;for(e=n.trie,i=t.split("");a=i.shift();)e=e[s][a]||(e[s][a]=r()),e[l].push(o)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,u=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,o;if(r&&0===r.length)return!1;for(e=u.trie,n=t.split("");e&&(i=n.shift());)e=e[s][i];if(!e||0!==n.length)return r=[],!1;o=e[l].slice(0),r=r?a(r,o):o}),r?e.map(o(r),function(t){return u.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),l=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new o(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),u=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new a({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),c=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?s(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=o(n),n.limiter=a(n),n.transport=n.transport?s(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function o(t){function e(t,e){return e.url=o(e.url,t),e}function n(t,e){return e.url=e.url.replace(a,encodeURIComponent(t)),e}function i(t,e){return e}var r,o,a;return r=t.prepare,o=t.replace,a=t.wildcard,r||(r=o?e:t.wildcard?n:i)}function a(t){var n,i,r;return n=t.limiter,i=t.rateLimitBy,r=t.rateLimitWait,n||(n=/^throttle$/i.test(i)?function(t){return function(n){
return e.throttle(n,t)}}(r):function(t){return function(n){return e.debounce(n,t)}}(r)),n}function s(n){return function(i){function r(t){e.defer(function(){a.resolve(t)})}function o(t){e.defer(function(){a.reject(t)})}var a=t.Deferred();return n(i,r,o),a}}return function(n){var o,a;return o={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(o,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),a=n.sorter,n.sorter=a?function(t){return t.sort(a)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}();return function(){"use strict";function n(t){t=c(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new u(t.remote):null,this.prefetch=t.prefetch?new l(t.prefetch):null,this.index=new s({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),!1!==t.initialize&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){if(t)return n.reject();r.add(e),r.prefetch.store(r.index.serialize()),n.resolve()}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(o,function(e){return a.identify(t)===a.identify(e)})&&n.push(t)}),i&&i(n)}var o,a=this;return o=this.sorter(this.index.search(t)),n(this.remote?o.slice():o),this.remote&&o.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return a.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}()}),function(t,e){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(0,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,l=arguments;return o=function(){i=null,n||(r=t.apply(s,l))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,l)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var l=new Date,u=e-(l-a);return n=this,i=arguments,u<=0?(clearTimeout(r),r=null,a=l,o=t.apply(n,i)):r||(r=setTimeout(s,u)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var a,s;return s=e.mixin({},o,t),a={css:r(),classes:s,html:n(s),selectors:i(s)},{css:a.css,html:a.html,classes:a.classes,selectors:a.selectors,mixin:function(t){e.mixin(t,a)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var o={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(s),n=i?a(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(s);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,a;if(!this._callbacks)return this;for(t=t.split(s),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=o(n.sync,this,[e].concat(i)),a=o(n.async,this,[e].concat(i)),r()&&l(a);return this}function o(t,e,n){function i(){for(var i,r=0,o=t.length;!i&&r<o;r+=1)i=!1===t[r].apply(e,n);return!i}return i}function a(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var s=/\s+/,l=function(){return window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}();return{onSync:n,onAsync:e,off:i,trigger:r}}(),o=function(t){"use strict";function n(t,n,i){for(var r,o=[],a=0,s=t.length;a<s;a++)o.push(e.escapeRegExChars(t[a]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(e){var n,i,o;return(n=s.exec(e.data))&&(o=t.createElement(r.tagName),r.className&&(o.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),o.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(o,i)),!!n}function a(t,e){for(var n,i=0;i<t.childNodes.length;i++)n=t.childNodes[i],3===n.nodeType?i+=e(n)?1:0:a(n,e)}var s;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],s=n(r.pattern,r.caseSensitive,r.wordsOnly),a(r.node,o))}}(window.document),a=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function o(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function a(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var s;return s={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=s[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!a(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!a(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=o(t,this.query),i=!!n&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,o=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){s[t.which||t.keyCode]||e.defer(e.bind(o._onInput,o,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),!(i=""!==t&&n&&!this.hasOverflow())&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:!document.selection||(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),s=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!s(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||u(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=a(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function a(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function s(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var l,u;return l={val:"tt-selectable-display",obj:"tt-selectable-object"},u=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(l.obj)?{val:n.data(l.val)||"",obj:n.data(l.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,a=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,o;o=a._injectQuery(n,e),i=t(a.templates.suggestion(o)).data(l.obj,e).data(l.val,a.displayFn(e)).addClass(a.classes.suggestion+" "+a.classes.selectable),r.appendChild(i[0])}),this.highlight&&o({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){a||(a=!0,t=(t||[]).slice(0,r.limit),s=t.length,r._overwrite(e,t),s<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!o&&s<r.limit&&(r.cancel=t.noop,s+=n.length,r._append(e,n.slice(0,r.limit-s)),r.async&&r.trigger("asyncReceived",e))}var r=this,o=!1,a=!1,s=0;this.cancel(),this.cancel=function(){o=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!a&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),l=function(){"use strict";function n(n,i){function r(e){var n=o.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(o.$node),new s(e,i)}var o=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),e<0?this.$node.scrollTop(i+e):r<n&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=r<-1?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?s.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),u=function(){"use strict";function t(){l.apply(this,[].slice.call(arguments,0))}var n=l.prototype;return e.mixin(t.prototype,l.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),c=function(){"use strict";function n(n,r){var o,a,s,l,u,c,h,p,f,d,m;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),o=i(this,"activate","open","_onFocused"),a=i(this,"deactivate","_onBlurred"),s=i(this,"isActive","isOpen","_onEnterKeyed"),l=i(this,"isActive","isOpen","_onTabKeyed"),u=i(this,"isActive","_onEscKeyed"),c=i(this,"isActive","open","_onUpKeyed"),h=i(this,"isActive","open","_onDownKeyed"),p=i(this,"isActive","isOpen","_onLeftKeyed"),f=i(this,"isActive","isOpen","_onRightKeyed"),d=i(this,"_openIfActive","_onQueryChanged"),m=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",o,this).onSync("blurred",a,this).onSync("enterKeyed",s,this).onSync("tabKeyed",l,this).onSync("escKeyed",u,this).onSync("upKeyed",c,this).onSync("downKeyed",h,this).onSync("leftKeyed",p,this).onSync("rightKeyed",f,this).onSync("queryChanged",d,this).onSync("whitespaceChanged",m,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,o,a;r=document.activeElement,o=i.is(r),a=i.has(r).length>0,e.isMsie()&&(o||a)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,o,s,l;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=a.normalizeQuery(i),o=e.escapeRegExChars(r),s=new RegExp("^(?:"+o+")(.+$)","i"),(l=s.exec(n.val))&&this.input.setHint(i+l[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return!(!e||this.eventBus.before("select",e.obj))&&(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0)},autocomplete:function(t){var e,n;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),!(!(n&&e!==n.val)||this.eventBus.before("autocomplete",n.obj))&&(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0)},moveCursor:function(t){var e,n,i,r;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,!(this._minLengthMet()&&this.menu.update(e))&&!this.eventBus.before("cursorchange",r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(m.typeahead))&&n(e,i)})}function o(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(h(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function s(t,e){t.data(m.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(t){}return t}function h(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function p(t){var n,i;n=t.data(m.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(m.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(m.typeahead).removeData(m.www).removeData(m.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function f(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var d,m,y;d=t.fn.typeahead,m={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},y={initialize:function(r,h){function p(){var n,p,y,g,v,_,x,b,w,S,E;e.each(h,function(t){t.highlight=!!r.highlight}),n=t(this),p=t(d.html.wrapper),y=f(r.hint),g=f(r.menu),v=!1!==r.hint&&!y,_=!1!==r.menu&&!g,v&&(y=o(n,d)),_&&(g=t(d.html.menu).css(d.css.menu)),y&&y.val(""),n=s(n,d),(v||_)&&(p.css(d.css.wrapper),n.css(v?d.css.input:d.css.inputWithNoHint),n.wrap(p).parent().prepend(v?y:null).append(_?g:null)),E=_?u:l,x=new i({el:n}),b=new a({hint:y,input:n},d),w=new E({node:g,datasets:h},d),S=new c({input:b,menu:w,eventBus:x,minLength:r.minLength},d),n.data(m.www,d),n.data(m.typeahead,S)}var d;return h=e.isArray(h)?h:[].slice.call(arguments,1),r=r||{},d=n(r.classNames),this.each(p)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){p(e),t.destroy()}),this}},t.fn.typeahead=function(t){return y[t]?y[t].apply(this,[].slice.call(arguments,1)):y.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=d,this}}()}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.mapboxgl=e()}(this,function(){"use strict";function t(t,r){if(e)if(n){var o="var sharedChunk = {}; ("+e+")(sharedChunk); ("+n+")(sharedChunk);",a={};e(a),i=r(a),i.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else n=r;else e=r}var e,n,i;return t(["exports"],function(t){function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}function r(t,e){this.x=t,this.y=e}function o(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!o(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var i in t)if(!o(t[i],e[i]))return!1;return!0}return t===e}function a(t,e,n,i){var r=new oi(t,e,n,i);return function(t){return r.solve(t)}}function s(t,e,n){return Math.min(n,Math.max(e,t))}function l(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}function u(){return ui++}function c(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function h(t,e){return-1!==t.indexOf(e,t.length-e.length)}function p(t,e,n){var i={};for(var r in t)i[r]=e.call(n||this,t[r],r,t);return i}function f(t,e,n){var i={};for(var r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function d(t){return Array.isArray(t)?t.map(d):"object"==typeof t&&t?p(t,d):t}function m(t){ci[t]||("undefined"!=typeof console&&console.warn(t),ci[t]=!0)}function y(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function g(t){for(var e=0,n=0,i=t.length,r=i-1,o=void 0,a=void 0;n<i;r=n++)o=t[n],e+=((a=t[r]).x-o.x)*(o.y+a.y);return e}function v(t){var e=new self.XMLHttpRequest;for(var n in e.open("GET",t.url,!0),t.headers)e.setRequestHeader(n,t.headers[n]);return e.withCredentials="include"===t.credentials,e}function _(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function x(t,e,n){if(n&&n[t]){var i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}function b(t){var e=t.key,n=t.value;return n?[new vi(e,n,"constants have been deprecated as of v8")]:[]}function w(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1]
;for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}function S(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function E(t){return Array.isArray(t)?t.map(E):S(t)}function k(t,e){return{kind:"array",itemType:t,N:e}}function T(t){if("array"===t.kind){var e=T(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}function A(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&!A(t.itemType,e.itemType)&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=zi;n<i.length;n+=1)if(!A(i[n],e))return null}return"Expected "+T(t)+" but found "+T(e)+" instead."}function I(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function z(t){if(null===t)return bi;if("string"==typeof t)return Si;if("boolean"==typeof t)return Ei;if("number"==typeof t)return wi;if(t instanceof Mi)return ki;if(t instanceof Pi)return Ii;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var o=z(r[i]);if(e){if(e===o)continue;e=Ai;break}e=o}return k(e||Ai,n)}return Ti}function C(t){if(t instanceof Ui){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!C(t)&&(e=!1)}),e}function M(t){if(t instanceof Ui&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!M(t)&&(e=!1)}),e}function P(t,e){if(t instanceof Ui&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild(function(t){n&&!P(t,e)&&(n=!1)}),n}function L(t,e){for(var n,i,r=0,o=t.length-1,a=0;r<=o;){if(n=t[a=Math.floor((r+o)/2)],i=t[a+1],e===n||e>n&&e<i)return a;if(n<e)r=a+1;else{if(!(n>e))throw new Ri("Input is not a number.");o=a-1}}return Math.max(a-1,0)}function D(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}function R(t,e,n){return t*(1-n)+e*n}function B(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}function O(t){return"string"===t.kind||"number"===t.kind||"boolean"===t.kind||"null"===t.kind}function F(t,e){return function(){function n(t,e,n){this.type=Ei,this.lhs=t,this.rhs=e,this.collator=n}return n.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var i=e.parse(t[1],1,Ai);if(!i)return null;var r=e.parse(t[2],2,Ai);if(!r)return null;if(!O(i.type)&&!O(r.type))return e.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+T(i.type)+", "+T(r.type)+") instead.");if(i.type.kind!==r.type.kind&&"value"!==i.type.kind&&"value"!==r.type.kind)return e.error("Cannot compare "+T(i.type)+" and "+T(r.type)+".");var o=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==r.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,Ii)))return null}return new n(i,r,o)},n.prototype.evaluate=function(t){var n=this.collator?0===this.collator.evaluate(t).compare(this.lhs.evaluate(t),this.rhs.evaluate(t)):this.lhs.evaluate(t)===this.rhs.evaluate(t);return e?!n:n},n.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},n.prototype.possibleOutputs=function(){return[!0,!1]},n.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},n}()}function V(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var a=o?o.evaluate(t):1,s=I(n,i,r,a);if(s)throw new Ri(s);return new Mi(n/255*a,i/255*a,r/255*a,a)}function N(t,e){return t in e}function j(t,e){var n=e[t];return void 0===n?null:n}function $(t,e){var n=e[0],i=e[1];return n.evaluate(t)<i.evaluate(t)}function q(t,e){var n=e[0],i=e[1];return n.evaluate(t)>i.evaluate(t)}function U(t,e){var n=e[0],i=e[1];return n.evaluate(t)<=i.evaluate(t)}function Z(t,e){var n=e[0],i=e[1];return n.evaluate(t)>=i.evaluate(t)}function G(t){return{type:t}}function W(t){return{result:"success",value:t}}function X(t){return{result:"error",value:t}}function H(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function K(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function J(t){return!!t.expression&&t.expression.interpolated}function Y(t){return t>pr?Math.pow(t,1/3):t/hr+ur}function Q(t){return t>cr?t*t*t:hr*(t-ur)}function tt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function et(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function nt(t){var e=et(t.r),n=et(t.g),i=et(t.b),r=Y((.4124564*e+.3575761*n+.1804375*i)/ar),o=Y((.2126729*e+.7151522*n+.072175*i)/sr);return{l:116*o-16,a:500*(r-o),b:200*(o-Y((.0193339*e+.119192*n+.9503041*i)/lr)),alpha:t.a}}function it(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=sr*Q(e),n=ar*Q(n),i=lr*Q(i),new Mi(tt(3.2404542*n-1.5371385*e-.4985314*i),tt(-.969266*n+1.8760108*e+.041556*i),tt(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function rt(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function ot(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function at(t){return t}function st(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function lt(t,e,n,i,r){return st(typeof n===r?i[n]:void 0,t.default,e.default)}function ut(t,e,n){if("number"!==rt(n))return st(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var r=pt(t.stops,n);return t.stops[r][1]}function ct(t,e,n){var i=void 0!==t.base?t.base:1;if("number"!==rt(n))return st(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var o=pt(t.stops,n),a=function(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],u=Hi[e.type]||at;if(t.colorSpace&&"rgb"!==t.colorSpace){var c=gr[t.colorSpace];u=function(t,e){return c.reverse(c.interpolate(c.forward(t),c.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==i)return u(n,i,a)}}:u(s,l,a)}function ht(t,e,n){return"color"===e.type?n=Mi.parse(n):rt(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),st(n,t.default,e.default)}function pt(t,e){for(var n,i,r=0,o=t.length-1,a=0;r<=o;){if(n=t[a=Math.floor((r+o)/2)][0],i=t[a+1][0],e===n||e>n&&e<i)return a;n<e?r=a+1:n>e&&(o=a-1)}return Math.max(a-1,0)}function ft(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in or}function dt(t,e){var n=new Gi(or,[],function(t){var e={color:ki,string:Si,number:wi,enum:Si,boolean:Ei};return"array"===t.type?k(e[t.value]||Ai,t.length):e[t.type]||null}(e)),i=n.parse(t);return i?W(new vr(i,e)):X(n.errors)}function mt(t,e){if("error"===(t=dt(t,e)).result)return t;var n=t.value.expression,i=C(n);if(!i&&!H(e))return X([new _i("","data expressions not supported")]);var r=P(n,["zoom"]);if(!r&&!K(e))return X([new _i("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof Yi)n=t(e.result);else if(e instanceof Ji)for(var i=0,r=e.args;i<r.length;i+=1){var o=r[i];if(n=t(o))break}else(e instanceof Wi||e instanceof Ki)&&e.input instanceof Ui&&"zoom"===e.input.name&&(n=e);return n instanceof _i?n:(e.eachChild(function(e){var i=t(e);i instanceof _i?n=i:!n&&i?n=new _i("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new _i("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n)}(n);return o||r?o instanceof _i?X([o]):o instanceof Ki&&!J(e)?X([new _i("",'"interpolate" expressions cannot be used with this property')]):W(o?new xr(i?"camera":"composite",t.value,o):new _r(i?"constant":"source",t.value)):X([new _i("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function yt(t,e){if(ot(t))return new br(t,e);if(ft(t)){var n=mt(t,e);if("error"===n.result)throw new Error(n.value.map(function(t){return t.key+": "+t.message}).join(", "));return n.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=Mi.parse(t)),{kind:"constant",evaluate:function(){return i}}}function gt(t){var e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=rt(n);if("object"!==l)return[new vi(e,n,"object expected, "+l+" found")];for(var u in n){var c=u.split(".")[0],h=i[c]||i["*"],p=void 0;if(r[c])p=r[c];else if(i[c])p=Vt;else if(r["*"])p=r["*"];else{if(!i["*"]){s.push(new vi(e,n[u],'unknown property "'+u+'"'));continue}p=Vt}s=s.concat(p({key:(e?e+".":e)+u,value:n[u],valueSpec:h,style:o,styleSpec:a,object:n,objectKey:u},n))}for(var f in i)r[f]||i[f].required&&void 0===i[f].default&&void 0===n[f]&&s.push(new vi(e,n,'missing required property "'+f+'"'));return s}function vt(t){var e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,o=t.key,a=t.arrayElementValidator||Vt;if("array"!==rt(e))return[new vi(o,e,"array expected, "+rt(e)+" found")];if(n.length&&e.length!==n.length)return[new vi(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new vi(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value};r.$version<7&&(s.function=n.function),"object"===rt(n.value)&&(s=n.value);for(var l=[],u=0;u<e.length;u++)l=l.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:s,style:i,styleSpec:r,key:o+"["+u+"]"}));return l}function _t(t){var e=t.key,n=t.value,i=t.valueSpec,r=rt(n);return"number"!==r?[new vi(e,n,"number expected, "+r+" found")]:"minimum"in i&&n<i.minimum?[new vi(e,n,n+" is less than the minimum value "+i.minimum)]:"maximum"in i&&n>i.maximum?[new vi(e,n,n+" is greater than the maximum value "+i.maximum)]:[]}function xt(t){function e(t){var e=[],i=t.value,s=t.key;if("array"!==rt(i))return[new vi(s,i,"array expected, "+rt(i)+" found")];if(2!==i.length)return[new vi(s,i,"array length 2 expected, length "+i.length+" found")];if(h){if("object"!==rt(i[0]))return[new vi(s,i,"object expected, "+rt(i[0])+" found")];if(void 0===i[0].zoom)return[new vi(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new vi(s,i,"object stop key must have value")];if(o&&o>S(i[0].zoom))return[new vi(s,i[0].zoom,"stop zoom values must appear in ascending order")];S(i[0].zoom)!==o&&(o=S(i[0].zoom),r=void 0,l={}),e=e.concat(gt({key:s+"[0]",value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:_t,value:n}}))}else e=e.concat(n({key:s+"[0]",value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return e.concat(Vt({key:s+"[1]",value:i[1],valueSpec:a,style:t.style,styleSpec:t.styleSpec}))}function n(t,e){var n=rt(t.value),o=S(t.value),u=null!==t.value?t.value:e;if(i){if(n!==i)return[new vi(t.key,u,n+" stop domain type must match previous stop domain type "+i)]}else i=n;if("number"!==n&&"string"!==n&&"boolean"!==n)return[new vi(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==n&&"categorical"!==s){var c="number expected, "+n+" found";return H(a)&&void 0===s&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vi(t.key,u,c)]}return"categorical"!==s||"number"!==n||isFinite(o)&&Math.floor(o)===o?"categorical"!==s&&"number"===n&&void 0!==r&&o<r?[new vi(t.key,u,"stop domain values must appear in ascending order")]:(r=o,"categorical"===s&&o in l?[new vi(t.key,u,"stop domain values must be unique")]:(l[o]=!0,[])):[new vi(t.key,u,"integer expected, found "+o)]}var i,r,o,a=t.valueSpec,s=S(t.value.type),l={},u="categorical"!==s&&void 0===t.value.property,c=!u,h="array"===rt(t.value.stops)&&"array"===rt(t.value.stops[0])&&"object"===rt(t.value.stops[0][0]),p=gt({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===s)return[new vi(t.key,t.value,'identity function may not have a "stops" property')];var n=[],i=t.value;return n=n.concat(vt({key:t.key,value:i,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:e})),"array"===rt(i)&&0===i.length&&n.push(new vi(t.key,i,"array must have at least one stop")),n},default:function(t){return Vt({key:t.key,value:t.value,valueSpec:a,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===s&&u&&p.push(new vi(t.key,t.value,'missing required property "property"')),"identity"===s||t.value.stops||p.push(new vi(t.key,t.value,'missing required property "stops"')),"exponential"===s&&t.valueSpec.expression&&!J(t.valueSpec)&&p.push(new vi(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(c&&!H(t.valueSpec)?p.push(new vi(t.key,t.value,"property functions not supported")):u&&!K(t.valueSpec)&&p.push(new vi(t.key,t.value,"zoom functions not supported"))),"categorical"!==s&&!h||void 0!==t.value.property||p.push(new vi(t.key,t.value,'"property" property is required')),p}function bt(t){var e=("property"===t.expressionContext?mt:dt)(E(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new vi(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new vi(t.key,t.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:"property"!==t.expressionContext||"layout"!==t.propertyType||M(e.value._styleExpression.expression)?[]:[new vi(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')]}function wt(t){var e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(S(n))&&r.push(new vi(e,n,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(i.values).indexOf(S(n))&&r.push(new vi(e,n,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(n)+" found")),r}function St(t){if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===t.length&&(Array.isArray(t[1])||Array.isArray(t[2]));case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var i=n[e];if(!St(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}}function Et(t){if(!t)return function(){return!0};St(t)||(t=Tt(t));var e=dt(t,wr);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,n){return e.value.evaluate(t,n)}}function kt(t,e){return t<e?-1:t>e?1:0}function Tt(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?At(t[1],t[2],"=="):"!="===n?Ct(At(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?At(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(Tt))):"all"===n?["all"].concat(t.slice(1).map(Tt)):"none"===n?["all"].concat(t.slice(1).map(Tt).map(Ct)):"in"===n?It(t[1],t.slice(2)):"!in"===n?Ct(It(t[1],t.slice(2))):"has"===n?zt(t[1]):"!has"!==n||Ct(zt(t[1]))}function At(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function It(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(kt)]]:["filter-in-small",t,["literal",e]]}}function zt(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ct(t){return["!",t]}function Mt(t){return St(E(t.value))?bt(w({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,i=e.key;if("array"!==rt(n))return[new vi(i,n,"array expected, "+rt(n)+" found")];var r,o=e.styleSpec,a=[];if(n.length<1)return[new vi(i,n,"filter array must have at least 1 element")];switch(a=a.concat(wt({key:i+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),S(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===S(n[1])&&a.push(new vi(i,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new vi(i,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(r=rt(n[1]))&&a.push(new vi(i+"[1]",n[1],"string expected, "+r+" found"));for(var s=2;s<n.length;s++)r=rt(n[s]),"$type"===S(n[1])?a=a.concat(wt({key:i+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new vi(i+"["+s+"]",n[s],"string, number, or boolean expected, "+r+" found"));break;case"any":case"all":case"none":for(var l=1;l<n.length;l++)a=a.concat(t({key:i+"["+l+"]",value:n[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=rt(n[1]),2!==n.length?a.push(new vi(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==r&&a.push(new vi(i+"[1]",n[1],"string expected, "+r+" found"))}return a}(t)}function Pt(t,e){var n=t.key,i=t.style,r=t.styleSpec,o=t.value,a=t.objectKey,s=r[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Vt({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});var u,c=t.valueSpec||s[a];if(!c)return[new vi(n,o,'unknown property "'+a+'"')];if("string"===rt(o)&&H(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new vi(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&h.push(new vi(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&ot(E(o))&&"identity"===S(o.type)&&h.push(new vi(n,o,'"text-font" does not support identity functions'))),h.concat(Vt({key:t.key,value:o,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:a}))}function Lt(t){return Pt(t,"paint")}function Dt(t){return Pt(t,"layout")}function Rt(t){var e=[],n=t.value,i=t.key,r=t.style,o=t.styleSpec;n.type||n.ref||e.push(new vi(i,n,'either "type" or "ref" is required'));var a,s=S(n.type),l=S(n.ref);if(n.id)for(var u=S(n.id),c=0;c<t.arrayIndex;c++){var h=r.layers[c];S(h.id)===u&&e.push(new vi(i,n.id,'duplicate layer id "'+n.id+'", previously used at line '+h.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach(function(t){t in n&&e.push(new vi(i,n[t],'"'+t+'" is prohibited for ref layers'))}),r.layers.forEach(function(t){S(t.id)===l&&(a=t)}),a?a.ref?e.push(new vi(i,n.ref,"ref cannot reference another ref layer")):s=S(a.type):e.push(new vi(i,n.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(n.source){var p=r.sources&&r.sources[n.source],f=p&&S(p.type);p?"vector"===f&&"raster"===s?e.push(new vi(i,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===f&&"raster"!==s?e.push(new vi(i,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==f||n["source-layer"]?"raster-dem"===f&&"hillshade"!==s?e.push(new vi(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===f&&p.lineMetrics||e.push(new vi(i,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new vi(i,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new vi(i,n.source,'source "'+n.source+'" not found'))}else e.push(new vi(i,n,'missing required property "source"'));return e=e.concat(gt({key:i,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Vt({key:i+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:Mt,layout:function(t){return gt({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Dt(w({layerType:s},t))}}})},paint:function(t){return gt({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Lt(w({layerType:s},t))}}})}}}))}function Bt(t){var e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new vi(n,e,'"type" is required')];var o=S(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(gt({key:n,value:e,valueSpec:i["source_"+o.replace("-","_")],style:t.style,styleSpec:i})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new vi(n+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return gt({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i});case"video":return gt({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return gt({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return a.push(new vi(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return wt({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function Ot(t){var e=t.value,n=t.styleSpec,i=n.light,r=t.style,o=[],a=rt(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new vi("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=l&&i[l[1]]&&i[l[1]].transition?o.concat(Vt({key:s,value:e[s],valueSpec:n.transition,style:r,styleSpec:n})):i[s]?o.concat(Vt({key:s,value:e[s],valueSpec:i[s],style:r,styleSpec:n})):o.concat([new vi(s,e[s],'unknown property "'+s+'"')])}return o}function Ft(t){var e=t.value,n=t.key,i=rt(e);return"string"!==i?[new vi(n,e,"string expected, "+i+" found")]:[]}function Vt(t){var e=t.value,n=t.valueSpec,i=t.styleSpec;return n.expression&&ot(S(e))?xt(t):n.expression&&ft(E(e))?bt(t):n.type&&Sr[n.type]?Sr[n.type](t):gt(w({},t,{valueSpec:n.type?i[n.type]:n}))}function Nt(t){var e=t.value,n=t.key,i=Ft(t);return i.length?i:(-1===e.indexOf("{fontstack}")&&i.push(new vi(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new vi(n,e,'"glyphs" url must include a "{range}" token')),i)}function jt(t,e){e=e||gi;var n=[];return n=n.concat(Vt({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Nt,"*":function(){return[]}}})),t.constants&&(n=n.concat(b({key:"constants",value:t.constants,style:t,styleSpec:e}))),$t(n)}function $t(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function qt(t){return function(){return $t(t.apply(this,arguments))}}function Ut(t,e){var n=!1;if(e&&e.length)for(var i=0,r=e;i<r.length;i+=1){var o=r[i];t.fire(new mi(new Error(o.message))),n=!0}return n}function Zt(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],e=r[1],n=r[2],this.d=e+2*n;for(var o=0;o<this.d*this.d;o++){var a=r[zr+o],s=r[zr+o+1];i.push(a===s?null:r.subarray(a,s))}var l=r[zr+i.length],u=r[zr+i.length+1];this.keys=r.subarray(l,u),this.bboxes=r.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var h=n/e*t;this.min=-h,this.max=t+h}function Gt(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Mr[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}function Wt(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Cr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],r=0,o=t;r<o.length;r+=1){var a=o[r];i.push(Wt(a,e))}return i}if("object"==typeof t){var s=t.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u={};if(s.serialize)u._serialized=s.serialize(t,e);else{for(var c in t)if(t.hasOwnProperty(c)&&!(Mr[l].omit.indexOf(c)>=0)){var h=t[c];u[c]=Mr[l].shallow.indexOf(c)>=0?h:Wt(h,e)}t instanceof Error&&(u.message=t.message)}return{name:l,properties:u}}throw new Error("can't serialize object of type "+typeof t)}function Xt(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof Cr)return t;if(Array.isArray(t))return t.map(function(t){return Xt(t)});if("object"==typeof t){var e=t,n=e.name,i=e.properties;if(!n)throw new Error("can't deserialize object of anonymous class");var r=Mr[n].klass;if(!r)throw new Error("can't deserialize unregistered class "+n);if(r.deserialize)return r.deserialize(i._serialized);for(var o=Object.create(r.prototype),a=0,s=Object.keys(i);a<s.length;a+=1){var l=s[a];o[l]=Mr[n].shallow.indexOf(l)>=0?i[l]:Xt(i[l])}return o}throw new Error("can't deserialize object of type "+typeof t)}function Ht(t){for(var e=0,n=t;e<n.length;e+=1)if(Jt(n[e].charCodeAt(0)))return!0;return!1}function Kt(t){return!(Rr.Arabic(t)||Rr["Arabic Supplement"](t)||Rr["Arabic Extended-A"](t)||Rr["Arabic Presentation Forms-A"](t)||Rr["Arabic Presentation Forms-B"](t))}function Jt(t){return!!(746===t||747===t||!(t<4352)&&(Rr["Bopomofo Extended"](t)||Rr.Bopomofo(t)||Rr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Rr["CJK Compatibility Ideographs"](t)||Rr["CJK Compatibility"](t)||Rr["CJK Radicals Supplement"](t)||Rr["CJK Strokes"](t)||!(!Rr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Rr["CJK Unified Ideographs Extension A"](t)||Rr["CJK Unified Ideographs"](t)||Rr["Enclosed CJK Letters and Months"](t)||Rr["Hangul Compatibility Jamo"](t)||Rr["Hangul Jamo Extended-A"](t)||Rr["Hangul Jamo Extended-B"](t)||Rr["Hangul Jamo"](t)||Rr["Hangul Syllables"](t)||Rr.Hiragana(t)||Rr["Ideographic Description Characters"](t)||Rr.Kanbun(t)||Rr["Kangxi Radicals"](t)||Rr["Katakana Phonetic Extensions"](t)||Rr.Katakana(t)&&12540!==t||!(!Rr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Rr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Rr["Unified Canadian Aboriginal Syllabics"](t)||Rr["Unified Canadian Aboriginal Syllabics Extended"](t)||Rr["Vertical Forms"](t)||Rr["Yijing Hexagram Symbols"](t)||Rr["Yi Syllables"](t)||Rr["Yi Radicals"](t)))}function Yt(t){return!(Jt(t)||function(t){return!!(Rr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Rr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Rr["Letterlike Symbols"](t)||Rr["Number Forms"](t)||Rr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Rr["Control Pictures"](t)&&9251!==t||Rr["Optical Character Recognition"](t)||Rr["Enclosed Alphanumerics"](t)||Rr["Geometric Shapes"](t)||Rr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Rr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Rr["CJK Symbols and Punctuation"](t)||Rr.Katakana(t)||Rr["Private Use Area"](t)||Rr["CJK Compatibility Forms"](t)||Rr["Small Form Variants"](t)||Rr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Qt(t,e){return!(!e&&(t>=1424&&t<=2303||Rr["Arabic Presentation Forms-A"](t)||Rr["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||Rr.Khmer(t))}function te(t,e){void 0===e&&(e=1);var n=0,i=0;return{members:t.map(function(t){var r,o=(r=t.type,no[r].BYTES_PER_ELEMENT),a=n=ee(n,Math.max(e,o)),s=t.components||1;return i=Math.max(i,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:a}}),size:ee(n,Math.max(i,e)),alignment:e}}function ee(t,e){return Math.ceil(t/e)*e}function ne(t){return[Bo(255*t.r,255*t.g),Bo(255*t.b,255*t.a)]}function ie(t,e){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[t]||t.replace(e+"-","").replace(/-/g,"_")}function re(t){for(var e=qo/t.extent,n=t.loadGeometry(),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.length;o++){var a=r[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<Uo.min||a.x>Uo.max||a.y<Uo.min||a.y>Uo.max)&&m("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function oe(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}function ae(t,e,n){for(var i=0;i<t.length;i++){var r=t[i];if(me(r,e))return!0;if(pe(e,r,n))return!0}return!1}function se(t,e){if(1===t.length&&1===t[0].length)return de(e,t[0][0]);for(var n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++)if(de(t,i[r]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if(de(e,a[s]))return!0;for(var l=0;l<e.length;l++)if(ce(a,e[l]))return!0}return!1}function le(t,e,n){for(var i=0;i<e.length;i++)for(var r=e[i],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<r.length;s++)if(me(a,r[s]))return!0;if(ue(a,r,n))return!0}return!1}function ue(t,e,n){if(t.length>1){if(ce(t,e))return!0;for(var i=0;i<e.length;i++)if(pe(e[i],t,n))return!0}for(var r=0;r<t.length;r++)if(pe(t[r],e,n))return!0;return!1}function ce(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var i=t[n],r=t[n+1],o=0;o<e.length-1;o++)if(he(i,r,e[o],e[o+1]))return!0;return!1}function he(t,e,n,i){return y(t,n,i)!==y(e,n,i)&&y(t,e,n)!==y(t,e,i)}function pe(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var r=1;r<e.length;r++)if(fe(t,e[r-1],e[r])<i)return!0;return!1}function fe(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return r<0?t.distSqr(e):r>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(r)._add(e))}function de(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++)for(var s=0,l=(n=t[a]).length-1;s<n.length;l=s++)i=n[s],r=n[l],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o);return o}function me(t,e){
for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function ye(t,e,n){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).binders[t].statistics.max}function ge(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ve(t,e,n,i,r){if(!e[0]&&!e[1])return t;var o=si.convert(e);"viewport"===n&&o._rotate(-i);for(var a=[],s=0;s<t.length;s++){for(var l=t[s],u=[],c=0;c<l.length;c++)u.push(l[c].sub(o._mult(r)));a.push(u)}return a}function _e(){var t=new Wo(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function xe(){var t=new Wo(3);return t[0]=0,t[1]=0,t[2]=0,t}function be(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function we(t,e,n){var i=new Wo(3);return i[0]=t,i[1]=e,i[2]=n,i}function Se(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ke(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=r*l-o*s,t[1]=o*a-i*l,t[2]=i*s-r*a,t}function Te(){var t=new Wo(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ae(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a),t}function Ie(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}function ze(){var t=new Wo(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ce(t,e,n){var i=Ie([],[t.x,t.y,0,1],e);return new si((i[0]/i[3]+1)*n.width*.5,(i[1]/i[3]+1)*n.height*.5)}function Me(t,e,n,i){var r=e.width,o=e.height;if(i){if(i.length!==r*o*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(r*o*n);return t.width=r,t.height=o,t.data=i,t}function Pe(t,e,n){var i=e.width,r=e.height;if(i!==t.width||r!==t.height){var o=Me({},{width:i,height:r},n);Le(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,r)},n),t.width=i,t.height=r,t.data=o.data}}function Le(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<r.height;l++)for(var u=((n.y+l)*t.width+n.x)*o,c=((i.y+l)*e.width+i.x)*o,h=0;h<r.width*o;h++)s[c+h]=a[u+h];return e}function De(t,e){for(var n=new Uint8Array(1024),i={},r=0,o=0;r<256;r++,o+=4){i[e]=r/255;var a=t.evaluate(i);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new ea({width:256,height:1},n)}function Re(t,e,n){n=n||2;var i,r,o,a,s,l,u,c=e&&e.length,h=c?e[0]*n:t.length,p=Be(t,0,h,n,!0),f=[];if(!p)return f;if(c&&(p=function(t,e,n,i){var r,o,a,s,l,u=[];for(r=0,o=e.length;r<o;r++)a=e[r]*i,s=r<o-1?e[r+1]*i:t.length,(l=Be(t,a,s,i,!1))===l.next&&(l.steiner=!0),u.push(Ge(l));for(u.sort(qe),r=0;r<u.length;r++)Ue(u[r],n),n=Oe(n,n.next);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<i&&(i=s),(l=t[d+1])<r&&(r=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-i,a-r))?1/u:0}return Fe(p,f,n,i,r,u),f}function Be(t,e,n,i,r){var o,a;if(r===rn(t,e,n,i)>0)for(o=e;o<n;o+=i)a=tn(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=tn(o,t[o],t[o+1],a);return a&&Ke(a,a.next)&&(en(a),a=a.next),a}function Oe(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ke(i,i.next)&&0!==He(i.prev,i,i.next))i=i.next;else{if(en(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Fe(t,e,n,i,r,o,a){if(t){!a&&o&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Ze(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(a>1)}(r)}(t,i,r,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Ne(t,i,r,o):Ve(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),en(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?Fe(t=je(t,e,n),e,n,i,r,o,2):2===a&&$e(t,e,n,i,r,o):Fe(Oe(t),e,n,i,r,o,1);break}}}function Ve(t){var e=t.prev,n=t,i=t.next;if(He(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(We(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&He(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ne(t,e,n,i){var r=t.prev,o=t,a=t.next;if(He(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=Ze(s,l,e,n,i),p=Ze(u,c,e,n,i),f=t.prevZ,d=t.nextZ;f&&f.z>=h&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&We(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&He(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&We(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&He(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&We(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&He(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&We(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&He(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function je(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ke(r,o)&&Je(r,i,i.next,o)&&Ye(r,o)&&Ye(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),en(i),en(i.next),i=t=o),i=i.next}while(i!==t);return i}function $e(t,e,n,i,r,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Xe(a,s)){var l=Qe(a,s);return a=Oe(a,a.next),l=Oe(l,l.next),Fe(a,e,n,i,r,o),void Fe(l,e,n,i,r,o)}s=s.next}a=a.next}while(a!==t)}function qe(t,e){return t.x-e.x}function Ue(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n.prev;var l,u=n,c=n.x,h=n.y,p=1/0;for(i=n.next;i!==u;)r>=i.x&&i.x>=c&&r!==i.x&&We(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(r-i.x))<p||l===p&&i.x>n.x)&&Ye(i,t)&&(n=i,p=l),i=i.next;return n}(t,e)){var n=Qe(e,t);Oe(n,n.next)}}function Ze(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ge(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function We(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function Xe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Je(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ye(t,e)&&Ye(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function He(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ke(t,e){return t.x===e.x&&t.y===e.y}function Je(t,e,n,i){return!!(Ke(t,e)&&Ke(n,i)||Ke(t,i)&&Ke(n,e))||He(t,e,n)>0!=He(t,e,i)>0&&He(n,i,t)>0!=He(n,i,e)>0}function Ye(t,e){return He(t.prev,t,t.next)<0?He(t,e,t.next)>=0&&He(t,t.prev,e)>=0:He(t,e,t.prev)<0||He(t,t.next,e)<0}function Qe(t,e){var n=new nn(t.i,t.x,t.y),i=new nn(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function tn(t,e,n,i){var r=new nn(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function en(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function nn(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rn(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function on(t,e,n,i,r){!function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var a=r-i+1,s=n-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-s*u/a+c)),Math.min(r,Math.floor(n+(a-s)*u/a+c)),o)}var h=e[n],p=i,f=r;for(an(e,i,n),o(e[r],h)>0&&an(e,i,r);p<f;){for(an(e,p,f),p++,f--;o(e[p],h)<0;)p++;for(;o(e[f],h)>0;)f--}0===o(e[i],h)?an(e,i,f):an(e,++f,r),f<=n&&(i=f+1),n<=f&&(r=f-1)}}(t,e,n||0,i||t.length-1,r||sn)}function an(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function sn(t,e){return t<e?-1:t>e?1:0}function ln(t,e){var n=t.length;if(n<=1)return[t];for(var i,r,o=[],a=0;a<n;a++){var s=g(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===r&&(r=s<0),r===s<0?(i&&o.push(i),i=[t[a]]):i.push(t[a]))}if(i&&o.push(i),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(ua(o[l],e,1,o[l].length-1,un),o[l]=o[l].slice(0,e));return o}function un(t,e){return e.area-t.area}function cn(t,e,n,i,r,o,a,s){t.emplaceBack(e,n,2*Math.floor(i*ma)+a,r*ma*2,o*ma*2,Math.round(s))}function hn(t,e){return t.x===e.x&&(t.x<0||t.x>qo)||t.y===e.y&&(t.y<0||t.y>qo)}function pn(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>qo})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>qo})}function fn(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(dn,this,e)}function dn(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function mn(t){for(var e,n,i=0,r=0,o=t.length,a=o-1;r<o;a=r++)e=t[r],i+=((n=t[a]).x-e.x)*(e.y+n.y);return i}function yn(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(gn,this,e),this.length=this._features.length}function gn(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function vn(t,e,n){if(3===t){var i=new ba(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}function _n(t,e,n,i,r,o,a){t.emplaceBack(e.x,e.y,i?1:0,r?1:-1,Math.round(Ea*n.x)+128,Math.round(Ea*n.y)+128,1+(0===o?0:o<0?-1:1)|(a*Ta&63)<<2,a*Ta>>6)}function xn(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(Aa-1)}function bn(t,e){return e>0?e+2*t:t}function wn(t,e,n){var i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),Nr.applyArabicShaping&&(t=Nr.applyArabicShaping(t)),t}function Sn(t,e){var n=e.expression;if("constant"===n.kind)return{functionType:"constant",layoutSize:n.evaluate(new jr(t+1))};if("source"===n.kind)return{functionType:"source"};for(var i=n.zoomStops,r=0;r<i.length&&i[r]<=t;)r++;for(var o=r=Math.max(0,r-1);o<i.length&&i[o]<t+1;)o++;o=Math.min(i.length-1,o);var a={min:i[r],max:i[o]};return"composite"===n.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:n.evaluate(new jr(t+1)),zoomRange:a,sizeRange:{min:n.evaluate(new jr(a.min)),max:n.evaluate(new jr(a.max))},propertyValue:e.value}}function En(t,e,n,i,r,o,a,s){t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),o,a,s?s[0]:0,s?s[1]:0)}function kn(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function Tn(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function An(t){return t.type===Tn.Bytes?t.readVarint()+t.pos:t.pos+1}function In(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function zn(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function Cn(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Mn(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Pn(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Ln(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Dn(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Rn(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Bn(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function On(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Fn(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Vn(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Nn(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function jn(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function $n(t,e,n){1===t&&n.readMessage(qn,e)}function qn(t,e,n){if(3===t){var i=n.readMessage(Un,{}),r=i.id,o=i.bitmap,a=i.width,s=i.height,l=i.left,u=i.top,c=i.advance;e.push({id:r,bitmap:new ta({width:a+2*cs,height:s+2*cs},o),metrics:{width:a,height:s,left:l,top:u,advance:c}})}}function Un(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function Zn(t,e,n,i){(t*=2)<0&&(t=-1*t-1);var r=1<<e;return 32*(r*r*t+r*i+n)+e}function Gn(t,e){return e-t}function Wn(t,e,n,i){var r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function Xn(t,e){var n=0;return 10===t&&(n-=1e4),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function Hn(t,e,n,i,r,o){for(var a=null,s=Wn(e,n,r,o),l=0,u=i;l<u.length;l+=1){var c=u[l],h=Wn(e-c.x,n,r,o)+c.badness;h<=s&&(a=c,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function Kn(t,e,n,i){if(!n)return[];if(!t)return[];for(var r,o=[],a=function(t,e,n,i){for(var r=0,o=0;o<t.length;o++){var a=i[t.charCodeAt(o)];a&&(r+=a.metrics.advance+e)}return r/Math.max(1,Math.ceil(r/n))}(t,e,n,i),s=0,l=0;l<t.length;l++){var u=t.charCodeAt(l),c=i[u];c&&!Is[u]&&(s+=c.metrics.advance+e),l<t.length-1&&(zs[u]||!((r=u)<11904)&&(Rr["Bopomofo Extended"](r)||Rr.Bopomofo(r)||Rr["CJK Compatibility Forms"](r)||Rr["CJK Compatibility Ideographs"](r)||Rr["CJK Compatibility"](r)||Rr["CJK Radicals Supplement"](r)||Rr["CJK Strokes"](r)||Rr["CJK Symbols and Punctuation"](r)||Rr["CJK Unified Ideographs Extension A"](r)||Rr["CJK Unified Ideographs"](r)||Rr["Enclosed CJK Letters and Months"](r)||Rr["Halfwidth and Fullwidth Forms"](r)||Rr.Hiragana(r)||Rr["Ideographic Description Characters"](r)||Rr["Kangxi Radicals"](r)||Rr["Katakana Phonetic Extensions"](r)||Rr.Katakana(r)||Rr["Vertical Forms"](r)||Rr["Yi Radicals"](r)||Rr["Yi Syllables"](r)))&&o.push(Hn(l+1,s,a,o,Xn(u,t.charCodeAt(l+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Hn(t.length,s,a,o,0,!0))}function Jn(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Yn(t,e,n,i,r){if(r){var o=e[t[i].glyph];if(o)for(var a=o.metrics.advance,s=(t[i].x+a)*r,l=n;l<=i;l++)t[l].x-=s}}var Qn="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ti=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),ei=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,ni=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,ii={now:ti,frame:function(t){return ei(t)},cancelFrame:function(t){return ni(t)},getImageData:function(t){var e=self.document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height)},resolveURL:function(t){var e=self.document.createElement("a");return e.href=t,e.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:!1};if(self.document){var ri=self.document.createElement("img");ri.onload=function(){ii.supportsWebp=!0},ri.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var oi=i;i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var n,i,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var ai=function(t,e,n){this.column=t,this.row=e,this.zoom=n};ai.prototype.clone=function(){return new ai(this.column,this.row,this.zoom)},ai.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},ai.prototype.sub=function(t){return this.clone()._sub(t)},ai.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},ai.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var si=r;r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t};var li=a(.25,.1,.25,1),ui=1,ci={},hi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(hi);var pi=function(t){function e(e,n,i){t.call(this,e),this.status=n,this.url=i,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),fi=function(t,e){var n=v(t);return n.responseType="arraybuffer",n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){var i=n.response;if(0===i.byteLength&&200===n.status)return e(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?e(null,{data:i,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):e(new pi(n.statusText,n.status,t.url))},n.send(),n},di=function(t,e){void 0===e&&(e={}),l(this,e),this.type=t},mi=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",l({error:e},n))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(di),yi=function(){};yi.prototype.on=function(t,e){return this._listeners=this._listeners||{},_(t,e,this._listeners),this},yi.prototype.off=function(t,e){return x(t,e,this._listeners),x(t,e,this._oneTimeListeners),this},yi.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},_(t,e,this._oneTimeListeners),this},yi.prototype.fire=function(t){"string"==typeof t&&(t=new di(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var n=0,i=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];n<i.length;n+=1)i[n].call(this,t);for(var r=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];r<o.length;r+=1){var a=o[r];x(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(l(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof mi&&console.error(t.error);return this},yi.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},yi.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var gi={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"string",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},
default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},vi=function(t,e,n,i){this.message=(t?t+": ":"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)},_i=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),xi=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n],o=r[0],a=r[1];this.bindings[o]=a}};xi.prototype.concat=function(t){return new xi(this,t)},xi.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},xi.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var bi={kind:"null"},wi={kind:"number"},Si={kind:"string"},Ei={kind:"boolean"},ki={kind:"color"},Ti={kind:"object"},Ai={kind:"value"},Ii={kind:"collator"},zi=[bi,wi,Si,Ei,ki,Ti,k(Ai)],Ci=n(function(t,e){function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function r(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return i("%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))}function a(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in s)return s[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=i.indexOf("("),u=i.indexOf(")");if(-1!==l&&u+1===i.length){var c=i.substr(0,l),h=i.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=o(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),p];case"hsla":if(4!==h.length)return null;p=o(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=o(h[1]),m=o(h[2]),y=m<=.5?m*(d+1):m+d-m*d,g=2*m-y;return[n(255*a(g,y,f+1/3)),n(255*a(g,y,f)),n(255*a(g,y,f-1/3)),p];default:return null}}return null}}catch(t){}}).parseCSSColor,Mi=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};Mi.parse=function(t){if(t){if(t instanceof Mi)return t;if("string"==typeof t){var e=Ci(t);if(e)return new Mi(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Mi.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],i=t[2],r=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(i)+","+r+")"},Mi.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,i=this.a;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]},Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0);var Pi=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Pi.prototype.compare=function(t,e){return this.collator.compare(t,e)},Pi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Li=function(t,e,n){this.type=Ii,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};Li.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Ei);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Ei);if(!r)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,Si))?null:new Li(i,r,o)},Li.prototype.evaluate=function(t){return new Pi(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Li.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Li.prototype.possibleOutputs=function(){return[void 0]},Li.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Di=function(t,e){this.type=t,this.value=e};Di.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Mi)return!0;if(e instanceof Pi)return!0;if(Array.isArray(e)){for(var n=0,i=e;n<i.length;n+=1)if(!t(i[n]))return!1;return!0}if("object"==typeof e){for(var r in e)if(!t(e[r]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var n=t[1],i=z(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new Di(i,n)},Di.prototype.evaluate=function(){return this.value},Di.prototype.eachChild=function(){},Di.prototype.possibleOutputs=function(){return[this.value]},Di.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Mi?["rgba"].concat(this.value.toArray()):this.value};var Ri=function(t){this.name="ExpressionEvaluationError",this.message=t};Ri.prototype.toJSON=function(){return this.message};var Bi={string:Si,number:wi,boolean:Ei,object:Ti},Oi=function(t,e){this.type=t,this.args=e};Oi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var n=t[0],i=Bi[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Ai);if(!a)return null;r.push(a)}return new Oi(i,r)},Oi.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!A(this.type,z(n)))return n;if(e===this.args.length-1)throw new Ri("Expected value to be of type "+T(this.type)+", but found "+T(z(n))+" instead.")}return null},Oi.prototype.eachChild=function(t){this.args.forEach(t)},Oi.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Oi.prototype.serialize=function(){return[this.type.kind].concat(this.args.map(function(t){return t.serialize()}))};var Fi={string:Si,number:wi,boolean:Ei},Vi=function(t,e){this.type=t,this.input=e};Vi.parse=function(t,e){if(t.length<2||t.length>4)return e.error("Expected 1, 2, or 3 arguments, but found "+(t.length-1)+" instead.");var n,i;if(t.length>2){var r=t[1];if("string"!=typeof r||!(r in Fi))return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=Fi[r]}else n=Ai;if(t.length>3){if("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2]))return e.error('The length argument to "array" must be a positive integer literal',2);i=t[2]}var o=k(n,i),a=e.parse(t[t.length-1],t.length-1,Ai);return a?new Vi(o,a):null},Vi.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(A(this.type,z(e)))throw new Ri("Expected value to be of type "+T(this.type)+", but found "+T(z(e))+" instead.");return e},Vi.prototype.eachChild=function(t){t(this.input)},Vi.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},Vi.prototype.serialize=function(){var t=["array"],e=this.type.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var n=this.type.N;"number"==typeof n&&t.push(n)}return t.push(this.input.serialize()),t};var Ni={"to-number":wi,"to-color":ki},ji=function(t,e){this.type=t,this.args=e};ji.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");for(var n=t[0],i=Ni[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Ai);if(!a)return null;r.push(a)}return new ji(i,r)},ji.prototype.evaluate=function(t){if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1)if(n=null,"string"==typeof(e=r[i].evaluate(t))){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":I(e[0],e[1],e[2],e[3])))return new Mi(e[0]/255,e[1]/255,e[2]/255,e[3]);throw new Ri(n||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}for(var a=null,s=0,l=this.args;s<l.length;s+=1)if(null!==(a=l[s].evaluate(t))){var u=Number(a);if(!isNaN(u))return u}throw new Ri("Could not convert "+JSON.stringify(a)+" to number.")},ji.prototype.eachChild=function(t){this.args.forEach(t)},ji.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},ji.prototype.serialize=function(){var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var $i=["Unknown","Point","LineString","Polygon"],qi=function(){this._parseColorCache={}};qi.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qi.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?$i[this.feature.type]:this.feature.type:null},qi.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qi.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Mi.parse(t)),e};var Ui=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};Ui.prototype.evaluate=function(t){return this._evaluate(t,this.args)},
Ui.prototype.eachChild=function(t){this.args.forEach(t)},Ui.prototype.possibleOutputs=function(){return[void 0]},Ui.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Ui.parse=function(t,e){var n=t[0],i=Ui.definitions[n];if(!i)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var r=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,a=o.filter(function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1}),s=[],l=1;l<t.length;l++){var u=t[l],c=void 0;if(1===a.length){var h=a[0][0];c=Array.isArray(h)?h[l-1]:h.type}var p=e.parse(u,1+s.length,c);if(!p)return null;s.push(p)}for(var f=null,d=0,m=a;d<m.length;d+=1){var y=m[d],g=y[0],v=y[1];if(f=new Gi(e.registry,e.path,null,e.scope),Array.isArray(g)&&g.length!==s.length)f.error("Expected "+g.length+" arguments, but found "+s.length+" instead.");else{for(var _=0;_<s.length;_++){var x=Array.isArray(g)?g[_]:g.type,b=s[_];f.concat(_+1).checkSubtype(x,b.type)}if(0===f.errors.length)return new Ui(n,r,v,s)}}if(1===a.length)e.errors.push.apply(e.errors,f.errors);else{var w=(a.length?a:o).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(T).join(", ")+")":"("+T(e.type)+"...)"}).join(" | "),S=s.map(function(t){return T(t.type)}).join(", ");e.error("Expected arguments of type "+w+", but found ("+S+") instead.")}return null},Ui.register=function(t,e){for(var n in Ui.definitions=e,e)t[n]=Ui};var Zi=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Zi.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Zi(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Zi.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Zi.prototype.eachChild=function(){},Zi.prototype.possibleOutputs=function(){return[void 0]},Zi.prototype.serialize=function(){return["var",this.name]};var Gi=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new xi),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=i,this.errors=r,this.expectedType=n};Gi.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},Gi.prototype._parse=function(t,e){if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=t[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found "+typeof n+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[n];if(i){var r=i.parse(t,this);if(!r)return null;if(this.expectedType){var o=this.expectedType,a=r.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind||"value"!==a.kind)if("array"===o.kind&&"value"===a.kind)e.omitTypeAnnotations||(r=new Vi(o,r));else if("color"!==o.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(this.expectedType,r.type))return null}else e.omitTypeAnnotations||(r=new ji(o,[r]));else e.omitTypeAnnotations||(r=new Oi(o,[r]))}if(!(r instanceof Di)&&function t(e){if(e instanceof Zi)return t(e.boundExpression);if(e instanceof Ui&&"error"===e.name)return!1;if(e instanceof Li)return!1;var n=e instanceof ji||e instanceof Oi||e instanceof Vi,i=!0;return e.eachChild(function(e){i=n?i&&t(e):i&&e instanceof Di}),!!i&&(C(e)&&P(e,["zoom","heatmap-density","line-progress","is-supported-script"]))}(r)){var s=new qi;try{r=new Di(r.type,r.evaluate(s))}catch(t){return this.error(t.message),null}}return r}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},Gi.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Gi(this.registry,i,e||null,r,this.errors)},Gi.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new _i(i,t))},Gi.prototype.checkSubtype=function(t,e){var n=A(t,e);return n&&this.error(n),n};var Wi=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var o=r[i],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};Wi.parse=function(t,e){var n=t[1],i=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,1,wi)))return null;var r=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),i.unshift(-1/0);for(var a=0;a<i.length;a+=2){var s=i[a],l=i[a+1],u=a+1,c=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=e.parse(l,c,o);if(!h)return null;o=o||h.type,r.push([s,h])}return new Wi(o,n,r)},Wi.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[L(e,i)].evaluate(t)},Wi.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Wi.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Wi.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Xi=D;D.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},D.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},D.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},D.prototype.solveCurveX=function(t,e){var n,i,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},D.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Hi=Object.freeze({number:R,color:function(t,e,n){return new Mi(R(t.r,e.r,n),R(t.g,e.g,n),R(t.b,e.b,n),R(t.a,e.a,n))},array:function(t,e,n){return t.map(function(t,i){return R(t,e[i],n)})}}),Ki=function(t,e,n,i){this.type=t,this.interpolation=e,this.input=n,this.labels=[],this.outputs=[];for(var r=0,o=i;r<o.length;r+=1){var a=o[r],s=a[0],l=a[1];this.labels.push(s),this.outputs.push(l)}};Ki.interpolationFactor=function(t,e,n,i){var r=0;if("exponential"===t.name)r=B(e,t.base,n,i);else if("linear"===t.name)r=B(e,1,n,i);else if("cubic-bezier"===t.name){var o=t.controlPoints;r=new Xi(o[0],o[1],o[2],o[3]).solve(B(e,1,n,i))}return r},Ki.parse=function(t,e){var n=t[1],i=t[2],r=t.slice(3);if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){var o=n[1];if("number"!=typeof o)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:o}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);var a=n.slice(1);if(4!==a.length||a.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:a}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,wi)))return null;var s=[],l=null;e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var u=0;u<r.length;u+=2){var c=r[u],h=r[u+1],p=u+3,f=u+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(s.length&&s[s.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var d=e.parse(h,f,l);if(!d)return null;l=l||d.type,s.push([c,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Ki(l,n,i,s):e.error("Type "+T(l)+" is not interpolatable.")},Ki.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var o=L(e,i),a=e[o],s=e[o+1],l=Ki.interpolationFactor(this.interpolation,i,a,s),u=n[o].evaluate(t),c=n[o+1].evaluate(t);return Hi[this.type.kind.toLowerCase()](u,c,l)},Ki.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Ki.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Ki.prototype.serialize=function(){for(var t=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var Ji=function(t,e){this.type=t,this.args=e};Ji.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],l=e.parse(s,1+r.length,n,void 0,{omitTypeAnnotations:!0});if(!l)return null;n=n||l.type,r.push(l)}var u=i&&r.some(function(t){return A(i,t.type)});return new Ji(u?Ai:n,r)},Ji.prototype.evaluate=function(t){for(var e=null,n=0,i=this.args;n<i.length&&null===(e=i[n].evaluate(t));n+=1);return e},Ji.prototype.eachChild=function(t){this.args.forEach(t)},Ji.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Ji.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Yi=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Yi.prototype.evaluate=function(t){return this.result.evaluate(t)},Yi.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},Yi.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}var a=e.parse(t[t.length-1],t.length-1,void 0,n);return a?new Yi(n,a):null},Yi.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Yi.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t.push(r,o.serialize())}return t.push(this.result.serialize()),t};var Qi=function(t,e,n){this.type=t,this.index=e,this.input=n};Qi.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,wi),i=e.parse(t[2],2,k(e.expectedType||Ai));if(!n||!i)return null;var r=i.type;return new Qi(r.itemType,n,i)},Qi.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new Ri("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new Ri("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new Ri("Array index must be an integer, but found "+e+" instead.");return n[e]},Qi.prototype.eachChild=function(t){t(this.index),t(this.input)},Qi.prototype.possibleOutputs=function(){return[void 0]},Qi.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var tr=function(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o};tr.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,h=s;c<h.length;c+=1){var p=h[c];if("number"!=typeof p&&"string"!=typeof p)return u.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,z(p)))return null}else n=z(p);if(void 0!==r[String(p)])return u.error("Branch labels must be unique.");r[String(p)]=o.length}var f=e.parse(l,a,i);if(!f)return null;i=i||f.type,o.push(f)}var d=e.parse(t[1],1,Ai);if(!d)return null;var m=e.parse(t[t.length-1],t.length-1,i);return m?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new tr(n,i,d,r,o,m):null},tr.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(z(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},tr.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},tr.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},tr.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],i={},r=0,o=Object.keys(this.cases).sort();r<o.length;r+=1){var a=o[r],s=i[t.cases[a]];void 0===s?(i[t.cases[a]]=n.length,n.push([t.cases[a],[a]])):n[s][1].push(a)}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,c=n;u<c.length;u+=1){var h=c[u],p=h[0],f=h[1];1===f.length?e.push(l(f[0])):e.push(f.map(l)),e.push(t.outputs[p].serialize())}return e.push(this.otherwise.serialize()),e};var er=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};er.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var o=e.parse(t[r],r,Ei);if(!o)return null;var a=e.parse(t[r+1],r+1,n);if(!a)return null;i.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new er(n,i,s):null},er.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];if(r.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},er.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t(r),t(o)}t(this.otherwise)},er.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},er.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var nr=F("==",!1),ir=F("!=",!0),rr=function(t){this.type=wi,this.input=t};rr.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+T(n.type)+" instead."):new rr(n):null},rr.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new Ri("Expected value to be of type string or array, but found "+T(z(e))+" instead.")},rr.prototype.eachChild=function(t){t(this.input)},rr.prototype.possibleOutputs=function(){return[void 0]},rr.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var or={"==":nr,"!=":ir,array:Vi,at:Qi,boolean:Oi,case:er,coalesce:Ji,collator:Li,interpolate:Ki,length:rr,let:Yi,literal:Di,match:tr,number:Oi,object:Oi,step:Wi,string:Oi,"to-color":ji,"to-number":ji,var:Zi};Ui.register(or,{error:[{kind:"error"},[Si],function(t,e){var n=e[0];throw new Ri(n.evaluate(t))}],typeof:[Si,[Ai],function(t,e){return T(z(e[0].evaluate(t)))}],"to-string":[Si,[Ai],function(t,e){var n=e[0],i=typeof(n=n.evaluate(t));return null===n?"":"string"===i||"number"===i||"boolean"===i?String(n):n instanceof Mi?n.toString():JSON.stringify(n)}],"to-boolean":[Ei,[Ai],function(t,e){var n=e[0];return Boolean(n.evaluate(t))}],"to-rgba":[k(wi,4),[ki],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[ki,[wi,wi,wi],V],rgba:[ki,[wi,wi,wi,wi],V],has:{type:Ei,overloads:[[[Si],function(t,e){return N(e[0].evaluate(t),t.properties())}],[[Si,Ti],function(t,e){var n=e[0],i=e[1];return N(n.evaluate(t),i.evaluate(t))}]]},get:{type:Ai,overloads:[[[Si],function(t,e){return j(e[0].evaluate(t),t.properties())}],[[Si,Ti],function(t,e){var n=e[0],i=e[1];return j(n.evaluate(t),i.evaluate(t))}]]},"feature-state":[Ai,[Si],function(t,e){return j(e[0].evaluate(t),t.featureState||{})}],properties:[Ti,[],function(t){return t.properties()}],"geometry-type":[Si,[],function(t){return t.geometryType()}],id:[Ai,[],function(t){return t.id()}],zoom:[wi,[],function(t){return t.globals.zoom}],"heatmap-density":[wi,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[wi,[],function(t){return t.globals.lineProgress||0}],"+":[wi,G(wi),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1)n+=r[i].evaluate(t);return n}],"*":[wi,G(wi),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1)n*=r[i].evaluate(t);return n}],"-":{type:wi,overloads:[[[wi,wi],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)-i.evaluate(t)}],[[wi],function(t,e){return-e[0].evaluate(t)}]]},"/":[wi,[wi,wi],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)/i.evaluate(t)}],"%":[wi,[wi,wi],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)%i.evaluate(t)}],ln2:[wi,[],function(){return Math.LN2}],pi:[wi,[],function(){return Math.PI}],e:[wi,[],function(){return Math.E}],"^":[wi,[wi,wi],function(t,e){var n=e[0],i=e[1];return Math.pow(n.evaluate(t),i.evaluate(t))}],sqrt:[wi,[wi],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[wi,[wi],function(t,e){var n=e[0];return Math.log10(n.evaluate(t))}],ln:[wi,[wi],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[wi,[wi],function(t,e){var n=e[0];return Math.log2(n.evaluate(t))}],sin:[wi,[wi],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[wi,[wi],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[wi,[wi],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[wi,[wi],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[wi,[wi],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[wi,[wi],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[wi,G(wi),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[wi,G(wi),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[wi,[wi],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[wi,[wi],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[wi,[wi],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[wi,[wi],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[Ei,[Si,Ai],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[Ei,[Ai],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Ei,[Si],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Ei,[Si,Ai],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<o}],"filter-id-<":[Ei,[Ai],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Ei,[Si,Ai],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>o}],"filter-id->":[Ei,[Ai],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[Ei,[Si,Ai],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[Ei,[Ai],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Ei,[Si,Ai],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>=o}],"filter-id->=":[Ei,[Ai],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[Ei,[Ai],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Ei,[],function(t){return null!==t.id()}],"filter-type-in":[Ei,[k(Si)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ei,[k(Ai)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ei,[Si,k(Ai)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Ei,[Si,k(Ai)],function(t,e){var n=e[0],i=e[1];return function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],">":{type:Ei,overloads:[[[wi,wi],q],[[Si,Si],q],[[Si,Si,Ii],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))>0}]]},"<":{type:Ei,overloads:[[[wi,wi],$],[[Si,Si],$],[[Si,Si,Ii],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))<0}]]},">=":{type:Ei,overloads:[[[wi,wi],Z],[[Si,Si],Z],[[Si,Si,Ii],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))>=0}]]},"<=":{type:Ei,overloads:[[[wi,wi],U],[[Si,Si],U],[[Si,Si,Ii],function(t,e){var n=e[0],i=e[1];return e[2].evaluate(t).compare(n.evaluate(t),i.evaluate(t))<=0}]]},all:{type:Ei,overloads:[[[Ei,Ei],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)&&i.evaluate(t)}],[G(Ei),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(!i[n].evaluate(t))return!1;return!0}]]},any:{type:Ei,overloads:[[[Ei,Ei],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)||i.evaluate(t)}],[G(Ei),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(i[n].evaluate(t))return!0;return!1}]]},"!":[Ei,[Ei],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Ei,[Si],function(t,e){var n=e[0],i=t.globals&&t.globals.isSupportedScript;return!i||i(n.evaluate(t))}],upcase:[Si,[Si],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Si,[Si],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Si,G(Si),function(t,e){return e.map(function(e){return e.evaluate(t)}).join("")}],"resolved-locale":[Si,[Ii],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var ar=.95047,sr=1,lr=1.08883,ur=4/29,cr=6/29,hr=3*cr*cr,pr=cr*cr*cr,fr=Math.PI/180,dr=180/Math.PI,mr={forward:nt,reverse:it,interpolate:function(t,e,n){return{l:R(t.l,e.l,n),a:R(t.a,e.a,n),b:R(t.b,e.b,n),alpha:R(t.alpha,e.alpha,n)}}},yr={forward:function(t){var e=nt(t),n=e.l,i=e.a,r=e.b,o=Math.atan2(r,i)*dr;return{h:o<0?o+360:o,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},reverse:function(t){var e=t.h*fr,n=t.c;return it({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:function(t,e,n){var i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}(t.h,e.h,n),c:R(t.c,e.c,n),l:R(t.l,e.l,n),alpha:R(t.alpha,e.alpha,n)}}},gr=Object.freeze({lab:mr,hcl:yr}),vr=function(t,e){var n;this.expression=t,this._warningHistory={},this._defaultValue="color"===(n=e).type&&ot(n.default)?new Mi(0,0,0,0):"color"===n.type?Mi.parse(n.default)||null:void 0===n.default?null:n.default,"enum"===e.type&&(this._enumValues=e.values)};vr.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._evaluator||(this._evaluator=new qi),this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this.expression.evaluate(this._evaluator)},vr.prototype.evaluate=function(t,e,n){this._evaluator||(this._evaluator=new qi),this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n;try{var i=this.expression.evaluate(this._evaluator);if(null==i)return this._defaultValue;if(this._enumValues&&!(i in this._enumValues))throw new Ri("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(i)+" instead.");return i}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var _r=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!M(e.expression)};_r.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},_r.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)};var xr=function(t,e,n){this.kind=t,this.zoomStops=n.labels,this._styleExpression=e,this.isStateDependent="camera"!==t&&!M(e.expression),n instanceof Ki&&(this._interpolationType=n.interpolation)};xr.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},xr.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)},xr.prototype.interpolationFactor=function(t,e,n){return this._interpolationType?Ki.interpolationFactor(this._interpolationType,t,e,n):0};var br=function(t,e){this._parameters=t,this._specification=e,w(this,function t(e,n){var i,r,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||void 0!==e.property,u=s||!l,c=e.type||(J(n)?"exponential":"interval");if(a&&((e=w({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],Mi.parse(t[1])]})),e.default?e.default=Mi.parse(e.default):e.default=Mi.parse(n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!gr[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)i=ct;else if("interval"===c)i=ut;else if("categorical"===c){i=lt,r=Object.create(null);for(var h=0,p=e.stops;h<p.length;h+=1){var f=p[h];r[f[0]]=f[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');i=ht}if(s){for(var d={},m=[],y=0;y<e.stops.length;y++){var g=e.stops[y],v=g[0].zoom;void 0===d[v]&&(d[v]={zoom:v,type:e.type,property:e.property,default:e.default,stops:[]},m.push(v)),d[v].stops.push([g[0].value,g[1]])}for(var _=[],x=0,b=m;x<b.length;x+=1){var S=b[x];_.push([d[S].zoom,t(d[S],n)])}return{kind:"composite",interpolationFactor:Ki.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:_.map(function(t){return t[0]}),evaluate:function(t,i){var r=t.zoom;return ct({stops:_,base:e.base},n,r).evaluate(r,i)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Ki.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var a=t.zoom;return i(e,n,a,r,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?st(e.default,n.default):i(e,n,s,r,o)}}}(this._parameters,this._specification))};br.deserialize=function(t){return new br(t._parameters,t._specification)},br.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var wr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Sr={"*":function(){return[]},array:vt,boolean:function(t){var e=t.value,n=t.key,i=rt(e);return"boolean"!==i?[new vi(n,e,"boolean expected, "+i+" found")]:[]},number:_t,color:function(t){var e=t.key,n=t.value,i=rt(n);return"string"!==i?[new vi(e,n,"color expected, "+i+" found")]:null===Ci(n)?[new vi(e,n,'color expected, "'+n+'" found')]:[]},constants:b,enum:wt,filter:Mt,function:xt,layer:Rt,object:gt,source:Bt,light:Ot,string:Ft};jt.source=qt(Bt),jt.light=qt(Ot),jt.layer=qt(Rt),jt.filter=qt(Mt),jt.paintProperty=qt(Lt),jt.layoutProperty=qt(Dt);var Er=jt,kr=jt.light,Tr=jt.paintProperty,Ar=jt.layoutProperty,Ir=Zt,zr=3;Zt.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Zt.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Zt.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},Zt.prototype.query=function(t,e,n,i){var r=this.min,o=this.max;if(t<=r&&e<=r&&o<=n&&o<=i)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{}),a},Zt.prototype._queryCell=function(t,e,n,i,r,o,a){var s=this.cells[r];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var h=s[c];if(void 0===a[h]){var p=4*h;t<=u[p+2]&&e<=u[p+3]&&n>=u[p+0]&&i>=u[p+1]?(a[h]=!0,o.push(l[h])):a[h]=!1}}},Zt.prototype._forEachCell=function(t,e,n,i,r,o,a){for(var s=this._convertToCellCoord(t),l=this._convertToCellCoord(e),u=this._convertToCellCoord(n),c=this._convertToCellCoord(i),h=s;h<=u;h++)for(var p=l;p<=c;p++){var f=this.d*p+h;if(r.call(this,t,e,n,i,f,o,a))return}},Zt.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Zt.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=zr+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];r[zr+a]=o,r.set(s,o),o+=s.length}return r[zr+t.length]=o,r.set(this.keys,o),o+=this.keys.length,r[zr+t.length+1]=o,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};var Cr=self.ImageData,Mr={};for(var Pr in Gt("Object",Object),Ir.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),n},Ir.deserialize=function(t){return new Ir(t)},Gt("Grid",Ir),Gt("Color",Mi),Gt("Error",Error),Gt("StylePropertyFunction",br),Gt("StyleExpression",vr,{omit:["_evaluator"]}),Gt("ZoomDependentExpression",xr),Gt("ZoomConstantExpression",_r),Gt("CompoundExpression",Ui,{omit:["_evaluate"]}),or)or[Pr]._classRegistryKey||Gt("Expression_"+Pr,or[Pr]);var Lr=function(){this.first=!0};Lr.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,
this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var Dr,Rr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}},Br=!1,Or=null,Fr=!1,Vr=new yi,Nr={applyArabicShaping:null,processBidirectionalText:null,isLoaded:function(){return Fr||null!=Nr.applyArabicShaping}},jr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Lr,this.transition={})};jr.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,i=t;n<i.length;n+=1)if(!Qt(i[n].charCodeAt(0),e))return!1;return!0}(t,Nr.isLoaded())},jr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var $r=function(t,e){this.property=t,this.value=e,this.expression=yt(void 0===e?t.specification.default:e,t.specification)};$r.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},$r.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var qr=function(t){this.property=t,this.value=new $r(t,void 0)};qr.prototype.transitioned=function(t,e){return new Zr(this.property,this.value,e,l({},t.transition,this.transition),t.now)},qr.prototype.untransitioned=function(){return new Zr(this.property,this.value,null,{},0)};var Ur=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Ur.prototype.getValue=function(t){return d(this._values[t].value.value)},Ur.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new qr(this._values[t].property)),this._values[t].value=new $r(this._values[t].property,null===e?void 0:d(e))},Ur.prototype.getTransition=function(t){return d(this._values[t].transition)},Ur.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new qr(this._values[t].property)),this._values[t].transition=d(e)||void 0},Ur.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},Ur.prototype.transitioned=function(t,e){for(var n=new Gr(this._properties),i=0,r=Object.keys(this._values);i<r.length;i+=1){var o=r[i];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},Ur.prototype.untransitioned=function(){for(var t=new Gr(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e];t._values[i]=this._values[i].untransitioned()}return t};var Zr=function(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)};Zr.prototype.possiblyEvaluate=function(t){var e=t.now||0,n=this.value.possiblyEvaluate(t),i=this.prior;if(i){if(e>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(e<this.begin)return i.possiblyEvaluate(t);var r=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(t),n,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(r))}return n};var Gr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Gr.prototype.possiblyEvaluate=function(t){for(var e=new Hr(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var r=i[n];e._values[r]=this._values[r].possiblyEvaluate(t)}return e},Gr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var n=e[t];if(this._values[n].prior)return!0}return!1};var Wr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Wr.prototype.getValue=function(t){return d(this._values[t].value)},Wr.prototype.setValue=function(t,e){this._values[t]=new $r(this._values[t].property,null===e?void 0:d(e))},Wr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r)}return t},Wr.prototype.possiblyEvaluate=function(t){for(var e=new Hr(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var r=i[n];e._values[r]=this._values[r].possiblyEvaluate(t)}return e};var Xr=function(t,e,n){this.property=t,this.value=e,this.globals=n};Xr.prototype.isConstant=function(){return"constant"===this.value.kind},Xr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Xr.prototype.evaluate=function(t,e){return this.property.evaluate(this.value,this.globals,t,e)};var Hr=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Hr.prototype.get=function(t){return this._values[t]};var Kr=function(t){this.specification=t};Kr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Kr.prototype.interpolate=function(t,e,n){var i=Hi[this.specification.type];return i?i(t,e,n):t};var Jr=function(t){this.specification=t};Jr.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Xr(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Xr(this,t.expression,e)},Jr.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Xr(this,{kind:"constant",value:void 0},t.globals);var i=Hi[this.specification.type];return i?new Xr(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.globals):t},Jr.prototype.evaluate=function(t,e,n,i){return"constant"===t.kind?t.value:t.evaluate(e,n,i)};var Yr=function(t){this.specification=t};Yr.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var n=t.expression.evaluate(e);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new jr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new jr(Math.floor(e.zoom),e)),t.expression.evaluate(new jr(Math.floor(e.zoom+1),e)),e)}},Yr.prototype._calculate=function(t,e,n,i){var r=i.zoom,o=r-Math.floor(r),a=i.crossFadingFactor();return r>i.zoomHistory.lastIntegerZoom?{from:t,to:e,fromScale:2,toScale:1,t:o+(1-o)*a}:{from:n,to:e,fromScale:.5,toScale:1,t:1-(1-a)*o}},Yr.prototype.interpolate=function(t){return t};var Qr=function(t){this.specification=t};Qr.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},Qr.prototype.interpolate=function(){return!1};var to=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var n=t[e],i=this.defaultPropertyValues[e]=new $r(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new qr(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}};Gt("DataDrivenProperty",Jr),Gt("DataConstantProperty",Kr),Gt("CrossFadedProperty",Yr),Gt("ColorRampProperty",Qr);var eo=function(t){function e(e,n){for(var i in t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.visibility="visible","background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this._featureFilter=function(){return!0},n.layout&&(this._unevaluatedLayout=new Wr(n.layout)),this._transitionablePaint=new Ur(n.paint),e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(var r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){if(null!=e){var i="layers."+this.id+".layout."+t;if(this._validate(Ar,i,t,e,n))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return h(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(null!=e){var i="layers."+this.id+".paint."+t;if(this._validate(Tr,i,t,e,n))return!1}if(h(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var r=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,e);var o=this._transitionablePaint._values[t].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(t),o||r},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),f(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,n,i,r){return(!r||!1!==r.validate)&&Ut(this,t.call(Er,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:gi,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof Xr&&H(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(yi),no={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},io=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ro=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};ro.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},ro.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},ro.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ro.prototype.clear=function(){this.length=0},ro.prototype.resize=function(t){this.reserve(t),this.length=t},ro.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},ro.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.int16[i+0]=t,this.int16[i+1]=e,n},e.prototype.emplace=function(t,e,n){var i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t},e}(ro);oo.prototype.bytesPerElement=4,Gt("StructArrayLayout2i4",oo);var ao=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;this.resize(r+1);var o=4*r;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=n,this.int16[o+3]=i,r},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,t},e}(ro);ao.prototype.bytesPerElement=8,Gt("StructArrayLayout4i8",ao);var so=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=r,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,n,i,r,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(ro);so.prototype.bytesPerElement=12,Gt("StructArrayLayout2i4i12",so);var lo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=n,this.int16[u+3]=i,this.uint8[c+8]=r,this.uint8[c+9]=o,this.uint8[c+10]=a,this.uint8[c+11]=s,l},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l){var u=6*t,c=12*t;return this.int16[u+0]=e,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.uint8[c+8]=o,this.uint8[c+9]=a,this.uint8[c+10]=s,this.uint8[c+11]=l,t},e}(ro);lo.prototype.bytesPerElement=12,Gt("StructArrayLayout4i4ub12",lo);var uo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=t,this.int16[u+1]=e,this.int16[u+2]=n,this.int16[u+3]=i,this.uint16[u+4]=r,this.uint16[u+5]=o,this.uint16[u+6]=a,this.uint16[u+7]=s,l},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l){var u=8*t;return this.int16[u+0]=e,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.uint16[u+4]=o,this.uint16[u+5]=a,this.uint16[u+6]=s,this.uint16[u+7]=l,t},e}(ro);uo.prototype.bytesPerElement=16,Gt("StructArrayLayout4i4ui16",uo);var co=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.float32[r+0]=t,this.float32[r+1]=e,this.float32[r+2]=n,i},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t},e}(ro);co.prototype.bytesPerElement=12,Gt("StructArrayLayout3f12",co);var ho=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.uint32[n+0]=t,e},e.prototype.emplace=function(t,e){var n=1*t;return this.uint32[n+0]=e,t},e}(ro);ho.prototype.bytesPerElement=4,Gt("StructArrayLayout1ul4",ho);var po=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,u,c){var h=this.length;this.resize(h+1);var p=12*h,f=6*h;return this.int16[p+0]=t,this.int16[p+1]=e,this.int16[p+2]=n,this.int16[p+3]=i,this.int16[p+4]=r,this.int16[p+5]=o,this.uint32[f+3]=a,this.uint16[p+8]=s,this.uint16[p+9]=l,this.int16[p+10]=u,this.int16[p+11]=c,h},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,u,c,h){var p=12*t,f=6*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.int16[p+4]=o,this.int16[p+5]=a,this.uint32[f+3]=s,this.uint16[p+8]=l,this.uint16[p+9]=u,this.int16[p+10]=c,this.int16[p+11]=h,t},e}(ro);po.prototype.bytesPerElement=24,Gt("StructArrayLayout6i1ul2ui2i24",po);var fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=r,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,n,i,r,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(ro);fo.prototype.bytesPerElement=12,Gt("StructArrayLayout2i2i2i12",fo);var mo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=4*n;return this.uint8[i+0]=t,this.uint8[i+1]=e,n},e.prototype.emplace=function(t,e,n){var i=4*t;return this.uint8[i+0]=e,this.uint8[i+1]=n,t},e}(ro);mo.prototype.bytesPerElement=4,Gt("StructArrayLayout2ub4",mo);var yo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,u,c,h,p,f){var d=this.length;this.resize(d+1);var m=20*d,y=10*d,g=40*d;return this.int16[m+0]=t,this.int16[m+1]=e,this.uint16[m+2]=n,this.uint16[m+3]=i,this.uint32[y+2]=r,this.uint32[y+3]=o,this.uint32[y+4]=a,this.uint16[m+10]=s,this.uint16[m+11]=l,this.uint16[m+12]=u,this.float32[y+7]=c,this.float32[y+8]=h,this.uint8[g+36]=p,this.uint8[g+37]=f,d},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,u,c,h,p,f,d){var m=20*t,y=10*t,g=40*t;return this.int16[m+0]=e,this.int16[m+1]=n,this.uint16[m+2]=i,this.uint16[m+3]=r,this.uint32[y+2]=o,this.uint32[y+3]=a,this.uint32[y+4]=s,this.uint16[m+10]=l,this.uint16[m+11]=u,this.uint16[m+12]=c,this.float32[y+7]=h,this.float32[y+8]=p,this.uint8[g+36]=f,this.uint8[g+37]=d,t},e}(ro);yo.prototype.bytesPerElement=40,Gt("StructArrayLayout2i2ui3ul3ui2f2ub40",yo);var go=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.float32[n+0]=t,e},e.prototype.emplace=function(t,e){var n=1*t;return this.float32[n+0]=e,t},e}(ro);go.prototype.bytesPerElement=4,Gt("StructArrayLayout1f4",go);var vo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.int16[r+0]=t,this.int16[r+1]=e,this.int16[r+2]=n,i},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t},e}(ro);vo.prototype.bytesPerElement=6,Gt("StructArrayLayout3i6",vo);var _o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=2*i,o=4*i;return this.uint32[r+0]=t,this.uint16[o+2]=e,this.uint16[o+3]=n,i},e.prototype.emplace=function(t,e,n,i){var r=2*t,o=4*t;return this.uint32[r+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=i,t},e}(ro);_o.prototype.bytesPerElement=8,Gt("StructArrayLayout1ul2ui8",_o);var xo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;this.resize(i+1);var r=3*i;return this.uint16[r+0]=t,this.uint16[r+1]=e,this.uint16[r+2]=n,i},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t},e}(ro);xo.prototype.bytesPerElement=6,Gt("StructArrayLayout3ui6",xo);var bo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.uint16[i+0]=t,this.uint16[i+1]=e,n},e.prototype.emplace=function(t,e,n){var i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t},e}(ro);bo.prototype.bytesPerElement=4,Gt("StructArrayLayout2ui4",bo);var wo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var i=2*n;return this.float32[i+0]=t,this.float32[i+1]=e,n},e.prototype.emplace=function(t,e,n){var i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t},e}(ro);wo.prototype.bytesPerElement=8,Gt("StructArrayLayout2f8",wo);var So=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;this.resize(r+1);var o=4*r;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=n,this.float32[o+3]=i,r},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,t},e}(ro);So.prototype.bytesPerElement=16,Gt("StructArrayLayout4f16",So);var Eo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},n.anchorPoint.get=function(){return new si(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(io);Eo.prototype.size=24;var ko=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Eo(this,t)},e}(po);Gt("CollisionBoxArray",ko);var To=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetX.set=function(t){
this._structArray.float32[this._pos4+7]=t},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,n),e}(io);To.prototype.size=40;var Ao=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new To(this,t)},e}(yo);Gt("PlacedSymbolArray",Ao);var Io=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={offsetX:{configurable:!0}};return n.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},n.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,n),e}(io);Io.prototype.size=4;var zo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new Io(this,t)},e}(go);Gt("GlyphOffsetArray",zo);var Co=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return n.x.get=function(){return this._structArray.int16[this._pos2+0]},n.x.set=function(t){this._structArray.int16[this._pos2+0]=t},n.y.get=function(){return this._structArray.int16[this._pos2+1]},n.y.set=function(t){this._structArray.int16[this._pos2+1]=t},n.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},n.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,n),e}(io);Co.prototype.size=6;var Mo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new Co(this,t)},e}(vo);Gt("SymbolLineVertexArray",Mo);var Po=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,n),e}(io);Po.prototype.size=8;var Lo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Po(this,t)},e}(_o);Gt("FeatureIndexArray",Lo);var Do=te([{name:"a_pos",components:2,type:"Int16"}],4).members,Ro=function(t){void 0===t&&(t=[]),this.segments=t};Ro.prototype.prepareSegment=function(t,e,n){var i=this.segments[this.segments.length-1];return t>Ro.MAX_VERTEX_ARRAY_LENGTH&&m("Max vertices per segment is "+Ro.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>Ro.MAX_VERTEX_ARRAY_LENGTH)&&(i={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},this.segments.push(i)),i},Ro.prototype.get=function(){return this.segments},Ro.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var i in n.vaos)n.vaos[i].destroy()}},Ro.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gt("SegmentVector",Ro);var Bo=function(t,e){return 256*(t=s(Math.floor(t),0,255))+(e=s(Math.floor(e),0,255))},Oo=function(t,e,n){this.value=t,this.name=e,this.type=n,this.statistics={max:-1/0}};Oo.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},Oo.prototype.populatePaintArray=function(){},Oo.prototype.updatePaintArray=function(){},Oo.prototype.upload=function(){},Oo.prototype.destroy=function(){},Oo.prototype.setUniforms=function(t,e,n,i){var r=i.constantOr(this.value),o=t.gl;"color"===this.type?o.uniform4f(e.uniforms["u_"+this.name],r.r,r.g,r.b,r.a):o.uniform1f(e.uniforms["u_"+this.name],r)};var Fo=function(t,e,n){this.expression=t,this.name=e,this.type=n,this.statistics={max:-1/0};var i="color"===n?wo:go;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===n?2:1,offset:0}],this.paintVertexArray=new i};Fo.prototype.defines=function(){return[]},Fo.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,i=n.length;n.reserve(t);var r=this.expression.evaluate(new jr(0),e,{});if("color"===this.type)for(var o=ne(r),a=i;a<t;a++)n.emplaceBack(o[0],o[1]);else{for(var s=i;s<t;s++)n.emplaceBack(r);this.statistics.max=Math.max(this.statistics.max,r)}},Fo.prototype.updatePaintArray=function(t,e,n,i){var r=this.paintVertexArray,o=this.expression.evaluate({zoom:0},n,i);if("color"===this.type)for(var a=ne(o),s=t;s<e;s++)r.emplace(s,a[0],a[1]);else{for(var l=t;l<e;l++)r.emplace(l,o);this.statistics.max=Math.max(this.statistics.max,o)}},Fo.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Fo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Fo.prototype.setUniforms=function(t,e){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],0)};var Vo=function(t,e,n,i,r){this.expression=t,this.name=e,this.type=n,this.useIntegerZoom=i,this.zoom=r,this.statistics={max:-1/0};var o="color"===n?So:wo;this.paintVertexAttributes=[{name:"a_"+e,type:"Float32",components:"color"===n?4:2,offset:0}],this.paintVertexArray=new o};Vo.prototype.defines=function(){return[]},Vo.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,i=n.length;n.reserve(t);var r=this.expression.evaluate(new jr(this.zoom),e,{}),o=this.expression.evaluate(new jr(this.zoom+1),e,{});if("color"===this.type)for(var a=ne(r),s=ne(o),l=i;l<t;l++)n.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var u=i;u<t;u++)n.emplaceBack(r,o);this.statistics.max=Math.max(this.statistics.max,r,o)}},Vo.prototype.updatePaintArray=function(t,e,n,i){var r=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);if("color"===this.type)for(var s=ne(o),l=ne(a),u=t;u<e;u++)r.emplace(u,s[0],s[1],l[0],l[1]);else{for(var c=t;c<e;c++)r.emplace(c,o,a);this.statistics.max=Math.max(this.statistics.max,o,a)}},Vo.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Vo.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},Vo.prototype.setUniforms=function(t,e,n){t.gl.uniform1f(e.uniforms["a_"+this.name+"_t"],this.interpolationFactor(n.zoom))};var No=function(){this.binders={},this.cacheKey="",this._buffers=[],this._idMap={},this._bufferOffset=0};No.createDynamic=function(t,e,n){var i=new No,r=[];for(var o in t.paint._values)if(n(o)){var a=t.paint.get(o);if(a instanceof Xr&&H(a.property.specification)){var s=ie(o,t.type),l=a.property.specification.type,u=a.property.useIntegerZoom;"constant"===a.value.kind?(i.binders[o]=new Oo(a.value,s,l),r.push("/u_"+s)):"source"===a.value.kind?(i.binders[o]=new Fo(a.value,s,l),r.push("/a_"+s)):(i.binders[o]=new Vo(a.value,s,l,u,e),r.push("/z_"+s))}}return i.cacheKey=r.sort().join(""),i},No.prototype.populatePaintArrays=function(t,e,n){for(var i in this.binders)this.binders[i].populatePaintArray(t,e);if(e.id){var r=String(e.id);this._idMap[r]=this._idMap[r]||[],this._idMap[r].push({index:n,start:this._bufferOffset,end:t})}this._bufferOffset=t},No.prototype.updatePaintArrays=function(t,e,n){var i=!1;for(var r in t){var o=this._idMap[r];if(o)for(var a=t[r],s=0,l=o;s<l.length;s+=1){var u=l[s],c=e.feature(u.index);for(var h in this.binders){var p=this.binders[h];if(!(p instanceof Oo)&&!0===p.expression.isStateDependent){var f=n.paint.get(h);p.expression=f.value,p.updatePaintArray(u.start,u.end,c,a),i=!0}}}}return i},No.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},No.prototype.setUniforms=function(t,e,n,i){for(var r in this.binders)this.binders[r].setUniforms(t,e,i,n.get(r))},No.prototype.getPaintVertexBuffers=function(){return this._buffers},No.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var n=[];for(var i in this.binders){var r=this.binders[i];(r instanceof Fo||r instanceof Vo)&&r.paintVertexBuffer&&n.push(r.paintVertexBuffer)}this._buffers=n},No.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var jo=function(t,e,n,i){void 0===i&&(i=function(){return!0}),this.programConfigurations={};for(var r=0,o=e;r<o.length;r+=1){var a=o[r];this.programConfigurations[a.id]=No.createDynamic(a,n,i),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1};jo.prototype.populatePaintArrays=function(t,e,n){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,n);this.needsUpload=!0},jo.prototype.updatePaintArrays=function(t,e,n){for(var i=0,r=n;i<r.length;i+=1){var o=r[i];this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(t,e,o)||this.needsUpload}},jo.prototype.get=function(t){return this.programConfigurations[t]},jo.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},jo.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Gt("ConstantBinder",Oo),Gt("SourceExpressionBinder",Fo),Gt("CompositeExpressionBinder",Vo),Gt("ProgramConfiguration",No,{omit:["_buffers"]}),Gt("ProgramConfigurationSet",jo);var $o,qo=8192,Uo=($o=16,{min:-1*Math.pow(2,$o-1),max:Math.pow(2,$o-1)-1}),Zo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new oo,this.indexArray=new xo,this.segments=new Ro,this.programConfigurations=new jo(Do,t.layers,t.zoom)};Zo.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new jr(this.zoom),o)){var l=re(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},Zo.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},Zo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Do),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.addFeature=function(t,e,n){for(var i=0,r=e;i<r.length;i+=1)for(var o=0,a=r[i];o<a.length;o+=1){var s=a[o],l=s.x,u=s.y;if(!(l<0||l>=qo||u<0||u>=qo)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=c.vertexLength;oe(this.layoutVertexArray,l,u,-1,-1),oe(this.layoutVertexArray,l,u,1,-1),oe(this.layoutVertexArray,l,u,1,1),oe(this.layoutVertexArray,l,u,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n)},Gt("CircleBucket",Zo,{omit:["layers"]});var Go={paint:new to({"circle-radius":new Jr(gi.paint_circle["circle-radius"]),"circle-color":new Jr(gi.paint_circle["circle-color"]),"circle-blur":new Jr(gi.paint_circle["circle-blur"]),"circle-opacity":new Jr(gi.paint_circle["circle-opacity"]),"circle-translate":new Kr(gi.paint_circle["circle-translate"]),"circle-translate-anchor":new Kr(gi.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kr(gi.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kr(gi.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jr(gi.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jr(gi.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jr(gi.paint_circle["circle-stroke-opacity"])})},Wo="undefined"!=typeof Float32Array?Float32Array:Array;Math.PI;var Xo,Ho=be,Ko=(Xo=xe(),function(t,e,n,i,r,o){var a,s;for(e||(e=3),n||(n=0),s=i?Math.min(i*e+n,t.length):t.length,a=n;a<s;a+=e)Xo[0]=t[a],Xo[1]=t[a+1],Xo[2]=t[a+2],r(Xo,Xo,o),t[a]=Xo[0],t[a+1]=Xo[1],t[a+2]=Xo[2];return t}),Jo=function(){var t=Te();return function(e,n,i,r,o,a){var s,l;for(n||(n=4),i||(i=0),l=r?Math.min(r*n+i,e.length):e.length,s=i;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();xe(),we(1,0,0),we(0,1,0),ze(),ze(),_e(),function(){var t;(t=new Wo(2))[0]=0,t[1]=0}();var Yo=function(t){function e(e){t.call(this,e,Go)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Zo(t)},e.prototype.queryRadius=function(t){var e=t;return ye("circle-radius",this,e)+ye("circle-stroke-width",this,e)+ge(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a,s){for(var l=ve(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(t,e,n){return t.map(function(t){return t.map(function(t){return Ce(t,e,n)})})}(l,s,o),p=c?u*a:u,f=0,d=i;f<d.length;f+=1)for(var m=0,y=d[f];m<y.length;m+=1){var g=y[m],v=c?g:Ce(g,s,o),_=p,x=Ie([],[g.x,g.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=x[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/x[3]),ae(h,v,_))return!0}return!1},e}(eo),Qo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Zo);Gt("HeatmapBucket",Qo,{omit:["layers"]});var ta=function(t,e){Me(this,t,1,e)};ta.prototype.resize=function(t){Pe(this,t,1)},ta.prototype.clone=function(){return new ta({width:this.width,height:this.height},new Uint8Array(this.data))},ta.copy=function(t,e,n,i,r){Le(t,e,n,i,r,1)};var ea=function(t,e){Me(this,t,4,e)};ea.prototype.resize=function(t){Pe(this,t,4)},ea.prototype.clone=function(){return new ea({width:this.width,height:this.height},new Uint8Array(this.data))},ea.copy=function(t,e,n,i,r){Le(t,e,n,i,r,4)},Gt("AlphaImage",ta),Gt("RGBAImage",ea);var na={paint:new to({"heatmap-radius":new Jr(gi.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jr(gi.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kr(gi.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qr(gi.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kr(gi.paint_heatmap["heatmap-opacity"])})},ia=function(t){function e(e){t.call(this,e,na),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Qo(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=De(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(eo),ra={paint:new to({"hillshade-illumination-direction":new Kr(gi.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kr(gi.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kr(gi.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kr(gi.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kr(gi.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kr(gi.paint_hillshade["hillshade-accent-color"])})},oa=function(t){function e(e){t.call(this,e,ra)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(eo),aa=te([{name:"a_pos",components:2,type:"Int16"}],4).members,sa=Re,la=Re;Re.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(rn(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,c=s<l-1?e[s+1]*n:t.length;a-=Math.abs(rn(t,u,c,n))}var h=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,f=i[s+1]*n,d=i[s+2]*n;h+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},Re.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},sa.default=la;var ua=on,ca=on;ua.default=ca;var ha=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new oo,this.indexArray=new xo,this.indexArray2=new bo,this.programConfigurations=new jo(aa,t.layers,t.zoom),this.segments=new Ro,this.segments2=new Ro};ha.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new jr(this.zoom),o)){var l=re(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},ha.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},ha.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ha.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,aa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ha.prototype.addFeature=function(t,e,n){for(var i=0,r=ln(e,500);i<r.length;i+=1){for(var o=r[i],a=0,s=0,l=o;s<l.length;s+=1)a+=l[s].length;for(var u=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray),c=u.vertexLength,h=[],p=[],f=0,d=o;f<d.length;f+=1){var m=d[f];if(0!==m.length){m!==o[0]&&p.push(h.length/2);var y=this.segments2.prepareSegment(m.length,this.layoutVertexArray,this.indexArray2),g=y.vertexLength;this.layoutVertexArray.emplaceBack(m[0].x,m[0].y),this.indexArray2.emplaceBack(g+m.length-1,g),h.push(m[0].x),h.push(m[0].y);for(var v=1;v<m.length;v++)this.layoutVertexArray.emplaceBack(m[v].x,m[v].y),this.indexArray2.emplaceBack(g+v-1,g+v),h.push(m[v].x),h.push(m[v].y);y.vertexLength+=m.length,y.primitiveLength+=m.length}}for(var _=sa(h,p),x=0;x<_.length;x+=3)this.indexArray.emplaceBack(c+_[x],c+_[x+1],c+_[x+2]);u.vertexLength+=a,u.primitiveLength+=_.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n)},Gt("FillBucket",ha,{omit:["layers"]});var pa={paint:new to({"fill-antialias":new Kr(gi.paint_fill["fill-antialias"]),"fill-opacity":new Jr(gi.paint_fill["fill-opacity"]),"fill-color":new Jr(gi.paint_fill["fill-color"]),"fill-outline-color":new Jr(gi.paint_fill["fill-outline-color"]),"fill-translate":new Kr(gi.paint_fill["fill-translate"]),"fill-translate-anchor":new Kr(gi.paint_fill["fill-translate-anchor"]),"fill-pattern":new Yr(gi.paint_fill["fill-pattern"])})},fa=function(t){function e(e){t.call(this,e,pa)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(t){this.paint=this._transitioningPaint.possiblyEvaluate(t);var e=this.paint._values["fill-outline-color"];"constant"===e.value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new ha(t)},e.prototype.queryRadius=function(){return ge(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){return se(ve(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},e}(eo),da=te([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ma=Math.pow(2,13),ya=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new so,this.indexArray=new xo,this.programConfigurations=new jo(da,t.layers,t.zoom),this.segments=new Ro};ya.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new jr(this.zoom),o)){var l=re(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},ya.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},ya.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ya.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ya.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,da),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},ya.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ya.prototype.addFeature=function(t,e,n){for(var i=0,r=ln(e,500);i<r.length;i+=1){for(var o=r[i],a=0,s=0,l=o;s<l.length;s+=1)a+=l[s].length;for(var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),c=0,h=o;c<h.length;c+=1){var p=h[c];if(0!==p.length&&!pn(p))for(var f=0,d=0;d<p.length;d++){var m=p[d];if(d>=1){var y=p[d-1];if(!hn(m,y)){u.vertexLength+4>Ro.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var g=m.sub(y)._perp()._unit(),v=y.dist(m);f+v>32768&&(f=0),cn(this.layoutVertexArray,m.x,m.y,g.x,g.y,0,0,f),cn(this.layoutVertexArray,m.x,m.y,g.x,g.y,0,1,f),f+=v,cn(this.layoutVertexArray,y.x,y.y,g.x,g.y,0,0,f),cn(this.layoutVertexArray,y.x,y.y,g.x,g.y,0,1,f);var _=u.vertexLength;this.indexArray.emplaceBack(_,_+1,_+2),this.indexArray.emplaceBack(_+1,_+2,_+3),u.vertexLength+=4,u.primitiveLength+=2}}}}u.vertexLength+a>Ro.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray));for(var x=[],b=[],w=u.vertexLength,S=0,E=o;S<E.length;S+=1){var k=E[S];if(0!==k.length){k!==o[0]&&b.push(x.length/2);for(var T=0;T<k.length;T++){var A=k[T];cn(this.layoutVertexArray,A.x,A.y,0,0,1,1,0),x.push(A.x),x.push(A.y)}}}for(var I=sa(x,b),z=0;z<I.length;z+=3)this.indexArray.emplaceBack(w+I[z],w+I[z+1],w+I[z+2]);u.primitiveLength+=I.length/3,u.vertexLength+=a}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n)},Gt("FillExtrusionBucket",ya,{omit:["layers"]});var ga={paint:new to({"fill-extrusion-opacity":new Kr(gi["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jr(gi["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kr(gi["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kr(gi["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Yr(gi["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jr(gi["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jr(gi["paint_fill-extrusion"]["fill-extrusion-base"])})},va=function(t){function e(e){t.call(this,e,ga)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new ya(t)},e.prototype.queryRadius=function(){return ge(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){return se(ve(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),i)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(eo),_a=te([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,xa=fn;fn.types=["Unknown","Point","LineString","Polygon"],fn.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,r=0,o=0,a=0,s=[];t.pos<n;){if(r<=0){var l=t.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)o+=t.readSVarint(),a+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new si(o,a));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},fn.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(i<=0){var c=t.readVarint();n=7&c,i=c>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<a&&(a=r),r>s&&(s=r),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,u]},fn.prototype.toGeoJSON=function(t,e,n){function i(t){for(var e=0;e<t.length;e++){var n=t[e],i=180-360*(n.y+l)/a;t[e]=[360*(n.x+s)/a-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}var r,o,a=this.extent*Math.pow(2,n),s=this.extent*t,l=this.extent*e,u=this.loadGeometry(),c=fn.types[this.type];switch(this.type){case 1:var h=[];for(r=0;r<u.length;r++)h[r]=u[r][0];i(u=h);break;case 2:for(r=0;r<u.length;r++)i(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var a=mn(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}(u),r=0;r<u.length;r++)for(o=0;o<u[r].length;o++)i(u[r][o])}1===u.length?u=u[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(p.id=this.id),p};var ba=yn;yn.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new xa(this._pbf,e,this.extent,this._keys,this._values)};var wa={VectorTile:function(t,e){this.layers=t.readFields(vn,{},e)},VectorTileFeature:xa,VectorTileLayer:ba},Sa=wa.VectorTileFeature.types,Ea=63,ka=Math.cos(Math.PI/180*37.5),Ta=.5,Aa=Math.pow(2,14)/Ta,Ia=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.layoutVertexArray=new lo,this.indexArray=new xo,this.programConfigurations=new jo(_a,t.layers,t.zoom),this.segments=new Ro};Ia.prototype.populate=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=i[n],o=r.feature,a=r.index,s=r.sourceLayerIndex;if(this.layers[0]._featureFilter(new jr(this.zoom),o)){var l=re(o);this.addFeature(o,l,a),e.featureIndex.insert(o,l,a,s,this.index)}}},Ia.prototype.update=function(t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers)},Ia.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ia.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ia.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_a),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ia.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ia.prototype.addFeature=function(t,e,n){for(var i=this.layers[0].layout,r=i.get("line-join").evaluate(t,{}),o=i.get("line-cap"),a=i.get("line-miter-limit"),s=i.get("line-round-limit"),l=0,u=e;l<u.length;l+=1){var c=u[l];this.addLine(c,t,r,o,a,s,n)}},Ia.prototype.addLine=function(t,e,n,i,r,o,a){var s=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(s={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var l="Polygon"===Sa[e.type],u=t.length;u>=2&&t[u-1].equals(t[u-2]);)u--;for(var c=0;c<u-1&&t[c].equals(t[c+1]);)c++;if(!(u<(l?3:2))){s&&(s.tileTotal=function(t,e,n){for(var i,r,o=0,a=e;a<n-1;a++)i=t[a],r=t[a+1],o+=i.dist(r);return o}(t,c,u)),"bevel"===n&&(r=1.05);var h=qo/(512*this.overscaling)*15,p=t[c],f=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray);this.distance=0;var d,m,y,g=i,v=l?"butt":i,_=!0,x=void 0,b=void 0,w=void 0,S=void 0;this.e1=this.e2=this.e3=-1,l&&(d=t[u-2],S=p.sub(d)._unit()._perp());for(var E=c;E<u;E++)if(!(b=l&&E===u-1?t[c+1]:t[E+1])||!t[E].equals(b)){S&&(w=S),d&&(x=d),d=t[E],S=b?b.sub(d)._unit()._perp():w;var k=(w=w||S).add(S);0===k.x&&0===k.y||k._unit();var T=k.x*S.x+k.y*S.y,A=0!==T?1/T:1/0,I=T<ka&&x&&b;if(I&&E>c){var z=d.dist(x);if(z>2*h){var C=d.sub(d.sub(x)._mult(h/z)._round());this.distance+=C.dist(x),this.addCurrentVertex(C,this.distance,w.mult(1),0,0,!1,f,s),x=C}}var M=x&&b,P=M?n:b?g:v;if(M&&"round"===P&&(A<o?P="miter":A<=2&&(P="fakeround")),"miter"===P&&A>r&&(P="bevel"),"bevel"===P&&(A>2&&(P="flipbevel"),A<r&&(P="miter")),x&&(this.distance+=d.dist(x)),"miter"===P)k._mult(A),this.addCurrentVertex(d,this.distance,k,0,0,!1,f,s);else if("flipbevel"===P){
if(A>100)k=S.clone().mult(-1);else{var L=w.x*S.y-w.y*S.x>0?-1:1,D=A*w.add(S).mag()/w.sub(S).mag();k._perp()._mult(D*L)}this.addCurrentVertex(d,this.distance,k,0,0,!1,f,s),this.addCurrentVertex(d,this.distance,k.mult(-1),0,0,!1,f,s)}else if("bevel"===P||"fakeround"===P){var R=w.x*S.y-w.y*S.x>0,B=-Math.sqrt(A*A-1);if(R?(y=0,m=B):(m=0,y=B),_||this.addCurrentVertex(d,this.distance,w,m,y,!1,f,s),"fakeround"===P){for(var O=Math.floor(8*(.5-(T-.5))),F=void 0,V=0;V<O;V++)F=S.mult((V+1)/(O+1))._add(w)._unit(),this.addPieSliceVertex(d,this.distance,F,R,f,s);this.addPieSliceVertex(d,this.distance,k,R,f,s);for(var N=O-1;N>=0;N--)F=w.mult((N+1)/(O+1))._add(S)._unit(),this.addPieSliceVertex(d,this.distance,F,R,f,s)}b&&this.addCurrentVertex(d,this.distance,S,-m,-y,!1,f,s)}else"butt"===P?(_||this.addCurrentVertex(d,this.distance,w,0,0,!1,f,s),b&&this.addCurrentVertex(d,this.distance,S,0,0,!1,f,s)):"square"===P?(_||(this.addCurrentVertex(d,this.distance,w,1,1,!1,f,s),this.e1=this.e2=-1),b&&this.addCurrentVertex(d,this.distance,S,-1,-1,!1,f,s)):"round"===P&&(_||(this.addCurrentVertex(d,this.distance,w,0,0,!1,f,s),this.addCurrentVertex(d,this.distance,w,1,1,!0,f,s),this.e1=this.e2=-1),b&&(this.addCurrentVertex(d,this.distance,S,-1,-1,!0,f,s),this.addCurrentVertex(d,this.distance,S,0,0,!1,f,s)));if(I&&E<u-1){var j=d.dist(b);if(j>2*h){var $=d.add(b.sub(d)._mult(h/j)._round());this.distance+=$.dist(d),this.addCurrentVertex($,this.distance,S.mult(1),0,0,!1,f,s),d=$}}_=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a)}},Ia.prototype.addCurrentVertex=function(t,e,n,i,r,o,a,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(e=xn(e,s)),l=n.clone(),i&&l._sub(n.perp()._mult(i)),_n(u,t,l,o,!1,i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=n.mult(-1),r&&l._sub(n.perp()._mult(r)),_n(u,t,l,o,!0,-r,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>Aa/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,i,r,o,a))},Ia.prototype.addPieSliceVertex=function(t,e,n,i,r,o){n=n.mult(i?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=xn(e,o)),_n(a,t,n,!1,i,0,e),this.e3=r.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),r.primitiveLength++),i?this.e2=this.e3:this.e1=this.e3},Gt("LineBucket",Ia,{omit:["layers"]});var za=new to({"line-cap":new Kr(gi.layout_line["line-cap"]),"line-join":new Jr(gi.layout_line["line-join"]),"line-miter-limit":new Kr(gi.layout_line["line-miter-limit"]),"line-round-limit":new Kr(gi.layout_line["line-round-limit"])}),Ca={paint:new to({"line-opacity":new Jr(gi.paint_line["line-opacity"]),"line-color":new Jr(gi.paint_line["line-color"]),"line-translate":new Kr(gi.paint_line["line-translate"]),"line-translate-anchor":new Kr(gi.paint_line["line-translate-anchor"]),"line-width":new Jr(gi.paint_line["line-width"]),"line-gap-width":new Jr(gi.paint_line["line-gap-width"]),"line-offset":new Jr(gi.paint_line["line-offset"]),"line-blur":new Jr(gi.paint_line["line-blur"]),"line-dasharray":new Yr(gi.paint_line["line-dasharray"]),"line-pattern":new Yr(gi.paint_line["line-pattern"]),"line-gradient":new Qr(gi.paint_line["line-gradient"])}),layout:za},Ma=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new jr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,i,r){return n=l({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,i,r)},e}(Jr))(Ca.paint.properties["line-width"].specification);Ma.useIntegerZoom=!0;var Pa=function(t){function e(e){t.call(this,e,Ca)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=De(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=Ma.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Ia(t)},e.prototype.queryRadius=function(t){var e=t,n=bn(ye("line-width",this,e),ye("line-gap-width",this,e)),i=ye("line-offset",this,e);return n/2+Math.abs(i)+ge(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){var s=ve(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,a),l=a/2*bn(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(i=function(t,e){for(var n=[],i=new si(0,0),r=0;r<t.length;r++){for(var o=t[r],a=[],s=0;s<o.length;s++){var l=o[s-1],u=o[s],c=o[s+1],h=0===s?i:u.sub(l)._unit()._perp(),p=s===o.length-1?i:c.sub(u)._unit()._perp(),f=h._add(p)._unit(),d=f.x*p.x+f.y*p.y;f._mult(1/d),a.push(f._mult(e)._add(u))}n.push(a)}return n}(i,u*a)),le(s,i,l)},e}(eo),La=te([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Da=te([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ra=(te([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),te([{name:"a_placed",components:2,type:"Uint8"}],4)),Ba=(te([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),te([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Oa=te([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);te([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),te([{type:"Float32",name:"offsetX"}]),te([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Fa={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Va=function(t){function e(e,n,i,r){t.call(this,e,n),this.angle=i,void 0!==r&&(this.segment=r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(si);Gt("Anchor",Va);var Na=wa.VectorTileFeature.types,ja=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],$a=function(t){this.layoutVertexArray=new uo,this.indexArray=new xo,this.programConfigurations=t,this.segments=new Ro,this.dynamicLayoutVertexArray=new co,this.opacityVertexArray=new ho,this.placedSymbolArray=new Ao};$a.prototype.upload=function(t,e,n,i){n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,La.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Da.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,ja,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t)},$a.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Gt("SymbolBuffers",$a);var qa=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Ro,this.collisionVertexArray=new mo};qa.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ra.members,!0)},qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Gt("CollisionBuffers",qa);var Ua=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sn(this.zoom,e["text-size"]),this.iconSizeData=Sn(this.zoom,e["icon-size"]);var n=this.layers[0].layout;this.sortFeaturesByY=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sourceID=t.sourceID};Ua.prototype.createArrays=function(){this.text=new $a(new jo(La.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new $a(new jo(La.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new qa(fo,Ba.members,bo),this.collisionCircle=new qa(fo,Oa.members,xo),this.glyphOffsetArray=new zo,this.lineVertexArray=new Mo},Ua.prototype.populate=function(t,e){var n=this.layers[0],i=n.layout,r=i.get("text-font"),o=i.get("text-field"),a=i.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.length>0)&&("constant"!==r.value.kind||r.value.value.length>0),l="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||l){for(var u=e.iconDependencies,c=e.glyphDependencies,h=new jr(this.zoom),p=0,f=t;p<f.length;p+=1){var d=f[p],m=d.feature,y=d.index,g=d.sourceLayerIndex;if(n._featureFilter(h,m)){var v=void 0;s&&(v=wn(v=n.getValueAndResolveTokens("text-field",m),n,m));var _=void 0;if(l&&(_=n.getValueAndResolveTokens("icon-image",m)),v||_){var x={text:v,icon:_,index:y,sourceLayerIndex:g,geometry:re(m),properties:m.properties,type:Na[m.type]};if(void 0!==m.id&&(x.id=m.id),this.features.push(x),_&&(u[_]=!0),v)for(var b=r.evaluate(m,{}).join(","),w=c[b]=c[b]||{},S="map"===i.get("text-rotation-alignment")&&"line"===i.get("symbol-placement"),E=Ht(v),k=0;k<v.length;k++)if(w[v.charCodeAt(k)]=!0,S&&E){var T=Fa[v.charAt(k)];T&&(w[T.charCodeAt(0)]=!0)}}}}"line"===i.get("symbol-placement")&&(this.features=function(t){function e(e){s.push(t[e]),l++}function n(t,e,n){var i=a[t];return delete a[t],a[e]=i,s[i].geometry[0].pop(),s[i].geometry[0]=s[i].geometry[0].concat(n[0]),i}function i(t,e,n){var i=o[e];return delete o[e],o[t]=i,s[i].geometry[0].shift(),s[i].geometry[0]=n[0].concat(s[i].geometry[0]),i}function r(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var o={},a={},s=[],l=0,u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.text;if(p){var f=r(p,h),d=r(p,h,!0);if(f in a&&d in o&&a[f]!==o[d]){var m=i(f,d,h),y=n(f,d,s[m].geometry);delete o[f],delete a[d],a[r(p,s[y].geometry,!0)]=y,s[m].geometry=null}else f in a?n(f,d,h):d in o?i(f,d,h):(e(u),o[f]=l-1,a[d]=l-1)}else e(u)}return s.filter(function(t){return t.geometry})}(this.features))}},Ua.prototype.update=function(t,e){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers))},Ua.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Ua.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ua.prototype.upload=function(t){this.uploaded||(this.collisionBox.upload(t),this.collisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ua.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Ua.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:r},s>0&&(r+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},Ua.prototype.addSymbols=function(t,e,n,i,r,o,a,s,l,u){for(var c=t.indexArray,h=t.layoutVertexArray,p=t.dynamicLayoutVertexArray,f=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),d=this.glyphOffsetArray.length,m=f.vertexLength,y=0,g=e;y<g.length;y+=1){var v=g[y],_=v.tl,x=v.tr,b=v.bl,w=v.br,S=v.tex,E=f.vertexLength,k=v.glyphOffset[1];En(h,s.x,s.y,_.x,k+_.y,S.x,S.y,n),En(h,s.x,s.y,x.x,k+x.y,S.x+S.w,S.y,n),En(h,s.x,s.y,b.x,k+b.y,S.x,S.y+S.h,n),En(h,s.x,s.y,w.x,k+w.y,S.x+S.w,S.y+S.h,n),kn(p,s,0),c.emplaceBack(E,E+1,E+2),c.emplaceBack(E+1,E+2,E+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(v.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,m,l,u,s.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index)},Ua.prototype._addCollisionDebugVertex=function(t,e,n,i,r){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i.x,i.y,Math.round(r.x),Math.round(r.y))},Ua.prototype.addCollisionDebugVertices=function(t,e,n,i,r,o,a,s){var l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),u=l.vertexLength,c=r.layoutVertexArray,h=r.collisionVertexArray;if(this._addCollisionDebugVertex(c,h,o,a.anchor,new si(t,e)),this._addCollisionDebugVertex(c,h,o,a.anchor,new si(n,e)),this._addCollisionDebugVertex(c,h,o,a.anchor,new si(n,i)),this._addCollisionDebugVertex(c,h,o,a.anchor,new si(t,i)),l.vertexLength+=4,s){var p=r.indexArray;p.emplaceBack(u,u+1,u+2),p.emplaceBack(u,u+2,u+3),l.primitiveLength+=2}else{var f=r.indexArray;f.emplaceBack(u,u+1),f.emplaceBack(u+1,u+2),f.emplaceBack(u+2,u+3),f.emplaceBack(u+3,u),l.primitiveLength+=4}},Ua.prototype.generateCollisionDebugBuffers=function(){for(var t=0,e=this.symbolInstances;t<e.length;t+=1){var n=e[t];n.textCollisionFeature={boxStartIndex:n.textBoxStartIndex,boxEndIndex:n.textBoxEndIndex},n.iconCollisionFeature={boxStartIndex:n.iconBoxStartIndex,boxEndIndex:n.iconBoxEndIndex};for(var i=0;i<2;i++){var r=n[0===i?"textCollisionFeature":"iconCollisionFeature"];if(r)for(var o=r.boxStartIndex;o<r.boxEndIndex;o++){var a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2,h=a.radius>0;this.addCollisionDebugVertices(s,l,u,c,h?this.collisionCircle:this.collisionBox,a.anchorPoint,n,h)}}}},Ua.prototype.deserializeCollisionBoxes=function(t,e,n,i,r){for(var o={},a=e;a<n;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=i;l<r;l++){var u=t.get(l);if(0===u.radius){o.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},o.iconFeatureIndex=u.featureIndex;break}}return o},Ua.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ua.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ua.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},Ua.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},Ua.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var n=[],i=0;i<this.symbolInstances.length;i++)n.push(i);var r=Math.sin(t),o=Math.cos(t);n.sort(function(t,n){var i=e.symbolInstances[t],a=e.symbolInstances[n];return(r*i.anchor.x+o*i.anchor.y|0)-(r*a.anchor.x+o*a.anchor.y|0)||a.featureIndex-i.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var a=0,s=n;a<s.length;a+=1){var l=s[a],u=e.symbolInstances[l];e.featureSortOrder.push(u.featureIndex);for(var c=0,h=u.placedTextSymbolIndices;c<h.length;c+=1)for(var p=h[c],f=e.text.placedSymbolArray.get(p),d=f.vertexStartIndex+4*f.numGlyphs,m=f.vertexStartIndex;m<d;m+=4)e.text.indexArray.emplaceBack(m,m+1,m+2),e.text.indexArray.emplaceBack(m+1,m+2,m+3);var y=e.icon.placedSymbolArray.get(l);if(y.numGlyphs){var g=y.vertexStartIndex;e.icon.indexArray.emplaceBack(g,g+1,g+2),e.icon.indexArray.emplaceBack(g+1,g+2,g+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Gt("SymbolBucket",Ua,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),Ua.MAX_GLYPHS=65535,Ua.addDynamicAttributes=kn;var Za=new to({"symbol-placement":new Kr(gi.layout_symbol["symbol-placement"]),"symbol-spacing":new Kr(gi.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kr(gi.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new Kr(gi.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kr(gi.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kr(gi.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kr(gi.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jr(gi.layout_symbol["icon-size"]),"icon-text-fit":new Kr(gi.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kr(gi.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jr(gi.layout_symbol["icon-image"]),"icon-rotate":new Jr(gi.layout_symbol["icon-rotate"]),"icon-padding":new Kr(gi.layout_symbol["icon-padding"]),"icon-keep-upright":new Kr(gi.layout_symbol["icon-keep-upright"]),"icon-offset":new Jr(gi.layout_symbol["icon-offset"]),"icon-anchor":new Jr(gi.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kr(gi.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kr(gi.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kr(gi.layout_symbol["text-rotation-alignment"]),"text-field":new Jr(gi.layout_symbol["text-field"]),"text-font":new Jr(gi.layout_symbol["text-font"]),"text-size":new Jr(gi.layout_symbol["text-size"]),"text-max-width":new Jr(gi.layout_symbol["text-max-width"]),"text-line-height":new Kr(gi.layout_symbol["text-line-height"]),"text-letter-spacing":new Jr(gi.layout_symbol["text-letter-spacing"]),"text-justify":new Jr(gi.layout_symbol["text-justify"]),"text-anchor":new Jr(gi.layout_symbol["text-anchor"]),"text-max-angle":new Kr(gi.layout_symbol["text-max-angle"]),"text-rotate":new Jr(gi.layout_symbol["text-rotate"]),"text-padding":new Kr(gi.layout_symbol["text-padding"]),"text-keep-upright":new Kr(gi.layout_symbol["text-keep-upright"]),"text-transform":new Jr(gi.layout_symbol["text-transform"]),"text-offset":new Jr(gi.layout_symbol["text-offset"]),"text-allow-overlap":new Kr(gi.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kr(gi.layout_symbol["text-ignore-placement"]),"text-optional":new Kr(gi.layout_symbol["text-optional"])}),Ga={paint:new to({"icon-opacity":new Jr(gi.paint_symbol["icon-opacity"]),"icon-color":new Jr(gi.paint_symbol["icon-color"]),"icon-halo-color":new Jr(gi.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jr(gi.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jr(gi.paint_symbol["icon-halo-blur"]),"icon-translate":new Kr(gi.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kr(gi.paint_symbol["icon-translate-anchor"]),"text-opacity":new Jr(gi.paint_symbol["text-opacity"]),"text-color":new Jr(gi.paint_symbol["text-color"]),"text-halo-color":new Jr(gi.paint_symbol["text-halo-color"]),"text-halo-width":new Jr(gi.paint_symbol["text-halo-width"]),"text-halo-blur":new Jr(gi.paint_symbol["text-halo-blur"]),"text-translate":new Kr(gi.paint_symbol["text-translate"]),"text-translate-anchor":new Kr(gi.paint_symbol["text-translate-anchor"])}),layout:Za},Wa=function(t){function e(e){t.call(this,e,Ga)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var n,i=this.layout.get(t).evaluate(e,{}),r=this._unevaluatedLayout._values[t];return r.isDataDriven()||ft(r.value)?i:(n=e.properties,i.replace(/{([^{}]+)}/g,function(t,e){return e in n?String(n[e]):""}))},e.prototype.createBucket=function(t){return new Ua(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(eo),Xa={paint:new to({"background-color":new Kr(gi.paint_background["background-color"]),"background-pattern":new Yr(gi.paint_background["background-pattern"]),"background-opacity":new Kr(gi.paint_background["background-opacity"])})},Ha=function(t){function e(e){t.call(this,e,Xa)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(eo),Ka={paint:new to({"raster-opacity":new Kr(gi.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kr(gi.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kr(gi.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kr(gi.paint_raster["raster-brightness-max"]),"raster-saturation":new Kr(gi.paint_raster["raster-saturation"]),"raster-contrast":new Kr(gi.paint_raster["raster-contrast"]),"raster-fade-duration":new Kr(gi.paint_raster["raster-fade-duration"])})},Ja={circle:Yo,heatmap:ia,hillshade:oa,fill:fa,"fill-extrusion":va,line:Pa,symbol:Wa,background:Ha,raster:function(t){function e(e){t.call(this,e,Ka)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(eo)},Ya=n(function(t,e){t.exports=function(){function t(t,e,n){n=n||{},this.w=t||64,this.h=e||64,this.autoResize=!!n.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,n){this.x=0,this.y=t,this.w=this.free=e,this.h=n}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var n,i,r,o,a=[],s=0;s<t.length;s++)if(n=t[s].w||t[s].width,i=t[s].h||t[s].height,r=t[s].id,n&&i){if(!(o=this.packOne(n,i,r)))continue;e.inPlace&&(t[s].x=o.x,t[s].y=o.y,t[s].id=o.id),a.push(o)}return this.shrink(),a},t.prototype.packOne=function(t,n,i){var r,o,a,s,l,u,c,h,p={freebin:-1,shelf:-1,waste:1/0},f=0;if("string"==typeof i||"number"==typeof i){if(r=this.getBin(i))return this.ref(r),r;"number"==typeof i&&(this.maxId=Math.max(i,this.maxId))}else i=++this.maxId;for(s=0;s<this.freebins.length;s++){if(n===(r=this.freebins[s]).maxh&&t===r.maxw)return this.allocFreebin(s,t,n,i);n>r.maxh||t>r.maxw||n<=r.maxh&&t<=r.maxw&&(a=r.maxw*r.maxh-t*n)<p.waste&&(p.waste=a,p.freebin=s)}for(s=0;s<this.shelves.length;s++)if(f+=(o=this.shelves[s]).h,!(t>o.free)){if(n===o.h)return this.allocShelf(s,t,n,i);n>o.h||n<o.h&&(a=(o.h-n)*t)<p.waste&&(p.freebin=-1,p.waste=a,p.shelf=s)}return-1!==p.freebin?this.allocFreebin(p.freebin,t,n,i):-1!==p.shelf?this.allocShelf(p.shelf,t,n,i):n<=this.h-f&&t<=this.w?(o=new e(f,this.w,n),this.allocShelf(this.shelves.push(o)-1,t,n,i)):this.autoResize?(l=u=this.h,((c=h=this.w)<=l||t>c)&&(h=2*Math.max(t,c)),(l<c||n>l)&&(u=2*Math.max(n,l)),this.resize(h,u),this.packOne(t,n,i)):null},t.prototype.allocFreebin=function(t,e,n,i){var r=this.freebins.splice(t,1)[0];return r.id=i,r.w=e,r.h=n,r.refcount=0,this.bins[i]=r,this.ref(r),r},t.prototype.allocShelf=function(t,e,n,i){var r=this.shelves[t].alloc(e,n,i);return this.bins[i]=r,this.ref(r),r},t.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,n=0;n<this.shelves.length;n++){var i=this.shelves[n];e+=i.h,t=Math.max(i.w-i.free,t)}this.resize(t,e)}},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var n=0;n<this.shelves.length;n++)this.shelves[n].resize(t);return!0},e.prototype.alloc=function(t,e,n){if(t>this.free||e>this.h)return null;var i=this.x;return this.x+=t,this.free-=t,new function(t,e,n,i,r,o,a){this.id=t,this.x=e,this.y=n,this.w=i,this.h=r,this.maxw=o||i,this.maxh=a||r,this.refcount=0}(n,i,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t}()}),Qa=function(t,e){var n=e.pixelRatio;this.paddedRect=t,this.pixelRatio=n},ts={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};ts.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ts.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ts.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Qa.prototype,ts);var es=function(t){var e=new ea({width:0,height:0}),n={},i=new Ya(0,0,{autoResize:!0});for(var r in t){var o=t[r],a=i.packOne(o.data.width+2,o.data.height+2);e.resize({width:i.w,height:i.h}),ea.copy(o.data,e,{x:0,y:0},{x:a.x+1,y:a.y+1},o.data),n[r]=new Qa(a,o)}i.shrink(),e.resize({width:i.w,height:i.h}),this.image=e,this.positions=n};Gt("ImagePosition",Qa),Gt("ImageAtlas",es);var ns=self.HTMLImageElement,is=self.HTMLCanvasElement,rs=self.HTMLVideoElement,os=self.ImageData,as=function(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)};as.prototype.update=function(t,e){var n=t.width,i=t.height,r=!this.size||this.size[0]!==n||this.size[1]!==i,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),r?(this.size=[n,i],o.pixelStoreUnpack.set(1),this.format!==a.RGBA||e&&!1===e.premultiply||o.pixelStoreUnpackPremultiplyAlpha.set(!0),t instanceof ns||t instanceof is||t instanceof rs||t instanceof os?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,i,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof ns||t instanceof is||t instanceof rs||t instanceof os?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,n,i,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},as.prototype.bind=function(t,e,n){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},as.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},as.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ss=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=u}return(f?-1:1)*a*Math.pow(2,o-i)},ls=function(t,e,n,i,r,o){var a,s,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=255&s,f+=d,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[n+f]=255&a,f+=d,a/=256,u-=8);t[n+f-d]|=128*m},us=Tn;Tn.Varint=0,Tn.Fixed64=1,Tn.Bytes=2,Tn.Fixed32=5,Tn.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Vn(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=jn(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Vn(this.buf,this.pos)+4294967296*Vn(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Vn(this.buf,this.pos)+4294967296*jn(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ss(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ss(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(r=o[n.pos++],i=(112&r)>>4,r<128)return In(t,i,e);if(r=o[n.pos++],i|=(127&r)<<3,r<128)return In(t,i,e);if(r=o[n.pos++],i|=(127&r)<<10,r<128)return In(t,i,e);if(r=o[n.pos++],i|=(127&r)<<17,r<128)return In(t,i,e);if(r=o[n.pos++],i|=(127&r)<<24,r<128)return In(t,i,e);if(r=o[n.pos++],i|=(1&r)<<31,r<128)return In(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},
readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){for(var i="",r=e;r<n;){var o,a,s,l=t[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),r+=c}return i}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=An(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=An(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Tn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Tn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Tn.Fixed32)this.pos+=4;else{if(e!==Tn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Nn(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Nn(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Nn(this.buf,-1&t,this.pos),Nn(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Nn(this.buf,-1&t,this.pos),Nn(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&zn(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),ls(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ls(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&zn(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,Tn.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,Cn,e)},writePackedSVarint:function(t,e){this.writeMessage(t,Mn,e)},writePackedBoolean:function(t,e){this.writeMessage(t,Dn,e)},writePackedFloat:function(t,e){this.writeMessage(t,Pn,e)},writePackedDouble:function(t,e){this.writeMessage(t,Ln,e)},writePackedFixed32:function(t,e){this.writeMessage(t,Rn,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,Bn,e)},writePackedFixed64:function(t,e){this.writeMessage(t,On,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,Fn,e)},writeBytesField:function(t,e){this.writeTag(t,Tn.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Tn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Tn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Tn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Tn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Tn.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Tn.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Tn.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Tn.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Tn.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var cs=3,hs=cs,ps=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.callbackID=0,c(["receive"],this),this.target.addEventListener("message",this.receive,!1)};ps.prototype.send=function(t,e,n,i){var r=n?this.mapId+":"+this.callbackID++:null;n&&(this.callbacks[r]=n);var o=[];this.target.postMessage({targetMapId:i,sourceMapId:this.mapId,type:t,id:String(r),data:Wt(e,o)},o)},ps.prototype.receive=function(t){var e,n=this,i=t.data,r=i.id;if(!i.targetMapId||this.mapId===i.targetMapId){var o=function(t,e){var i=[];n.target.postMessage({sourceMapId:n.mapId,type:"<response>",id:String(r),error:t?Wt(t):null,data:Wt(e,i)},i)};if("<response>"===i.type)e=this.callbacks[i.id],delete this.callbacks[i.id],e&&i.error?e(Xt(i.error)):e&&e(null,Xt(i.data));else if(void 0!==i.id&&this.parent[i.type])this.parent[i.type](i.sourceMapId,Xt(i.data),o);else if(void 0!==i.id&&this.parent.getWorkerSource){var a=i.type.split("."),s=Xt(i.data);this.parent.getWorkerSource(i.sourceMapId,a[0],s.source)[a[1]](s,o)}else this.parent[i.type](Xt(i.data))}},ps.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var fs=n(function(t,e){!function(t){function e(t,e,i){e=Math.pow(2,i)-e-1;var r=n(256*t,256*e,i),o=n(256*(t+1),256*(e+1),i);return r[0]+","+r[1]+","+o[0]+","+o[1]}function n(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}t.getURL=function(t,n,i,r,o,a){return a=a||{},t+"?"+["bbox="+e(i,r,o),"format="+(a.format||"image/png"),"service="+(a.service||"WMS"),"version="+(a.version||"1.1.1"),"request="+(a.request||"GetMap"),"srs="+(a.srs||"EPSG:3857"),"width="+(a.width||256),"height="+(a.height||256),"layers="+n].join("&")},t.getTileBBox=e,t.getMercCoords=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)});e(fs);var ds=fs.getTileBBox,ms=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Zn(0,t,e,n)};ms.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},ms.prototype.url=function(t,e){var n=ds(this.x,this.y,this.z),i=function(t,e,n){for(var i,r="",o=t;o>0;o--)r+=(e&(i=1<<o-1)?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",n)};var ys=function(t,e){this.wrap=t,this.canonical=e,this.key=Zn(t,e.z,e.x,e.y)},gs=function(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new ms(n,+i,+r),this.key=Zn(e,t,i,r)};gs.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},gs.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new gs(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new gs(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},gs.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},gs.prototype.children=function(t){if(this.overscaledZ>=t)return[new gs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new gs(e,this.wrap,e,n,i),new gs(e,this.wrap,e,n+1,i),new gs(e,this.wrap,e,n,i+1),new gs(e,this.wrap,e,n+1,i+1)]},gs.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},gs.prototype.wrapped=function(){return new gs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},gs.prototype.unwrapTo=function(t){return new gs(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},gs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},gs.prototype.toUnwrapped=function(){return new ys(this.wrap,this.canonical)},gs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},gs.prototype.toCoordinate=function(){return new ai(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},Gt("CanonicalTileID",ms),Gt("OverscaledTileID",gs,{omit:["posMatrix"]});var vs=function(t,e,n){if(t<=0)throw new RangeError("Level must have positive dimension");this.dim=t,this.border=e,this.stride=this.dim+2*this.border,this.data=n||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};vs.prototype.set=function(t,e,n){this.data[this._idx(t,e)]=n+65536},vs.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},vs.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},Gt("Level",vs);var _s=function(t,e,n){this.uid=t,this.scale=e||1,this.level=n||new vs(256,512),this.loaded=!!n};_s.prototype.loadFromImage=function(t,e){if(t.height!==t.width)throw new RangeError("DEM tiles must be square");if(e&&"mapbox"!==e&&"terrarium"!==e)return m('"'+e+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var n=this.level=new vs(t.width,t.width/2),i=t.data;this._unpackData(n,i,e||"mapbox");for(var r=0;r<n.dim;r++)n.set(-1,r,n.get(0,r)),n.set(n.dim,r,n.get(n.dim-1,r)),n.set(r,-1,n.get(r,0)),n.set(r,n.dim,n.get(r,n.dim-1));n.set(-1,-1,n.get(0,0)),n.set(n.dim,-1,n.get(n.dim-1,0)),n.set(-1,n.dim,n.get(0,n.dim-1)),n.set(n.dim,n.dim,n.get(n.dim-1,n.dim-1)),this.loaded=!0},_s.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},_s.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},_s.prototype._unpackData=function(t,e,n){for(var i={mapbox:this._unpackMapbox,terrarium:this._unpackTerrarium}[n],r=0;r<t.dim;r++)for(var o=0;o<t.dim;o++){var a=4*(r*t.dim+o);t.set(o,r,this.scale*i(e[a],e[a+1],e[a+2]))}},_s.prototype.getPixels=function(){return new ea({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},_s.prototype.backfillBorder=function(t,e,n){var i=this.level,r=t.level;if(i.dim!==r.dim)throw new Error("level mismatch (dem dimension)");var o=e*i.dim,a=e*i.dim+i.dim,l=n*i.dim,u=n*i.dim+i.dim;switch(e){case-1:o=a-1;break;case 1:a=o+1}switch(n){case-1:l=u-1;break;case 1:u=l+1}for(var c=s(o,-i.border,i.dim+i.border),h=s(a,-i.border,i.dim+i.border),p=s(l,-i.border,i.dim+i.border),f=s(u,-i.border,i.dim+i.border),d=-e*i.dim,m=-n*i.dim,y=p;y<f;y++)for(var g=c;g<h;g++)i.set(g,y,r.get(g+d,y+m))},Gt("DEMData",_s);var xs=te([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),bs=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};bs.prototype.encode=function(t){return this._stringToNumber[t]},bs.prototype.decode=function(t){return this._numberToString[t]};var ws=function(t,e,n,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Ss={geometry:{configurable:!0}};Ss.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ss.geometry.set=function(t){this._geometry=t},ws.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(ws.prototype,Ss);var Es=function(){this.state={},this.stateChanges={}};Es.prototype.updateState=function(t,e,n){e=String(e),this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][e]=this.stateChanges[t][e]||{},l(this.stateChanges[t][e],n)},Es.prototype.getState=function(t,e){return e=String(e),l({},(this.state[t]||{})[e],(this.stateChanges[t]||{})[e])},Es.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Es.prototype.coalesceChanges=function(t,e){var n={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var r={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),l(this.state[i][o],this.stateChanges[i][o]),r[o]=this.state[i][o];n[i]=r}if(this.stateChanges={},0!==Object.keys(n).length)for(var a in t)t[a].setFeatureState(n,e)};var ks=function(t,e,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new Ir(qo,16,0),this.featureIndexArray=n||new Lo};ks.prototype.insert=function(t,e,n,i,r){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);for(var a=0;a<e.length;a++){for(var s=e[a],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<qo&&l[1]<qo&&l[2]>=0&&l[3]>=0&&this.grid.insert(o,l[0],l[1],l[2],l[3])}},ks.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wa.VectorTile(new us(this.rawTileData)).layers,this.sourceLayerCoder=new bs(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ks.prototype.query=function(t,e,n){var i=this;this.loadVTLayers();for(var r=t.params||{},o=qo/t.tileSize/t.scale,a=Et(r.filter),s=t.queryGeometry,l=t.queryPadding*o,u=1/0,c=1/0,h=-1/0,p=-1/0,f=0;f<s.length;f++)for(var d=s[f],m=0;m<d.length;m++){var y=d[m];u=Math.min(u,y.x),c=Math.min(c,y.y),h=Math.max(h,y.x),p=Math.max(p,y.y)}var g=this.grid.query(u-l,c-l,h+l,p+l);g.sort(Gn);for(var v,_={},x=0;x<g.length;x++)!function(l){var u=g[l];if(u!==v){v=u;var c=i.featureIndexArray.get(u),h=null;i.loadMatchingFeature(_,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,a,r.layers,e,function(e,r){h||(h=re(e));var a={};return e.id&&(a=n.getState(r.sourceLayer||"_geojsonTileLayer",String(e.id))),r.queryIntersectsFeature(s,e,a,h,i.z,t.transform,o,t.posMatrix)})}}(x);return _},ks.prototype.loadMatchingFeature=function(t,e,n,i,r,o,a,s){var l=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,l)){var u=this.sourceLayerCoder.decode(n),c=this.vtLayers[u].feature(i);if(r(new jr(this.tileID.overscaledZ),c))for(var h=0;h<l.length;h++){var p=l[h];if(!(o&&o.indexOf(p)<0)){var f=a[p];if(f&&(!s||s(c,f))){var d=new ws(c,this.z,this.x,this.y);d.layer=f.serialize();var m=t[p];void 0===m&&(m=t[p]=[]),m.push({featureIndex:i,feature:d})}}}}},ks.prototype.lookupSymbolFeatures=function(t,e,n,i,r,o){var a={};this.loadVTLayers();for(var s=Et(i),l=0,u=t;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(a,e,n,c,s,r,o)}return a},ks.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var i=0,r=n[e];i<r.length;i+=1)if(t===r[i])return!0;return!1},Gt("FeatureIndex",ks,{omit:["rawTileData","sourceLayerCoder"]});var Ts=function(t,e){this.tileID=t,this.uid=u(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.expiredRequestCount=0,this.state="loading"};Ts.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<ii.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Ts.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ts.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){if(t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length){o.layers=a,o.stateDependentLayers=a.filter(function(t){return t.isStateDependent()});for(var s=0,l=a;s<l.length;s+=1)n[l[s].id]=o}}return n}(t.buckets,e.style),n)for(var i in this.buckets){var r=this.buckets[i];r instanceof Ua&&(r.justReloaded=!0)}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(a.layerIds[0]).queryRadius(a))}t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new ko},Ts.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ts.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},Ts.prototype.getBucket=function(t){return this.buckets[t.id]},Ts.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var i=t.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new as(t,this.iconAtlasImage,i.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new as(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},Ts.prototype.queryRenderedFeatures=function(t,e,n,i,r,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,scale:i,tileSize:this.tileSize,posMatrix:s,transform:o,params:r,queryPadding:this.queryPadding*a},t,e):{}},Ts.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),i=e?e.sourceLayer:"",r=n._geojsonTileLayer||n[i];if(r)for(var o=Et(e&&e.filter),a={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},s=0;s<r.length;s++){var l=r.feature(s);if(o(new jr(this.tileID.overscaledZ),l)){var u=new ws(l,a.z,a.x,a.y);u.tile=a,t.push(u)}}}},Ts.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},Ts.prototype.setMask=function(t,e){if(!o(this.mask,t)&&(this.mask=t,this.clearMask(),!o(t,{0:!0}))){var n=new ao,i=new xo;this.segments=new Ro,this.segments.prepareSegment(0,n,i);for(var r=Object.keys(t),a=0;a<r.length;a++){var s=t[r[a]],l=qo>>s.z,u=new si(s.x*l,s.y*l),c=new si(u.x+l,u.y+l),h=this.segments.prepareSegment(4,n,i);n.emplaceBack(u.x,u.y,u.x,u.y),n.emplaceBack(c.x,u.y,c.x,u.y),n.emplaceBack(u.x,c.y,u.x,c.y),n.emplaceBack(c.x,c.y,c.x,c.y);var p=h.vertexLength;i.emplaceBack(p,p+1,p+2),i.emplaceBack(p+1,p+2,p+3),h.vertexLength+=4,h.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(n,xs.members),this.maskedIndexBuffer=e.createIndexBuffer(i)}},Ts.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ts.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,n,i,r){var o=i||r;return e[n]=!o||o.toLowerCase(),""}),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),r=!1;if(this.expirationTime>i)r=!1;else if(e)if(this.expirationTime<e)r=!0;else{var o=this.expirationTime-e;o?this.expirationTime=i+Math.max(o,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ts.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ts.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets){var r=this.buckets[i],o=r.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(r.update(s,a),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(r.layerIds[0]).queryRadius(r))))}}};var As={horizontal:1,vertical:2,horizontalOnly:3},Is={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},zs={};zs[10]=!0,zs[32]=!0,zs[38]=!0,zs[40]=!0,zs[41]=!0,zs[43]=!0,zs[45]=!0,zs[47]=!0,zs[173]=!0,zs[183]=!0,zs[8203]=!0,zs[8208]=!0,zs[8211]=!0,zs[8231]=!0,t.commonjsGlobal=Qn,t.unwrapExports=e,t.createCommonjsModule=n,t.default=si,t.default$1=self,t.default$2=ii,t.getJSON=function(t,e){var n=v(t);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i;try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i)}else e(401===n.status&&t.url.match(/mapbox.com/)?new pi(n.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",n.status,t.url):new pi(n.statusText,n.status,t.url))},n.send(),n},t.getImage=function(t,e){return fi(t,function(t,n){if(t)e(t);else if(n){var i=new self.Image,r=self.URL||self.webkitURL;i.onload=function(){e(null,i),r.revokeObjectURL(i.src)};var o=new self.Blob([new Uint8Array(n.data)],{type:"image/png"});i.cacheControl=n.cacheControl,i.expires=n.expires,i.src=n.data.byteLength?r.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},t.ResourceType=hi,t.RGBAImage=ea,t.default$3=Ya,t.ImagePosition=Qa,t.default$4=as,t.getArrayBuffer=fi,t.default$5=function(t){return new us(t).readFields($n,[])},t.default$6=Rr,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),r[a]=e,0==--i&&n(o,r)})})},t.AlphaImage=ta,t.default$7=gi,t.endsWith=h,t.extend=l,t.sphericalToCartesian=function(t){var e=t[0],n=t[1],i=t[2];return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(i),y:e*Math.sin(n)*Math.sin(i),z:e*Math.cos(i)}},t.Evented=yi,t.validateStyle=Er,t.validateLight=kr,t.emitValidationErrors=Ut,t.default$8=Mi,t.number=R,t.Properties=to,t.Transitionable=Ur,t.Transitioning=Gr,t.PossiblyEvaluated=Hr,t.DataConstantProperty=Kr,t.warnOnce=m,t.uniqueId=u,t.default$9=ps,t.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n},t.wrap=function(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r},t.clamp=s,t.Event=di,t.ErrorEvent=mi,t.OverscaledTileID=gs,t.default$10=qo,t.getCoordinatesCenter=function(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,o=0;o<t.length;o++)e=Math.min(e,t[o].column),n=Math.min(n,t[o].row),i=Math.max(i,t[o].column),r=Math.max(r,t[o].row);var a=i-e,s=r-n,l=Math.max(a,s),u=Math.max(0,Math.floor(-Math.log(l)/Math.LN2));return new ai((e+i)/2,(n+r)/2,0).zoomTo(u)},t.CanonicalTileID=ms,t.RasterBoundsArray=ao,t.default$11=xs,t.getVideo=function(t,e){var n,i,r=self.document.createElement("video");r.onloadstart=function(){e(null,r)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");n=t[o],i=void 0,(i=self.document.createElement("a")).href=n,(i.protocol!==self.document.location.protocol||i.host!==self.document.location.host)&&(r.crossOrigin="Anonymous"),a.src=t[o],r.appendChild(a)}return r},t.default$12=vi,t.bindAll=c,t.default$13=o,t.default$14=Ts,t.default$15=ai,t.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},t.default$16=Es,t.default$17=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.create=function(){var t=new Wo(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],m=e[13],y=e[14],g=e[15],v=n*s-i*a,_=n*l-r*a,x=n*u-o*a,b=i*l-r*s,w=i*u-o*s,S=r*u-o*l,E=c*m-h*d,k=c*y-p*d,T=c*g-f*d,A=h*y-p*m,I=h*g-f*m,z=p*g-f*y,C=v*z-_*I+x*A+b*T-w*k+S*E;return C?(C=1/C,t[0]=(s*z-l*I+u*A)*C,t[1]=(r*I-i*z-o*A)*C,t[2]=(m*S-y*w+g*b)*C,t[3]=(p*w-h*S-f*b)*C,t[4]=(l*T-a*z-u*k)*C,t[5]=(n*z-r*T+o*k)*C,t[6]=(y*x-d*S-g*_)*C,t[7]=(c*S-p*x+f*_)*C,t[8]=(a*I-s*T+u*E)*C,t[9]=(i*T-n*I-o*E)*C,t[10]=(d*w-m*x+g*v)*C,t[11]=(h*x-c*w-f*v)*C,t[12]=(s*k-a*A-l*E)*C,t[13]=(n*A-i*k+r*E)*C,t[14]=(m*_-d*b-y*v)*C,t[15]=(c*b-h*_+p*v)*C,t):null},t.multiply=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],m=e[12],y=e[13],g=e[14],v=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*i+x*s+b*h+w*m,t[1]=_*r+x*l+b*p+w*y,t[2]=_*o+x*u+b*f+w*g,t[3]=_*a+x*c+b*d+w*v,_=n[4],x=n[5],b=n[6],w=n[7],t[4]=_*i+x*s+b*h+w*m,t[5]=_*r+x*l+b*p+w*y,t[6]=_*o+x*u+b*f+w*g,t[7]=_*a+x*c+b*d+w*v,_=n[8],x=n[9],b=n[10],w=n[11],t[8]=_*i+x*s+b*h+w*m,t[9]=_*r+x*l+b*p+w*y,t[10]=_*o+x*u+b*f+w*g,t[11]=_*a+x*c+b*d+w*v,_=n[12],x=n[13],b=n[14],w=n[15],t[12]=_*i+x*s+b*h+w*m,t[13]=_*r+x*l+b*p+w*y,t[14]=_*o+x*u+b*f+w*g,t[15]=_*a+x*c+b*d+w*v,t},t.translate=function(t,e,n){var i,r,o,a,s,l,u,c,h,p,f,d,m=n[0],y=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*g+e[12],t[13]=e[1]*m+e[5]*y+e[9]*g+e[13],t[14]=e[2]*m+e[6]*y+e[10]*g+e[14],t[15]=e[3]*m+e[7]*y+e[11]*g+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=i*m+s*y+h*g+e[12],t[13]=r*m+l*y+p*g+e[13],t[14]=o*m+u*y+f*g+e[14],t[15]=a*m+c*y+d*g+e[15]),t},t.scale=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=a*r+c*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=u*r-o*i,t[9]=c*r-a*i,t[10]=h*r-s*i,t[11]=p*r-l*i,t},t.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=a*r+c*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=u*r-o*i,t[5]=c*r-a*i,t[6]=h*r-s*i,t[7]=p*r-l*i,t},t.perspective=function(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t},t.ortho=function(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*u,t[15]=1,t},t.create$1=Te,t.normalize=Ae,t.transformMat4=Ie,t.forEach=Jo,t.getSizeData=Sn,t.evaluateSizeForFeature=function(t,e,n){var i=e;return"source"===t.functionType?n.lowerSize/10:"composite"===t.functionType?R(n.lowerSize/10,n.upperSize/10,i.uSizeT):i.uSize},t.evaluateSizeForZoom=function(t,e,n){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var i=t.propertyValue,r=t.zoomRange,o=t.sizeRange,a=s(yt(i,n.specification).interpolationFactor(e,r.min,r.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var l=t.propertyValue,u=t.zoomRange;return{uSizeT:s(yt(l,n.specification).interpolationFactor(e,u.min,u.max),0,1),uSize:0}},t.addDynamicAttributes=kn,t.default$18=Ga,t.WritingMode=As,t.multiPolygonIntersectsBufferedPoint=ae,t.multiPolygonIntersectsMultiPolygon=se,t.multiPolygonIntersectsBufferedMultiLine=le,t.polygonIntersectsPolygon=function(t,e){for(var n=0;n<t.length;n++)if(me(e,t[n]))return!0;for(var i=0;i<e.length;i++)if(me(t,e[i]))return!0;return!!ce(t,e)},t.distToSegmentSquared=fe,t.default$19=eo,t.default$20=function(t){return new Ja[t.type](t)},t.clone=d,t.filterObject=f,t.mapObject=p,t.registerForPluginAvailability=function(t){return Or?t({pluginURL:Or,completionCallback:Dr}):Vr.once("pluginAvailable",t),t},t.evented=Vr,t.default$21=Lr,t.createLayout=te,t.default$22=No,t.create$2=_e,t.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.create$3=xe,t.length=be,t.fromValues=we,t.normalize$1=Se,t.dot=Ee,t.cross=ke,t.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],
t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},t.len=Ho,t.forEach$1=Ko,t.PosArray=oo,t.UnwrappedTileID=ys,t.create$4=function(){var t=new Wo(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},t.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*s,t[1]=r*l+a*s,t[2]=i*-s+o*l,t[3]=r*-s+a*l,t},t.ease=li,t.bezier=a,t.default$23=jr,t.setRTLTextPlugin=function(t,e){if(Br)throw new Error("setRTLTextPlugin cannot be called multiple times.");Br=!0,Or=ii.resolveURL(t),Dr=function(t){t?(Br=!1,Or=null,e&&e(t)):Fr=!0},Vr.fire(new di("pluginAvailable",{pluginURL:Or,completionCallback:Dr}))},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.default$24=Et,t.default$25=Va,t.register=Gt,t.GLYPH_PBF_BORDER=hs,t.shapeText=function(t,e,n,i,r,o,a,s,l,u){var c=t.trim();u===As.vertical&&(c=function(t){for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;i&&Yt(i)&&!Fa[t[n+1]]||r&&Yt(r)&&!Fa[t[n-1]]||!Fa[t[n]]?e+=t[n]:e+=Fa[t[n]]}return e}(c));var h=[],p={positionedGlyphs:h,text:c,top:s[1],bottom:s[1],left:s[0],right:s[0],writingMode:u},f=Nr.processBidirectionalText;return function(t,e,n,i,r,o,a,s,l){for(var u=0,c=-17,h=0,p=t.positionedGlyphs,f="right"===o?1:"left"===o?0:.5,d=0,m=n;d<m.length;d+=1){var y=m[d];if((y=y.trim()).length){for(var g=p.length,v=0;v<y.length;v++){var _=y.charCodeAt(v),x=e[_];x&&(Jt(_)&&a!==As.horizontal?(p.push({glyph:_,x:u,y:0,vertical:!0}),u+=l+s):(p.push({glyph:_,x:u,y:c,vertical:!1}),u+=x.metrics.advance+s))}if(p.length!==g){var b=u-s;h=Math.max(b,h),Yn(p,e,g,p.length-1,f)}u=0,c+=i}else c+=i}var w=Jn(r),S=w.horizontalAlign,E=w.verticalAlign;!function(t,e,n,i,r,o,a){for(var s=(e-n)*r,l=(-i*a+.5)*o,u=0;u<t.length;u++)t[u].x+=s,t[u].y+=l}(p,f,S,E,h,i,n.length);var k=n.length*i;t.top+=-E*k,t.bottom=t.top+k,t.left+=-S*h,t.right=t.left+h}(p,e,f?f(c,Kn(c,a,n,e)):function(t,e){for(var n=[],i=0,r=0,o=e;r<o.length;r+=1){var a=o[r];n.push(t.substring(i,a)),i=a}return i<t.length&&n.push(t.substring(i,t.length)),n}(c,Kn(c,a,n,e)),i,r,o,u,a,l),!!h.length&&p},t.shapeIcon=function(t,e,n){var i=Jn(n),r=i.horizontalAlign,o=i.verticalAlign,a=e[0],s=e[1],l=a-t.displaySize[0]*r,u=l+t.displaySize[0],c=s-t.displaySize[1]*o;return{image:t,top:c,bottom:c+t.displaySize[1],left:l,right:u}},t.allowsVerticalWritingMode=Ht,t.allowsLetterSpacing=function(t){for(var e=0,n=t;e<n.length;e+=1)if(!Kt(n[e].charCodeAt(0)))return!1;return!0},t.default$26=ln,t.default$27=Ua,t.default$28=ks,t.CollisionBoxArray=ko,t.default$29=bs,t.default$30=es,t.default$31=wa,t.default$32=us,t.default$33=_s,t.__moduleExports=wa,t.default$34=si,t.__moduleExports$1=us,t.plugin=Nr}),t(["./chunk1.js"],function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",r=0,o=t;r<o.length;r+=1)i+=e(o[r])+",";return i+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function n(n){for(var i="",r=0,o=t.default$17;r<o.length;r+=1)i+="/"+e(n[o[r]]);return i}function i(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],u=0;s<n/2;){var c=t[a-1],h=t[a],p=t[a+1];if(!p)return!1;var f=c.angleTo(h)-h.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:f}),u+=f;s-l[0].distance>i;)u-=l.shift().angleDelta;if(u>r)return!1;a++,s+=h.dist(p)}return!0}function r(e,n,r,o,a,s,l,u,c){var h=o?.6*s*l:0,p=Math.max(o?o.right-o.left:0,a?a.right-a.left:0),f=0===e[0].x||e[0].x===c||0===e[0].y||e[0].y===c;return n-p*l<n/4&&(n=p*l+n/4),function e(n,r,o,a,s,l,u,c,h){for(var p=l/2,f=0,d=0;d<n.length-1;d++)f+=n[d].dist(n[d+1]);for(var m=0,y=r-o,g=[],v=0;v<n.length-1;v++){for(var _=n[v],x=n[v+1],b=_.dist(x),w=x.angleTo(_);y+o<m+b;){var S=((y+=o)-m)/b,E=t.number(_.x,x.x,S),k=t.number(_.y,x.y,S);if(E>=0&&E<h&&k>=0&&k<h&&y-p>=0&&y+p<=f){var T=new t.default$25(E,k,w,v);T._round(),a&&!i(n,T,l,a,s)||g.push(T)}}m+=b}return c||g.length||u||(g=e(n,m/2,o,a,s,l,u,!0,h)),g}(e,f?n/2*u%n:(p/2+2*s)*l*u%n,n,h,r,p*l,f,!1,c)}function o(t,e){if(!(this instanceof o))return new o(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||a,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function a(t,e){return t<e?-1:t>e?1:0}function s(e,n,i){void 0===n&&(n=1),void 0===i&&(i=!1);for(var r=1/0,o=1/0,a=-1/0,s=-1/0,c=e[0],h=0;h<c.length;h++){var p=c[h];(!h||p.x<r)&&(r=p.x),(!h||p.y<o)&&(o=p.y),(!h||p.x>a)&&(a=p.x),(!h||p.y>s)&&(s=p.y)}var f=a-r,d=s-o,m=Math.min(f,d),y=m/2,g=new Et(null,l);if(0===m)return new t.default(r,o);for(var v=r;v<a;v+=m)for(var _=o;_<s;_+=m)g.push(new u(v+y,_+y,y,e));for(var x=function(t){for(var e=0,n=0,i=0,r=t[0],o=0,a=r.length,s=a-1;o<a;s=o++){var l=r[o],c=r[s],h=l.x*c.y-c.x*l.y;n+=(l.x+c.x)*h,i+=(l.y+c.y)*h,e+=3*h}return new u(n/e,i/e,0,t)}(e),b=g.length;g.length;){var w=g.pop();(w.d>x.d||!x.d)&&(x=w,i&&console.log("found best %d after %d probes",Math.round(1e4*w.d)/1e4,b)),w.max-x.d<=n||(y=w.h/2,g.push(new u(w.p.x-y,w.p.y-y,y,e)),g.push(new u(w.p.x+y,w.p.y-y,y,e)),g.push(new u(w.p.x-y,w.p.y+y,y,e)),g.push(new u(w.p.x+y,w.p.y+y,y,e)),b+=4)}return i&&(console.log("num probes: "+b),console.log("best distance: "+x.d)),x.p}function l(t,e){return e.max-t.max}function u(e,n,i,r){this.p=new t.default(e,n),this.h=i,this.d=function(e,n){for(var i=!1,r=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,l=a.length,u=l-1;s<l;u=s++){var c=a[s],h=a[u];c.y>e.y!=h.y>e.y&&e.x<(h.x-c.x)*(e.y-c.y)/(h.y-c.y)+c.x&&(i=!i),r=Math.min(r,t.distToSegmentSquared(e,c,h))}return(i?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}function c(e,n,i,r,o,a){e.createArrays(),e.symbolInstances=[];var s=512*e.overscaling;e.tilePixelRatio=t.default$10/s,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,u=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var p=e.textSizeData.zoomRange,f=p.min,d=p.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new t.default$23(f)),u["text-size"].possiblyEvaluate(new t.default$23(d))]}if("composite"===e.iconSizeData.functionType){var m=e.iconSizeData.zoomRange,y=m.min,g=m.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new t.default$23(y)),u["icon-size"].possiblyEvaluate(new t.default$23(g))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new t.default$23(e.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new t.default$23(e.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new t.default$23(18));for(var v=24*l.get("text-line-height"),_="map"===l.get("text-rotation-alignment")&&"line"===l.get("symbol-placement"),x=l.get("text-keep-upright"),b=0,w=e.features;b<w.length;b+=1){var S=w[b],E=l.get("text-font").evaluate(S,{}).join(","),k=n[E]||{},T=i[E]||{},A={},I=S.text;if(I){var z=l.get("text-offset").evaluate(S,{}).map(function(t){return 24*t}),C=24*l.get("text-letter-spacing").evaluate(S,{}),M=t.allowsLetterSpacing(I)?C:0,P=l.get("text-anchor").evaluate(S,{}),L=l.get("text-justify").evaluate(S,{}),D="line"!==l.get("symbol-placement")?24*l.get("text-max-width").evaluate(S,{}):0;A.horizontal=t.shapeText(I,k,D,v,P,L,M,z,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(I)&&_&&x&&(A.vertical=t.shapeText(I,k,D,v,P,L,M,z,24,t.WritingMode.vertical))}var R=void 0;if(S.icon){var B=r[S.icon];B&&(R=t.shapeIcon(o[S.icon],l.get("icon-offset").evaluate(S,{}),l.get("icon-anchor").evaluate(S,{})),void 0===e.sdfIcons?e.sdfIcons=B.sdf:e.sdfIcons!==B.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),B.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(A.horizontal||R)&&h(e,S,A,R,T,c)}a&&e.generateCollisionDebugBuffers()}function h(e,n,i,o,a,l){var u=l.layoutTextSize.evaluate(n,{}),c=l.layoutIconSize.evaluate(n,{}),h=l.textMaxSize.evaluate(n,{});void 0===h&&(h=u);var d=e.layers[0].layout,m=d.get("text-offset").evaluate(n,{}),y=d.get("icon-offset").evaluate(n,{}),g=u/24,v=e.tilePixelRatio*g,_=e.tilePixelRatio*h/24,x=e.tilePixelRatio*c,b=e.tilePixelRatio*d.get("symbol-spacing"),w=d.get("text-padding")*e.tilePixelRatio,S=d.get("icon-padding")*e.tilePixelRatio,E=d.get("text-max-angle")/180*Math.PI,k="map"===d.get("text-rotation-alignment")&&"line"===d.get("symbol-placement"),T="map"===d.get("icon-rotation-alignment")&&"line"===d.get("symbol-placement"),A=b/2,I=function(r,s){s.x<0||s.x>=t.default$10||s.y<0||s.y>=t.default$10||e.symbolInstances.push(function(e,n,i,r,o,a,s,l,u,c,h,f,d,m,y,g,v,_,x,b,w){var S,E,k=e.addToLineVertexArray(n,i),T=0,A=0,I=0,z=r.horizontal?r.horizontal.text:"",C=[];if(r.horizontal){var M=a.layout.get("text-rotate").evaluate(x,{});S=new St(s,i,n,l,u,c,r.horizontal,h,f,d,e.overscaling,M),A+=p(e,n,r.horizontal,a,d,x,m,k,r.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,C,b,w),r.vertical&&(I+=p(e,n,r.vertical,a,d,x,m,k,t.WritingMode.vertical,C,b,w))}var P=S?S.boxStartIndex:e.collisionBoxArray.length,L=S?S.boxEndIndex:e.collisionBoxArray.length;if(o){var D=function(e,n,i,r,o,a){var s,l,u,c,h=n.image,p=i.layout,f=n.top-1/h.pixelRatio,d=n.left-1/h.pixelRatio,m=n.bottom+1/h.pixelRatio,y=n.right+1/h.pixelRatio;if("none"!==p.get("icon-text-fit")&&o){var g=y-d,v=m-f,_=p.get("text-size").evaluate(a,{})/24,x=o.left*_,b=o.right*_,w=o.top*_,S=b-x,E=o.bottom*_-w,k=p.get("icon-text-fit-padding")[0],T=p.get("icon-text-fit-padding")[1],A=p.get("icon-text-fit-padding")[2],I=p.get("icon-text-fit-padding")[3],z="width"===p.get("icon-text-fit")?.5*(E-v):0,C="height"===p.get("icon-text-fit")?.5*(S-g):0,M="width"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?S:g,P="height"===p.get("icon-text-fit")||"both"===p.get("icon-text-fit")?E:v;s=new t.default(x+C-I,w+z-k),l=new t.default(x+C+T+M,w+z-k),u=new t.default(x+C+T+M,w+z+A+P),c=new t.default(x+C-I,w+z+A+P)}else s=new t.default(d,f),l=new t.default(y,f),u=new t.default(y,m),c=new t.default(d,m);var L=i.layout.get("icon-rotate").evaluate(a,{})*Math.PI/180;if(L){var D=Math.sin(L),R=Math.cos(L),B=[R,-D,D,R];s._matMult(B),l._matMult(B),c._matMult(B),u._matMult(B)}return[{tl:s,tr:l,bl:c,br:u,tex:h.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,o,a,0,r.horizontal,x),R=a.layout.get("icon-rotate").evaluate(x,{});E=new St(s,i,n,l,u,c,o,y,g,!1,e.overscaling,R),T=4*D.length;var B=e.iconSizeData,O=null;"source"===B.functionType?O=[10*a.layout.get("icon-size").evaluate(x,{})]:"composite"===B.functionType&&(O=[10*w.compositeIconSizes[0].evaluate(x,{}),10*w.compositeIconSizes[1].evaluate(x,{})]),e.addSymbols(e.icon,D,O,_,v,x,!1,n,k.lineStartIndex,k.lineLength)}var F=E?E.boxStartIndex:e.collisionBoxArray.length,V=E?E.boxEndIndex:e.collisionBoxArray.length;return e.glyphOffsetArray.length>=t.default$27.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),{key:z,textBoxStartIndex:P,textBoxEndIndex:L,iconBoxStartIndex:F,iconBoxEndIndex:V,textOffset:m,iconOffset:_,anchor:n,line:i,featureIndex:l,feature:x,numGlyphVertices:A,numVerticalGlyphVertices:I,numIconVertices:T,textOpacityState:new wt,iconOpacityState:new wt,isDuplicate:!1,placedTextSymbolIndices:C,crossTileID:0}}(e,s,r,i,o,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,v,w,k,m,x,S,T,y,n,a,l))};if("line"===d.get("symbol-placement"))for(var z=0,C=function(e,n,i,r,o){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var h=l[c],p=l[c+1];h.x<0&&p.x<0||(h.x<0?h=new t.default(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round():p.x<0&&(p=new t.default(0,h.y+(p.y-h.y)*((0-h.x)/(p.x-h.x)))._round()),h.y<0&&p.y<0||(h.y<0?h=new t.default(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round():p.y<0&&(p=new t.default(h.x+(p.x-h.x)*((0-h.y)/(p.y-h.y)),0)._round()),h.x>=r&&p.x>=r||(h.x>=r?h=new t.default(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round():p.x>=r&&(p=new t.default(r,h.y+(p.y-h.y)*((r-h.x)/(p.x-h.x)))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new t.default(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round():p.y>=o&&(p=new t.default(h.x+(p.x-h.x)*((o-h.y)/(p.y-h.y)),o)._round()),u&&h.equals(u[u.length-1])||(u=[h],a.push(u)),u.push(p)))))}return a}(n.geometry,0,0,t.default$10,t.default$10);z<C.length;z+=1)for(var M=C[z],P=0,L=r(M,b,E,i.vertical||i.horizontal,o,24,_,e.overscaling,t.default$10);P<L.length;P+=1){var D=L[P],R=i.horizontal;R&&f(e,R.text,A,D)||I(M,D)}else if("Polygon"===n.type)for(var B=0,O=t.default$26(n.geometry,0);B<O.length;B+=1){var F=O[B],V=s(F,16);I(F[0],new t.default$25(V.x,V.y,0))}else if("LineString"===n.type)for(var N=0,j=n.geometry;N<j.length;N+=1){var $=j[N];I($,new t.default$25($[0].x,$[0].y,0))}else if("Point"===n.type)for(var q=0,U=n.geometry;q<U.length;q+=1)for(var Z=0,G=U[q];Z<G.length;Z+=1){var W=G[Z];I([W],new t.default$25(W.x,W.y,0))}}function p(e,n,i,r,o,a,s,l,u,c,h,p){var f=function(e,n,i,r,o,a){for(var s=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,l=i.layout.get("text-offset").evaluate(o,{}).map(function(t){return 24*t}),u=n.positionedGlyphs,c=[],h=0;h<u.length;h++){var p=u[h],f=a[p.glyph];if(f){var d=f.rect;if(d){var m=t.GLYPH_PBF_BORDER+1,y=f.metrics.advance/2,g=r?[p.x+y,p.y]:[0,0],v=r?[0,0]:[p.x+y+l[0],p.y+l[1]],_=f.metrics.left-m-y+v[0],x=-f.metrics.top-m+v[1],b=_+d.w,w=x+d.h,S=new t.default(_,x),E=new t.default(b,x),k=new t.default(_,w),T=new t.default(b,w);if(r&&p.vertical){var A=new t.default(-y,y),I=-Math.PI/2,z=new t.default(5,0);S._rotateAround(I,A)._add(z),E._rotateAround(I,A)._add(z),k._rotateAround(I,A)._add(z),T._rotateAround(I,A)._add(z)}if(s){var C=Math.sin(s),M=Math.cos(s),P=[M,-C,C,M];S._matMult(P),E._matMult(P),k._matMult(P),T._matMult(P)}c.push({tl:S,tr:E,bl:k,br:T,tex:d,writingMode:n.writingMode,glyphOffset:g})}}}return c}(0,i,r,o,a,h),d=e.textSizeData,m=null;return"source"===d.functionType?m=[10*r.layout.get("text-size").evaluate(a,{})]:"composite"===d.functionType&&(m=[10*p.compositeTextSizes[0].evaluate(a,{}),10*p.compositeTextSizes[1].evaluate(a,{})]),e.addSymbols(e.text,f,m,s,o,a,u,n,l.lineStartIndex,l.lineLength),c.push(e.text.placedSymbolArray.length-1),4*f.length}function f(t,e,n,i){var r=t.compareText;if(e in r){for(var o=r[e],a=o.length-1;a>=0;a--)if(i.dist(o[a])<n)return!0}else r[e]=[];return r[e].push(i),!1}function d(e,n){for(var i=new t.default$23(n),r=0,o=e;r<o.length;r+=1)o[r].recalculate(i)}function m(e,n){var i=t.getArrayBuffer(e.request,function(e,i){e?n(e):i&&n(null,{vectorTile:new t.default$31.VectorTile(new t.default$32(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires})});return function(){i.abort(),n()}}function y(t){var e=0;if(t&&t.length>0){e+=Math.abs(g(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(g(t[n]))}return e}function g(t){var e,n,i,r,o,a,s=0,l=t.length;if(l>2){for(a=0;a<l;a++)a===l-2?(i=l-2,r=l-1,o=0):a===l-1?(i=l-1,r=0,o=1):(i=a,r=a+1,o=a+2),e=t[i],n=t[r],s+=(v(t[o][0])-v(e[0]))*Math.sin(v(n[1]));s=s*Lt.RADIUS*Lt.RADIUS/2}return s}function v(t){return t*Math.PI/180}function _(t,e){return function(n){return t(n,e)}}function x(t,e){e=!!e,t[0]=b(t[0],e);for(var n=1;n<t.length;n++)t[n]=b(t[n],!e);return t}function b(t,e){return function(t){return Dt.ring(t)>=0}(t)===e?t:t.reverse()}function w(t,e){this.options=e||{},this.features=t,this.length=t.length}function S(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}function E(e){var n=new t.__moduleExports$1;return function(t,e){for(var n in t.layers)e.writeMessage(3,k,t.layers[n])}(e,n),n.finish()}function k(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,T,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,M,o[n])}function T(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,A,t),e.writeVarintField(3,n.type),e.writeMessage(4,C,n)}function A(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var l=o[s];void 0===l&&(i.push(s),l=i.length-1,o[s]=l),e.writeVarint(l);var u=n.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=a[h];void 0===p&&(r.push(u),p=r.length-1,a[h]=p),e.writeVarint(p)}}function I(t,e){return(e<<3)+(7&t)}function z(t){return t<<1^t>>31}function C(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,a=n.length,s=0;s<a;s++){var l=n[s],u=1;1===i&&(u=l.length),e.writeVarint(I(1,u));for(var c=3===i?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==i&&e.writeVarint(I(2,c-1));var p=l[h].x-r,f=l[h].y-o;e.writeVarint(z(p)),e.writeVarint(z(f)),r+=p,o+=f}3===i&&e.writeVarint(I(7,0))}}function M(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function P(t,e,n,i){L(t,n,i),L(e,2*n,2*i),L(e,2*n+1,2*i+1)}function L(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function D(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}function R(t,e,n,i,r){e=e||B,n=n||O,r=r||Array,this.nodeSize=i||64,this.points=t,this.ids=new r(t.length),this.coords=new r(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=n(t[o]);Zt(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function B(t){return t[0]}function O(t){return t[1]}function F(t){this.options=Z(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function V(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:i,properties:r,parentId:-1,numPoints:n}}function N(t,e){var n=t.geometry.coordinates;return{x:q(n[0]),y:U(n[1]),zoom:1/0,id:e,parentId:-1}}function j(t){return{type:"Feature",properties:$(t),geometry:{type:"Point",coordinates:[360*(t.x-.5),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n}function $(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return Z(Z({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function q(t){return t/360+.5}function U(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Z(t,e){for(var n in e)t[n]=e[n];return t}function G(t){return t.x}function W(t){return t.y}function X(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return(a=t-n)*a+(s=e-i)*s}function H(t,e,n,i){var r={id:t||null,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)K(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)K(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)K(t,e[i][r])}(r),r}function K(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function J(t,e,n){if(e.geometry){var i=e.geometry.coordinates,r=e.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[];if("Point"===r)Y(i,a);else if("MultiPoint"===r)for(var s=0;s<i.length;s++)Y(i[s],a);else if("LineString"===r)Q(i,a,o,!1);else if("MultiLineString"===r){if(n.lineMetrics){for(s=0;s<i.length;s++)a=[],Q(i[s],a,o,!1),t.push(H(e.id,"LineString",a,e.properties));return}tt(i,a,o,!1)}else if("Polygon"===r)tt(i,a,o,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(s=0;s<e.geometry.geometries.length;s++)J(t,{id:e.id,geometry:e.geometry.geometries[s],properties:e.properties},n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(s=0;s<i.length;s++){var l=[];tt(i[s],l,o,!0),a.push(l)}}t.push(H(e.id,r,a,e.properties))}}function Y(t,e){e.push(et(t[0])),e.push(nt(t[1])),e.push(0)}function Q(t,e,n,i){for(var r,o,a=0,s=0;s<t.length;s++){var l=et(t[s][0]),u=nt(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=i?(r*u-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-o,2))),r=l,o=u}var c=e.length-3;e[2]=1,function t(e,n,i,r){for(var o,a=r,s=e[n],l=e[n+1],u=e[i],c=e[i+1],h=n+3;h<i;h+=3){var p=X(e[h],e[h+1],s,l,u,c);p>a&&(o=h,a=p)}a>r&&(o-n>3&&t(e,n,o,r),e[o+2]=a,i-o>3&&t(e,o,i,r))}(e,0,c,n),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function tt(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];Q(t[r],o,n,i),e.push(o)}}function et(t){return t/360+.5}function nt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function it(t,e,n,i,r,o,a,s){if(i/=e,o>=(n/=e)&&a<i)return t;if(a<n||o>=i)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,f=0===r?c.minX:c.minY,d=0===r?c.maxX:c.maxY;if(f>=n&&d<i)l.push(c);else if(!(d<n||f>=i)){var m=[];if("Point"===p||"MultiPoint"===p)rt(h,m,n,i,r);else if("LineString"===p)ot(h,m,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===p)st(h,m,n,i,r,!1);else if("Polygon"===p)st(h,m,n,i,r,!0);else if("MultiPolygon"===p)for(var y=0;y<h.length;y++){var g=[];st(h[y],g,n,i,r,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(y=0;y<m.length;y++)l.push(H(c.id,p,m[y],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(H(c.id,p,m,c.tags))}}}return l.length?l:null}function rt(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=n&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function ot(t,e,n,i,r,o,a){for(var s,l,u=at(t),c=0===r?ut:ct,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],m=t[p+2],y=t[p+3],g=t[p+4],v=0===r?f:d,_=0===r?y:g,x=!1;a&&(s=Math.sqrt(Math.pow(f-y,2)+Math.pow(d-g,2))),v<n?_>=n&&(l=c(u,f,d,y,g,n),a&&(u.start=h+s*l)):v>=i?_<i&&(l=c(u,f,d,y,g,i),a&&(u.start=h+s*l)):lt(u,f,d,m),_<n&&v>=n&&(l=c(u,f,d,y,g,n),x=!0),_>i&&v<=i&&(l=c(u,f,d,y,g,i),x=!0),!o&&x&&(a&&(u.end=h+s*l),e.push(u),u=at(t)),a&&(h+=s)}var b=t.length-3;f=t[b],d=t[b+1],m=t[b+2],(v=0===r?f:d)>=n&&v<=i&&lt(u,f,d,m),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&lt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function st(t,e,n,i,r,o){for(var a=0;a<t.length;a++)ot(t[a],e,n,i,r,o,!1)}function lt(t,e,n,i){t.push(e),t.push(n),t.push(i)}function ut(t,e,n,i,r,o){var a=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*a),t.push(1),a}function ct(t,e,n,i,r,o){var a=(o-n)/(r-n);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function ht(t,e){for(var n=[],i=0;i<t.length;i++){var r,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)r=pt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){r=[];for(var s=0;s<o.geometry.length;s++)r.push(pt(o.geometry[s],e))}else if("MultiPolygon"===a)for(r=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(pt(o.geometry[s][u],e));r.push(l)}n.push(H(o.id,a,r,o.tags))}return n}function pt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function ft(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(dt(u[i],u[i+1],e,o,a,s));else for(i=0;i<u.length;i++){var h=[];for(r=0;r<u[i].length;r+=2)h.push(dt(u[i][r],u[i][r+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function dt(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function mt(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,yt(a,t[s],o,r);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function yt(t,e,n,i){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)gt(a,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)gt(a,r[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)gt(a,u[s],t,n,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function gt(t,e,n,i,r,o){var a=i*i;if(i>0&&e.size<(r?a:i))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=a,t[r-1-i]=s}}(s,o),t.push(s)}}function vt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)J(n,t.features[i],e);else"Feature"===t.type?J(n,t,e):J(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=it(t,1,-1-n,n,0,-1,2,e),o=it(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=it(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=ht(r,1).concat(i)),o&&(i=i.concat(ht(o,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _t(t,e,n){return 32*((1<<t)*n+e)+t}function xt(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);var r=new Ft(i.features),o=jt(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}var bt=function(t){t&&this.replace(t)};bt.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},bt.prototype.update=function(e,i){for(var r=this,o=0,a=e;o<a.length;o+=1){var s=a[o];r._layerConfigs[s.id]=s;var l=r._layers[s.id]=t.default$20(s);l._featureFilter=t.default$24(l.filter)}for(var u=0,c=i;u<c.length;u+=1){var h=c[u];delete r._layerConfigs[h],delete r._layers[h]}this.familiesBySource={};for(var p=0,f=function(t){for(var e={},i=0;i<t.length;i++){var r=n(t[i]),o=e[r];o||(o=e[r]=[]),o.push(t[i])}var a=[];for(var s in e)a.push(e[s]);return a}(t.values(this._layerConfigs));p<f.length;p+=1){var d=f[p].map(function(t){return r._layers[t.id]}),m=d[0];if("none"!==m.visibility){var y=m.source||"",g=r.familiesBySource[y];g||(g=r.familiesBySource[y]={});var v=m.sourceLayer||"_geojsonTileLayer",_=g[v];_||(_=g[v]=[]),_.push(d)}}};var wt=function(){this.opacity=0,this.targetOpacity=0,this.time=0};wt.prototype.clone=function(){var t=new wt;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},t.register("OpacityState",wt);var St=function(e,n,i,r,o,a,s,l,u,c,h,p){var f=s.top*l-u,d=s.bottom*l+u,m=s.left*l-u,y=s.right*l+u;if(this.boxStartIndex=e.length,c){var g=d-f,v=y-m;g>0&&(g=Math.max(10*l,g),this._addLineCollisionCircles(e,n,i,i.segment,v,g,r,o,a,h))}else{if(p){var _=new t.default(m,f),x=new t.default(y,f),b=new t.default(m,d),w=new t.default(y,d),S=p*Math.PI/180;_._rotate(S),x._rotate(S),b._rotate(S),w._rotate(S),m=Math.min(_.x,x.x,b.x,w.x),y=Math.max(_.x,x.x,b.x,w.x),f=Math.min(_.y,x.y,b.y,w.y),d=Math.max(_.y,x.y,b.y,w.y)}e.emplaceBack(i.x,i.y,m,f,y,d,r,o,a,0,0)}this.boxEndIndex=e.length};St.prototype._addLineCollisionCircles=function(t,e,n,i,r,o,a,s,l,u){var c=o/2,h=Math.floor(r/c),p=1+.4*Math.log(u)/Math.LN2,f=Math.floor(h*p/2),d=-o/2,m=n,y=i+1,g=d,v=-r/2,_=v-r/4;do{if(--y<0){if(g>v)return;y=0;break}g-=e[y].dist(m),m=e[y]}while(g>_);for(var x=e[y].dist(e[y+1]),b=-f;b<h+f;b++){var w=b*c,S=v+w;if(w<0&&(S+=w),w>r&&(S+=w-r),!(S<g)){for(;g+x<S;){if(g+=x,++y+1>=e.length)return;x=e[y].dist(e[y+1])}var E=S-g,k=e[y],T=e[y+1].sub(k)._unit()._mult(E)._add(k)._round(),A=Math.abs(S-d)<c?0:.8*(S-d);t.emplaceBack(T.x,T.y,-o/2,-o/2,o/2,o/2,a,s,l,o/2,A)}}};var Et=o,kt=o;o.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,r)>=0)break;e[t]=s,t=o}e[t]=r}},Et.default=kt;var Tt=function(e){var n=new t.AlphaImage({width:0,height:0}),i={},r=new t.default$3(0,0,{autoResize:!0});for(var o in e){var a=e[o],s=i[o]={};for(var l in a){var u=a[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c=r.packOne(u.bitmap.width+2,u.bitmap.height+2);n.resize({width:r.w,height:r.h}),t.AlphaImage.copy(u.bitmap,n,{x:0,y:0},{x:c.x+1,y:c.y+1},u.bitmap),s[l]={rect:c,metrics:u.metrics}}}}r.shrink(),n.resize({width:r.w,height:r.h}),this.image=n,this.positions=i};t.register("GlyphAtlas",Tt);var At=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};At.prototype.parse=function(e,n,i,r){function o(){if(u)return r(u);if(h&&p){var e=new Tt(h),n=new t.default$30(p);for(var i in f){var o=f[i];o instanceof t.default$27&&(d(o.layers,this.zoom),c(o,h,e.positions,p,n.positions,this.showCollisionBoxes))}this.status="done",r(null,{buckets:t.values(f).filter(function(t){return!t.isEmpty()}),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,iconAtlasImage:n.image})}}var a=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var s=new t.default$29(Object.keys(e.layers).sort()),l=new t.default$28(this.tileID);l.bucketLayerIDs=[];var u,h,p,f={},m={featureIndex:l,iconDependencies:{},glyphDependencies:{}},y=n.familiesBySource[this.source];for(var g in y){var v=e.layers[g];if(v){1===v.version&&t.warnOnce('Vector tile source "'+a.source+'" layer "'+g+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var _=s.encode(g),x=[],b=0;b<v.length;b++){var w=v.feature(b);x.push({feature:w,index:b,sourceLayerIndex:_})}for(var S=0,E=y[g];S<E.length;S+=1){var k=E[S],T=k[0];T.minzoom&&a.zoom<Math.floor(T.minzoom)||T.maxzoom&&a.zoom>=T.maxzoom||"none"!==T.visibility&&(d(k,a.zoom),(f[T.id]=T.createBucket({index:l.bucketLayerIDs.length,layers:k,zoom:a.zoom,pixelRatio:a.pixelRatio,overscaling:a.overscaling,
collisionBoxArray:a.collisionBoxArray,sourceLayerIndex:_,sourceID:a.source})).populate(x,m),l.bucketLayerIDs.push(k.map(function(t){return t.id})))}}}var A=t.mapObject(m.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(A).length?i.send("getGlyphs",{uid:this.uid,stacks:A},function(t,e){u||(u=t,h=e,o.call(a))}):h={};var I=Object.keys(m.iconDependencies);I.length?i.send("getImages",{icons:I},function(t,e){u||(u=t,p=e,o.call(a))}):p={},o.call(this)};var It="undefined"!=typeof performance,zt={getEntriesByName:function(t){return!!(It&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(It&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,n){return!!(It&&performance&&performance.measure)&&performance.measure(t,e,n)},clearMarks:function(t){return!!(It&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(It&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},Ct=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},zt.mark(this._marks.start)};Ct.prototype.finish=function(){zt.mark(this._marks.end);var t=zt.getEntriesByName(this._marks.measure);return 0===t.length&&(zt.measure(this._marks.measure,this._marks.start,this._marks.end),t=zt.getEntriesByName(this._marks.measure),zt.clearMarks(this._marks.start),zt.clearMarks(this._marks.end),zt.clearMeasures(this._marks.measure)),t},zt.Performance=Ct;var Mt=function(t,e,n){this.actor=t,this.layerIndex=e,this.loadVectorData=n||m,this.loading={},this.loaded={}};Mt.prototype.loadTile=function(e,n){var i=this,r=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new zt.Performance(e.request),a=this.loading[r]=new At(e);a.abort=this.loadVectorData(e,function(e,s){if(delete i.loading[r],e||!s)return n(e);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(o){var h=o.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,i.layerIndex,i.actor,function(e,i){if(e||!i)return n(e);n(null,t.extend({rawTileData:l.slice(0)},i,u,c))}),i.loaded=i.loaded||{},i.loaded[r]=a})},Mt.prototype.reloadTile=function(t,e){var n=this.loaded,i=t.uid,r=this;if(n&&n[i]){var o=n[i];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,n){var i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,r.layerIndex,r.actor,i)),e(t,n)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&o.parse(o.vectorTile,this.layerIndex,this.actor,a)}},Mt.prototype.abortTile=function(t,e){var n=this.loading,i=t.uid;n&&n[i]&&n[i].abort&&(n[i].abort(),delete n[i]),e()},Mt.prototype.removeTile=function(t,e){var n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()};var Pt=function(){this.loading={},this.loaded={}};Pt.prototype.loadTile=function(e,n){var i=e.uid,r=e.encoding,o=new t.default$33(i);this.loading[i]=o,o.loadFromImage(e.rawImageData,r),delete this.loading[i],this.loaded=this.loaded||{},this.loaded[i]=o,n(null,o)},Pt.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var Lt={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},Dt={geometry:function t(e){var n,i=0;switch(e.type){case"Polygon":return y(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=y(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},ring:g},Rt=function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(_(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=x(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(_(x,e))),t}(e,n);default:return e}},Bt=t.default$31.VectorTileFeature.prototype.toGeoJSON,Ot=function(e){this._feature=e,this.extent=t.default$10,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};Ot.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,i=this._feature.geometry;n<i.length;n+=1){var r=i[n];e.push([new t.default(r[0],r[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],u=0,c=s[a];u<c.length;u+=1){var h=c[u];l.push(new t.default(h[0],h[1]))}o.push(l)}return o},Ot.prototype.toGeoJSON=function(t,e,n){return Bt.call(this,t,e,n)};var Ft=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.default$10,this.length=e.length,this._features=e};Ft.prototype.feature=function(t){return new Ot(this._features[t])};var Vt=t.__moduleExports.VectorTileFeature,Nt=w;w.prototype.feature=function(t){return new S(this.features[t],this.options.extent)},S.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++)r.push(new t.default$34(i[o][0],i[o][1]));this.geometry.push(r)}return this.geometry},S.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},S.prototype.toGeoJSON=Vt.prototype.toGeoJSON;var jt=E,$t=E,qt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new Nt(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return E({layers:n})},Ut=Nt;jt.fromVectorTileJs=$t,jt.fromGeojsonVt=qt,jt.GeoJSONWrapper=Ut;var Zt=function t(e,n,i,r,o,a){if(!(o-r<=i)){var s=Math.floor((r+o)/2);!function t(e,n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);t(e,n,i,Math.max(r,Math.floor(i-l*c/s+h)),Math.min(o,Math.floor(i+(s-l)*c/s+h)),a)}var p=n[2*i+a],f=r,d=o;for(P(e,n,r,i),n[2*o+a]>p&&P(e,n,r,o);f<d;){for(P(e,n,f,d),f++,d--;n[2*f+a]<p;)f++;for(;n[2*d+a]>p;)d--}n[2*r+a]===p?P(e,n,r,d):P(e,n,++d,o),d<=i&&(r=d+1),i<=d&&(o=d-1)}}(e,n,s,r,o,a%2),t(e,n,i,r,s-1,a+1),t(e,n,i,s+1,o,a+1)}},Gt=function(t,e,n,i,r,o,a){for(var s,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),f=u.pop();if(p-f<=a)for(var d=f;d<=p;d++)s=e[2*d],l=e[2*d+1],s>=n&&s<=r&&l>=i&&l<=o&&c.push(t[d]);else{var m=Math.floor((f+p)/2);s=e[2*m],l=e[2*m+1],s>=n&&s<=r&&l>=i&&l<=o&&c.push(t[m]);var y=(h+1)%2;(0===h?n<=s:i<=l)&&(u.push(f),u.push(m-1),u.push(y)),(0===h?r>=s:o>=l)&&(u.push(m+1),u.push(p),u.push(y))}}return c},Wt=function(t,e,n,i,r,o){for(var a=[0,t.length-1,0],s=[],l=r*r;a.length;){var u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var p=h;p<=c;p++)D(e[2*p],e[2*p+1],n,i)<=l&&s.push(t[p]);else{var f=Math.floor((h+c)/2),d=e[2*f],m=e[2*f+1];D(d,m,n,i)<=l&&s.push(t[f]);var y=(u+1)%2;(0===u?n-r<=d:i-r<=m)&&(a.push(h),a.push(f-1),a.push(y)),(0===u?n+r>=d:i+r>=m)&&(a.push(f+1),a.push(c),a.push(y))}}return s},Xt=function(t,e,n,i,r){return new R(t,e,n,i,r)};R.prototype={range:function(t,e,n,i){return Gt(this.ids,this.coords,t,e,n,i,this.nodeSize)},within:function(t,e,n){return Wt(this.ids,this.coords,t,e,n,this.nodeSize)}};var Ht=function(t){return new F(t)};F.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;var i=t.map(N);e&&console.timeEnd(n);for(var r=this.options.maxZoom;r>=this.options.minZoom;r--){var o=+Date.now();this.trees[r+1]=Xt(i,G,W,this.options.nodeSize,Float32Array),i=this._cluster(i,r),e&&console.log("z%d: %d clusters in %dms",r,i.length,+Date.now()-o)}return this.trees[this.options.minZoom]=Xt(i,G,W,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var n=this.trees[this._limitZoom(e)],i=n.range(q(t[0]),U(t[3]),q(t[2]),U(t[1])),r=[],o=0;o<i.length;o++){var a=n.points[i[o]];r.push(a.numPoints?j(a):this.points[a.id])}return r},getChildren:function(t,e){for(var n=this.trees[e+1].points[t],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=this.trees[e+1].within(n.x,n.y,i),o=[],a=0;a<r.length;a++){var s=this.trees[e+1].points[r[a]];s.parentId===t&&o.push(s.numPoints?j(s):this.points[s.id])}return o},getLeaves:function(t,e,n,i){n=n||10,i=i||0;var r=[];return this._appendLeaves(r,t,e,n,i,0),r},getTile:function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/r,l=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((e-a)/r,s,(e+1+a)/r,l),i.points,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-a/r,s,1,l),i.points,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,s,a/r,l),i.points,-1,n,r,u),u.features.length?u:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var n=this.getChildren(t,e);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,i,r,o){for(var a=this.getChildren(e,n),s=0;s<a.length;s++){var l=a[s].properties;if(l.cluster?o+l.point_count<=r?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,n+1,i,r,o):o<r?o++:t.push(a[s]),t.length===i)break}return o},_addTileFeatures:function(t,e,n,i,r,o){for(var a=0;a<t.length;a++){var s=e[t[a]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*r-n)),Math.round(this.options.extent*(s.y*r-i))]],tags:s.numPoints?$(s):this.points[s.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],i=this.options.radius/(this.options.extent*Math.pow(2,e)),r=0;r<t.length;r++){var o=t[r];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,i),l=o.numPoints||1,u=o.x*l,c=o.y*l,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var p=0;p<s.length;p++){var f=a.points[s[p]];if(e<f.zoom){var d=f.numPoints||1;f.zoom=e,u+=f.x*d,c+=f.y*d,l+=d,f.parentId=r,this.options.reduce&&this._accumulate(h,f)}}1===l?n.push(o):(o.parentId=r,n.push(V(u/l,c/l,l,r,h)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}},vt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,debug:0},vt.prototype.splitTile=function(t,e,n,i,r,o,a){for(var s=[t,e,n,i],l=this.options,u=l.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=_t(e,n,i),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=mt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var d=1<<r-e;if(n!==Math.floor(o/d)||i!==Math.floor(a/d))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,y,g,v,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,E=1+b;m=y=g=v=null,_=it(t,c,n-b,n+S,0,p.minX,p.maxX,l),x=it(t,c,n+w,n+E,0,p.minX,p.maxX,l),t=null,_&&(m=it(_,c,i-b,i+S,1,p.minY,p.maxY,l),y=it(_,c,i+w,i+E,1,p.minY,p.maxY,l),_=null),x&&(g=it(x,c,i-b,i+S,1,p.minY,p.maxY,l),v=it(x,c,i+w,i+E,1,p.minY,p.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*i),s.push(y||[],e+1,2*n,2*i+1),s.push(g||[],e+1,2*n+1,2*i),s.push(v||[],e+1,2*n+1,2*i+1)}}},vt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var a=1<<t,s=_t(t,e=(e%a+a)%a,n);if(this.tiles[s])return ft(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,c=e,h=n;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[_t(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?ft(this.tiles[s],r):null):null};var Kt=function(e){function n(t,n,i){e.call(this,t,n,xt),i&&(this.loadGeoJSON=i)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(n&&n.request&&n.request.collectResourceTiming)&&new zt.Performance(n.request);this.loadGeoJSON(n,function(r,o){if(r||!o)return e(r);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));Rt(o,!0);try{t._geoJSONIndex=n.cluster?Ht(n.superclusterOptions).load(o.features):function(t,e){return new vt(t,e)}(o,n.geojsonVtOptions)}catch(r){return e(r)}t.loaded={};var a={};if(i){var s=i.finish();s&&(a.resourceTiming={},a.resourceTiming[n.source]=JSON.parse(JSON.stringify(s)))}e(null,a)})}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var i=this.loaded,r=t.uid;return i&&i[r]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n}(Mt),Jt=function(e){var n=this;this.self=e,this.actor=new t.default$9(e,this),this.layerIndexes={},this.workerSourceTypes={vector:Mt,geojson:Kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText}};return Jt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},Jt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},Jt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},Jt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},Jt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},Jt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},Jt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},Jt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Jt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}},Jt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},Jt.prototype.loadRTLTextPlugin=function(e,n,i){try{t.plugin.isLoaded()||(this.self.importScripts(n),i(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+n)))}catch(t){i(t.toString())}},Jt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new bt),e},Jt.prototype.getWorkerSource=function(t,e,n){var i=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var r={send:function(e,n,r){i.actor.send(e,n,r,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](r,this.getLayerIndex(t))}return this.workerSources[t][e][n]},Jt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new Pt),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Jt(self),Jt}),t(["./chunk1.js"],function(t){function e(t){if(!mt)return null;for(var e=0;e<t.length;e++)if(t[e]in mt)return t[e];return t[0]}function n(t,e){var n=r(bt.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"/"!==n.path&&(t.path=""+n.path+t.path),!bt.REQUIRE_ACCESS_TOKEN)return o(t);if(!(e=e||bt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+wt);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+wt);return t.params.push("access_token="+e),o(t)}function i(t){return 0===t.indexOf("mapbox:")}function r(t){var e=t.match(It);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function o(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function a(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function s(t,e,n,i,r,o,a){for(var s=0;s<e;s++){for(var u=0;u<n;u++)i[u]=t[u*e+s];for(l(i,r,o,a,n),u=0;u<n;u++)t[u*e+s]=r[u]}for(u=0;u<n;u++){for(s=0;s<e;s++)i[s]=t[u*e+s];for(l(i,r,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(r[s])}}function l(t,e,n,i,r){n[0]=0,i[0]=-Mt,i[1]=+Mt;for(var o=1,a=0;o<r;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+Mt}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}function u(e,n,i){var r=function(e,n){if(e)return i(e);if(n){var r=t.pick(n,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);n.vector_layers&&(r.vectorLayers=n.vector_layers,r.vectorLayerIds=r.vectorLayers.map(function(t){return t.id})),i(null,r)}};e.url?t.getJSON(n(Et(e.url),t.ResourceType.Source),r):t.default$2.frame(function(){return r(null,e)})}function c(t,e,n,i,r){var o=r.maxPitchScaleFactor(),a=t.tilesIn(n,o);a.sort(h);for(var s=[],l=0,u=a;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(e,t._state,c.queryGeometry,c.scale,i,r,o,t.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}var p=function(t){for(var e={},n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.queryResults,s=o.wrappedTileID,l=n[s]=n[s]||{};for(var u in a)for(var c=a[u],h=l[u]=l[u]||{},p=e[u]=e[u]||[],f=0,d=c;f<d.length;f+=1){var m=d[f];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m.feature))}}return e}(s);for(var f in p)p[f].forEach(function(e){var n=t.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=n});return p}function h(t,e){var n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function p(e,n){var i=n.zoomTo(e.canonical.z);return new t.default((i.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.default$10,(i.row-e.canonical.y)*t.default$10)}function f(t){return"raster"===t||"image"===t||"video"===t}function d(){return new t.default$1.Worker(hi.workerUrl)}function m(e,n){var i={};for(var r in e)"ref"!==r&&(i[r]=e[r]);return t.default$17.forEach(function(t){t in n&&(i[t]=n[t])}),i}function y(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=m(t[i],e[t[i].ref]));return t}function g(t,e,n){n.push({command:Fe.addSource,args:[t,e[t]]})}function v(t,e,n){e.push({command:Fe.removeSource,args:[t]}),n[t]=!0}function _(t,e,n,i){v(t,n,i),g(t,e,n)}function x(e,n,i){var r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t.default$13(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t.default$13(e[i][r],n[i][r]))return!1;return!0}function b(e,n,i,r,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.default$13(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.default$13(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}))}function w(t){return t.id}function S(t,e){return t[e.id]=e,t}function E(e,n){if(!e)return[{command:Fe.setStyle,args:[n]}];var i=[];try{if(!t.default$13(e.version,n.version))return[{command:Fe.setStyle,args:[n]}];t.default$13(e.center,n.center)||i.push({command:Fe.setCenter,args:[n.center]}),t.default$13(e.zoom,n.zoom)||i.push({command:Fe.setZoom,args:[n.zoom]}),t.default$13(e.bearing,n.bearing)||i.push({command:Fe.setBearing,args:[n.bearing]}),t.default$13(e.pitch,n.pitch)||i.push({command:Fe.setPitch,args:[n.pitch]}),t.default$13(e.sprite,n.sprite)||i.push({command:Fe.setSprite,args:[n.sprite]}),t.default$13(e.glyphs,n.glyphs)||i.push({command:Fe.setGlyphs,args:[n.glyphs]}),t.default$13(e.transition,n.transition)||i.push({command:Fe.setTransition,args:[n.transition]}),t.default$13(e.light,n.light)||i.push({command:Fe.setLight,args:[n.light]});var r={},o=[];!function(e,n,i,r){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||v(o,i,r));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.default$13(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&x(e,n,o)?i.push({command:Fe.setGeoJSONSourceData,args:[o,n[o].data]}):_(o,n,i,r)):g(o,n,i))}(e.sources,n.sources,o,r);var a=[];e.layers&&e.layers.forEach(function(t){r[t.source]?i.push({command:Fe.removeLayer,args:[t.id]}):a.push(t)}),i=i.concat(o),function(e,n,i){n=n||[];var r,o,a,s,l,u,c,h=(e=e||[]).map(w),p=n.map(w),f=e.reduce(S,{}),d=n.reduce(S,{}),m=h.slice(),y=Object.create(null);for(r=0,o=0;r<h.length;r++)a=h[r],d.hasOwnProperty(a)?o++:(i.push({command:Fe.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(r=0,o=0;r<p.length;r++)a=p[p.length-1-r],m[m.length-1-r]!==a&&(f.hasOwnProperty(a)?(i.push({command:Fe.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,u=m[m.length-r],i.push({command:Fe.addLayer,args:[d[a],u]}),m.splice(m.length-r,0,a),y[a]=!0);for(r=0;r<p.length;r++)if(s=f[a=p[r]],l=d[a],!y[a]&&!t.default$13(s,l))if(t.default$13(s.source,l.source)&&t.default$13(s["source-layer"],l["source-layer"])&&t.default$13(s.type,l.type)){for(c in b(s.layout,l.layout,i,a,null,Fe.setLayoutProperty),b(s.paint,l.paint,i,a,null,Fe.setPaintProperty),t.default$13(s.filter,l.filter)||i.push({command:Fe.setFilter,args:[a,l.filter]}),t.default$13(s.minzoom,l.minzoom)&&t.default$13(s.maxzoom,l.maxzoom)||i.push({command:Fe.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?b(s[c],l[c],i,a,c.slice(6),Fe.setPaintProperty):t.default$13(s[c],l[c])||i.push({command:Fe.setLayerProperty,args:[a,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?b(s[c],l[c],i,a,c.slice(6),Fe.setPaintProperty):t.default$13(s[c],l[c])||i.push({command:Fe.setLayerProperty,args:[a,c,l[c]]}))}else i.push({command:Fe.removeLayer,args:[a]}),u=m[m.lastIndexOf(a)+1],i.push({command:Fe.addLayer,args:[l,u]})}(a,n.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Fe.setStyle,args:[n]}]}return i}function k(e,n,i,r,o){var a=t.identity(new Float32Array(16));return n?(t.identity(a),t.scale(a,a,[1/o,1/o,1]),i||t.rotateZ(a,a,r.angle)):(t.scale(a,a,[r.width/2,-r.height/2,1]),t.translate(a,a,[1,-1,0]),t.multiply(a,a,e)),a}function T(e,n,i,r,o){var a=t.identity(new Float32Array(16));return n?(t.multiply(a,a,e),t.scale(a,a,[o,o,1]),i||t.rotateZ(a,a,-r.angle)):(t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/r.width,2/r.height,1])),a}function A(e,n){var i=[e.x,e.y,0,1];B(i,i,n);var r=i[3];return{point:new t.default(i[0]/r,i[1]/r),signedDistanceFromCamera:r}}function I(t,e){var n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function z(e,n,i,r,o,a,s,l){var u=r?e.textSizeData:e.iconSizeData,c=t.evaluateSizeForZoom(u,i.transform.zoom,Ne.properties[r?"text-size":"icon-size"]),h=[256/i.width*2+1,256/i.height*2+1],p=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var f=e.lineVertexArray,d=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=i.transform.width/i.transform.height,y=!1,g=0;g<d.length;g++){var v=d.get(g);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!y)R(v.numGlyphs,p);else{y=!1;var _=[v.anchorX,v.anchorY,0,1];if(t.transformMat4(_,_,n),I(_,h)){var x=.5+_[3]/i.transform.cameraToCenterDistance*.5,b=t.evaluateSizeForFeature(u,c,v),w=s?b*x:b/x,S=new t.default(v.anchorX,v.anchorY),E=A(S,o).point,k={},T=P(v,w,!1,l,n,o,a,e.glyphOffsetArray,f,p,E,S,k,m);y=T.useVertical,(T.notEnoughRoom||y||T.needsFlipping&&P(v,w,!0,l,n,o,a,e.glyphOffsetArray,f,p,E,S,k,m).notEnoughRoom)&&R(v.numGlyphs,p)}else R(v.numGlyphs,p)}}r?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function C(t,e,n,i,r,o,a,s,l,u,c,h){var p=s.glyphStartIndex+s.numGlyphs,f=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,m=e.getoffsetX(s.glyphStartIndex),y=e.getoffsetX(p-1),g=D(t*m,n,i,r,o,a,s.segment,f,d,l,u,c,h);if(!g)return null;var v=D(t*y,n,i,r,o,a,s.segment,f,d,l,u,c,h);return v?{first:g,last:v}:null}function M(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function P(e,n,i,r,o,a,s,l,u,c,h,p,f,d){var m,y=n/24,g=e.lineOffsetX*n,v=e.lineOffsetY*n;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,x=e.lineStartIndex,b=e.lineStartIndex+e.lineLength,w=C(y,l,g,v,i,h,p,e,u,a,f,!1);if(!w)return{notEnoughRoom:!0};var S=A(w.first.point,s).point,E=A(w.last.point,s).point;if(r&&!i){var k=M(e.writingMode,S,E,d);if(k)return k}m=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)m.push(D(y*l.getoffsetX(T),g,v,i,h,p,e.segment,x,b,u,a,f,!1));m.push(w.last)}else{if(r&&!i){var I=A(p,o).point,z=e.lineStartIndex+e.segment+1,P=new t.default(u.getx(z),u.gety(z)),R=A(P,o),B=R.signedDistanceFromCamera>0?R.point:L(p,P,I,1,o),O=M(e.writingMode,I,B,d);if(O)return O}var F=D(y*l.getoffsetX(e.glyphStartIndex),g,v,i,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,f,!1);if(!F)return{notEnoughRoom:!0};m=[F]}for(var V=0,N=m;V<N.length;V+=1){var j=N[V];t.addDynamicAttributes(c,j.point,j.angle)}return{}}function L(t,e,n,i,r){var o=A(t.add(t.sub(e)._unit()),r).point,a=n.sub(o);return n.add(a._mult(i/a.mag()))}function D(e,n,i,r,o,a,s,l,u,c,h,p,f){var d=r?e-n:e+n,m=d>0?1:-1,y=0;r&&(m*=-1,y=Math.PI),m<0&&(y+=Math.PI);for(var g=m>0?l+s:l+s+1,v=g,_=o,x=o,b=0,w=0,S=Math.abs(d);b+w<=S;){if((g+=m)<l||g>=u)return null;if(x=_,void 0===(_=p[g])){var E=new t.default(c.getx(g),c.gety(g)),k=A(E,h);if(k.signedDistanceFromCamera>0)_=p[g]=k.point;else{var T=g-m;_=L(0===b?a:new t.default(c.getx(T),c.gety(T)),E,x,S-b+1,h)}}b+=w,w=x.dist(_)}var I=(S-b)/w,z=_.sub(x),C=z.mult(I)._add(x);return C._add(z._unit()._perp()._mult(i*m)),{point:C,angle:y+Math.atan2(_.y-x.y,_.x-x.x),tileDistance:f?{prevTileDistance:g-m===v?0:c.gettileUnitDistanceFromAnchor(g-m),lastSegmentViewportDistance:S-b}:null}}function R(t,e){for(var n=0;n<t;n++){var i=e.length;e.resize(i+4),e.float32.set(je,3*i)}}function B(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}function O(t,e,n){t[e+4]=n?1:0}function F(e,n,i){return n*(t.default$10/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}function V(t,e,n){t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0)}function N(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*He+e*Ke+n*Je+e*Ye+n*Qe+e*tn+n*en+e}function j(e,n,i,r,o){for(var a=0;a<i.length;a++){var s=i[a];if(r.isLessThan(s.tileID))break;if(n.key===s.tileID.key)return;if(s.tileID.isChildOf(n)){for(var l=n.children(1/0),u=0;u<l.length;u++)j(e,l[u],i.slice(a),r,o);return}}var c=n.overscaledZ-e.overscaledZ,h=new t.CanonicalTileID(c,n.canonical.x-(e.canonical.x<<c),n.canonical.y-(e.canonical.y<<c));o[h.key]=o[h.key]||h}function $(t,e,n,i,r){var o=t.context,a=o.gl,s=r?t.useProgram("collisionCircle"):t.useProgram("collisionBox");o.setDepthMode(Me.disabled),o.setStencilMode(Pe.disabled),o.setColorMode(t.colorModeForRenderPass());for(var l=0;l<i.length;l++){var u=i[l],c=e.getTile(u),h=c.getBucket(n);if(h){var p=r?h.collisionCircle:h.collisionBox;if(p){a.uniformMatrix4fv(s.uniforms.u_matrix,!1,u.posMatrix),a.uniform1f(s.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance);var f=F(c,1,t.transform.zoom),d=Math.pow(2,t.transform.zoom-c.tileID.overscaledZ);a.uniform1f(s.uniforms.u_pixels_to_tile_units,f),a.uniform2f(s.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits[0]/(f*d),t.transform.pixelsToGLUnits[1]/(f*d)),a.uniform1f(s.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),s.draw(o,r?a.TRIANGLES:a.LINES,n.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,null,p.collisionVertexBuffer,null)}}}}function q(t,e,n,i,r,o,a,s,l,u){var c,h=t.context,p=h.gl,f=t.transform,d="map"===s,m="map"===l,y=d&&"line"===n.layout.get("symbol-placement"),g=d&&!m&&!y,v=m;h.setDepthMode(v?t.depthModeForSublayer(0,Me.ReadOnly):Me.disabled);for(var _=0,x=i;_<x.length;_+=1){var b=x[_],w=e.getTile(b),S=w.getBucket(n);if(S){var E=r?S.text:S.icon;if(E&&E.segments.get().length){var A=E.programConfigurations.get(n.id),I=r||S.sdfIcons,C=r?S.textSizeData:S.iconSizeData;if(c||(c=t.useProgram(I?"symbolSDF":"symbolIcon",A),A.setUniforms(t.context,c,n.paint,{zoom:t.transform.zoom}),U(c,t,n,r,g,m,C)),h.activeTexture.set(p.TEXTURE0),p.uniform1i(c.uniforms.u_texture,0),r)w.glyphAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.glyphAtlasTexture.size);else{var M=1!==n.layout.get("icon-size").constantOr(0)||S.iconsNeedLinear,P=m||0!==f.pitch;w.iconAtlasTexture.bind(I||t.options.rotating||t.options.zooming||M||P?p.LINEAR:p.NEAREST,p.CLAMP_TO_EDGE),p.uniform2fv(c.uniforms.u_texsize,w.iconAtlasTexture.size)}p.uniformMatrix4fv(c.uniforms.u_matrix,!1,t.translatePosMatrix(b.posMatrix,w,o,a));var L=F(w,1,t.transform.zoom),D=k(b.posMatrix,m,d,t.transform,L),R=T(b.posMatrix,m,d,t.transform,L)
;p.uniformMatrix4fv(c.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(R,w,o,a,!0)),y?(p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,xn),z(S,b.posMatrix,t,r,D,R,m,u)):p.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,D),p.uniform1f(c.uniforms.u_fade_change,t.options.fadeDuration?t.symbolFadeChange:1),Z(c,A,t,n,w,E,r,I,m)}}}}function U(e,n,i,r,o,a,s){var l=n.context.gl,u=n.transform;l.uniform1i(e.uniforms.u_pitch_with_map,a?1:0),l.uniform1f(e.uniforms.u_is_text,r?1:0),l.uniform1f(e.uniforms.u_pitch,u.pitch/360*2*Math.PI);var c="constant"===s.functionType||"source"===s.functionType,h="constant"===s.functionType||"camera"===s.functionType;l.uniform1i(e.uniforms.u_is_size_zoom_constant,c?1:0),l.uniform1i(e.uniforms.u_is_size_feature_constant,h?1:0),l.uniform1f(e.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var p=t.evaluateSizeForZoom(s,u.zoom,bn.properties[r?"text-size":"icon-size"]);void 0!==p.uSizeT&&l.uniform1f(e.uniforms.u_size_t,p.uSizeT),void 0!==p.uSize&&l.uniform1f(e.uniforms.u_size,p.uSize),l.uniform1f(e.uniforms.u_aspect_ratio,u.width/u.height),l.uniform1i(e.uniforms.u_rotate_symbol,o?1:0)}function Z(t,e,n,i,r,o,a,s,l){var u=n.context,c=u.gl,h=n.transform;if(s){var p=0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),f=l?Math.cos(h._pitch)*h.cameraToCenterDistance:1;c.uniform1f(t.uniforms.u_gamma_scale,f),p&&(c.uniform1f(t.uniforms.u_is_halo,1),G(o,i,u,t)),c.uniform1f(t.uniforms.u_is_halo,0)}G(o,i,u,t)}function G(t,e,n,i){i.draw(n,n.gl.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function W(e,n,i,r,o,a,s,l,u){var c,h,p,f,d=n.context,m=d.gl,y=o.paint.get("line-dasharray"),g=o.paint.get("line-pattern");if(l||u){var v=1/F(i,1,n.transform.tileZoom);if(y){c=n.lineAtlas.getDash(y.from,"round"===o.layout.get("line-cap")),h=n.lineAtlas.getDash(y.to,"round"===o.layout.get("line-cap"));var _=c.width*y.fromScale,x=h.width*y.toScale;m.uniform2f(e.uniforms.u_patternscale_a,v/_,-c.height/2),m.uniform2f(e.uniforms.u_patternscale_b,v/x,-h.height/2),m.uniform1f(e.uniforms.u_sdfgamma,n.lineAtlas.width/(256*Math.min(_,x)*t.default$2.devicePixelRatio)/2)}else if(g){if(p=n.imageManager.getPattern(g.from),f=n.imageManager.getPattern(g.to),!p||!f)return;m.uniform2f(e.uniforms.u_pattern_size_a,p.displaySize[0]*g.fromScale/v,p.displaySize[1]),m.uniform2f(e.uniforms.u_pattern_size_b,f.displaySize[0]*g.toScale/v,f.displaySize[1]);var b=n.imageManager.getPixelSize(),w=b.width,S=b.height;m.uniform2fv(e.uniforms.u_texsize,[w,S])}m.uniform2f(e.uniforms.u_gl_units_to_pixels,1/n.transform.pixelsToGLUnits[0],1/n.transform.pixelsToGLUnits[1])}l&&(y?(m.uniform1i(e.uniforms.u_image,0),d.activeTexture.set(m.TEXTURE0),n.lineAtlas.bind(d),m.uniform1f(e.uniforms.u_tex_y_a,c.y),m.uniform1f(e.uniforms.u_tex_y_b,h.y),m.uniform1f(e.uniforms.u_mix,y.t)):g&&(m.uniform1i(e.uniforms.u_image,0),d.activeTexture.set(m.TEXTURE0),n.imageManager.bind(d),m.uniform2fv(e.uniforms.u_pattern_tl_a,p.tl),m.uniform2fv(e.uniforms.u_pattern_br_a,p.br),m.uniform2fv(e.uniforms.u_pattern_tl_b,f.tl),m.uniform2fv(e.uniforms.u_pattern_br_b,f.br),m.uniform1f(e.uniforms.u_fade,g.t))),d.setStencilMode(n.stencilModeForClipping(a));var E=n.translatePosMatrix(a.posMatrix,i,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"));if(m.uniformMatrix4fv(e.uniforms.u_matrix,!1,E),m.uniform1f(e.uniforms.u_ratio,1/F(i,1,n.transform.zoom)),o.paint.get("line-gradient")){d.activeTexture.set(m.TEXTURE0);var k=o.gradientTexture;if(!o.gradient)return;k||(k=o.gradientTexture=new t.default$4(d,o.gradient,m.RGBA)),k.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.uniform1i(e.uniforms.u_image,0)}e.draw(d,m.TRIANGLES,o.id,r.layoutVertexBuffer,r.indexBuffer,r.segments,s)}function X(t,e,n,i,r){if(!wn(n.paint.get("fill-pattern"),t))for(var o=!0,a=0,s=i;a<s.length;a+=1){var l=s[a],u=e.getTile(l),c=u.getBucket(n);c&&(t.context.setStencilMode(t.stencilModeForClipping(l)),r(t,e,n,u,l,c,o),o=!1)}}function H(t,e,n,i,r,o,a){var s=t.context.gl,l=o.programConfigurations.get(n.id);J("fill",n.paint.get("fill-pattern"),t,l,n,i,r,a).draw(t.context,s.TRIANGLES,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,l)}function K(t,e,n,i,r,o,a){var s=t.context.gl,l=o.programConfigurations.get(n.id),u=J("fillOutline",n.getPaintProperty("fill-outline-color")?null:n.paint.get("fill-pattern"),t,l,n,i,r,a);s.uniform2f(u.uniforms.u_world,s.drawingBufferWidth,s.drawingBufferHeight),u.draw(t.context,s.LINES,n.id,o.layoutVertexBuffer,o.indexBuffer2,o.segments2,l)}function J(t,e,n,i,r,o,a,s){var l,u=n.context.program.get();return e?(l=n.useProgram(t+"Pattern",i),(s||l.program!==u)&&(i.setUniforms(n.context,l,r.paint,{zoom:n.transform.zoom}),Sn(e,n,l)),En(o,n,l)):(l=n.useProgram(t,i),(s||l.program!==u)&&i.setUniforms(n.context,l,r.paint,{zoom:n.transform.zoom})),n.context.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,n.translatePosMatrix(a.posMatrix,o,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"))),l}function Y(e,n,i,r,o,a,s){var l=e.context,u=l.gl,c=i.paint.get("fill-extrusion-pattern"),h=e.context.program.get(),p=a.programConfigurations.get(i.id),f=e.useProgram(c?"fillExtrusionPattern":"fillExtrusion",p);if((s||f.program!==h)&&p.setUniforms(l,f,i.paint,{zoom:e.transform.zoom}),c){if(wn(c,e))return;Sn(c,e,f),En(r,e,f),u.uniform1f(f.uniforms.u_height_factor,-Math.pow(2,o.overscaledZ)/r.tileSize/8)}e.context.gl.uniformMatrix4fv(f.uniforms.u_matrix,!1,e.translatePosMatrix(o.posMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor"))),function(e,n){var i=n.context.gl,r=n.style.light,o=r.properties.get("position"),a=[o.x,o.y,o.z],s=t.create$2();"viewport"===r.properties.get("anchor")&&t.fromRotation(s,-n.transform.angle),t.transformMat3(a,a,s);var l=r.properties.get("color");i.uniform3fv(e.uniforms.u_lightpos,a),i.uniform1f(e.uniforms.u_lightintensity,r.properties.get("intensity")),i.uniform3f(e.uniforms.u_lightcolor,l.r,l.g,l.b)}(f,e),f.draw(l,u.TRIANGLES,i.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,p)}function Q(e,n,i){var r=e.context,o=r.gl,a=n.fbo;if(a){var s=e.useProgram("hillshade"),l=e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),!0);!function(t,e,n){var i=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(i-=e.transform.angle),e.context.gl.uniform2f(t.uniforms.u_light,n.paint.get("hillshade-exaggeration"),i)}(s,e,i);var u=function(e,n){var i=n.toCoordinate(),r=new t.default$15(i.column,i.row+1,i.zoom);return[e.transform.coordinateLocation(i).lat,e.transform.coordinateLocation(r).lat]}(e,n.tileID);r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,l),o.uniform2fv(s.uniforms.u_latrange,u),o.uniform1i(s.uniforms.u_image,0);var c=i.paint.get("hillshade-shadow-color");o.uniform4f(s.uniforms.u_shadow,c.r,c.g,c.b,c.a);var h=i.paint.get("hillshade-highlight-color");o.uniform4f(s.uniforms.u_highlight,h.r,h.g,h.b,h.a);var p=i.paint.get("hillshade-accent-color");if(o.uniform4f(s.uniforms.u_accent,p.r,p.g,p.b,p.a),n.maskedBoundsBuffer&&n.maskedIndexBuffer&&n.segments)s.draw(r,o.TRIANGLES,i.id,n.maskedBoundsBuffer,n.maskedIndexBuffer,n.segments);else{var f=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(r,s,f,[]),o.drawArrays(o.TRIANGLE_STRIP,0,f.length)}}}function tt(e,n,i){var r=e.context,o=r.gl;if(n.dem&&n.dem.level){var a=n.dem.level.dim,s=n.dem.getPixels();if(r.activeTexture.set(o.TEXTURE1),r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(n.tileSize),n.demTexture){var l=n.demTexture;l.update(s,{premultiply:!1}),l.bind(o.NEAREST,o.CLAMP_TO_EDGE)}else n.demTexture=new t.default$4(r,s,o.RGBA,{premultiply:!1}),n.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);r.activeTexture.set(o.TEXTURE0);var u=n.fbo;if(!u){var c=new t.default$4(r,{width:a,height:a,data:null},o.RGBA);c.bind(o.LINEAR,o.CLAMP_TO_EDGE),(u=n.fbo=r.createFramebuffer(a,a)).colorAttachment.set(c.texture)}r.bindFramebuffer.set(u.framebuffer),r.viewport.set([0,0,a,a]);var h=t.create();t.ortho(h,0,t.default$10,-t.default$10,0,0,1),t.translate(h,h,[0,-t.default$10,0]);var p=e.useProgram("hillshadePrepare");o.uniformMatrix4fv(p.uniforms.u_matrix,!1,h),o.uniform1f(p.uniforms.u_zoom,n.tileID.overscaledZ),o.uniform2fv(p.uniforms.u_dimension,[2*a,2*a]),o.uniform1i(p.uniforms.u_image,1),o.uniform1f(p.uniforms.u_maxzoom,i);var f=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(r,p,f,[]),o.drawArrays(o.TRIANGLE_STRIP,0,f.length),n.needsHillshadePrepare=!1}}function et(e,n,i,r,o){var a=r.paint.get("raster-fade-duration");if(a>0){var s=t.default$2.now(),l=(s-e.timeAdded)/a,u=n?(s-n.timeAdded)/a:-1,c=i.getSource(),h=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),f=p&&e.refreshedUponExpiration?1:t.clamp(p?l:1-u,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}function nt(e,n,i){var r=e.context,o=r.gl,a=i.posMatrix,s=e.useProgram("debug");r.setDepthMode(Me.disabled),r.setStencilMode(Pe.disabled),r.setColorMode(e.colorModeForRenderPass()),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,a),o.uniform4f(s.uniforms.u_color,1,0,0,1),e.debugVAO.bind(r,s,e.debugBuffer,[]),o.drawArrays(o.LINE_STRIP,0,e.debugBuffer.length);for(var l=function(t,e,n,i){i=i||1;var r,o,a,s,l,u,c,h,p=[];for(r=0,o=t.length;r<o;r++)if(l=kn[t[r]]){for(h=null,a=0,s=l[1].length;a<s;a+=2)-1===l[1][a]&&-1===l[1][a+1]?h=null:(u=e+l[1][a]*i,c=200-l[1][a+1]*i,h&&p.push(h.x,h.y,u,c),h={x:u,y:c});e+=l[0]*i}return p}(i.toString(),50,0,5),u=new t.PosArray,c=0;c<l.length;c+=2)u.emplaceBack(l[c],l[c+1]);var h=r.createVertexBuffer(u,dn.members);(new Zt).bind(r,s,h,[]),o.uniform4f(s.uniforms.u_color,1,1,1,1);for(var p=n.getTile(i).tileSize,f=t.default$10/(Math.pow(2,e.transform.zoom-i.overscaledZ)*p),d=[[-1,-1],[-1,1],[1,-1],[1,1]],m=0;m<d.length;m++){var y=d[m];o.uniformMatrix4fv(s.uniforms.u_matrix,!1,t.translate([],a,[f*y[0],f*y[1],0])),o.drawArrays(o.LINES,0,h.length)}o.uniform4f(s.uniforms.u_color,0,0,0,1),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,a),o.drawArrays(o.LINES,0,h.length)}function it(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function rt(t,e,n,i,r){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,c=t.dx>0,h=e.dx<0,p=o;p<a;p++){var f=l*Math.max(0,Math.min(t.dy,p+c-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,p+h-e.y0))+e.x0;r(Math.floor(d),Math.ceil(f),p)}}function ot(t,e,n,i,r,o){var a,s=it(t,e),l=it(e,n),u=it(n,t);s.dy>l.dy&&(a=s,s=l,l=a),s.dy>u.dy&&(a=s,s=u,u=a),l.dy>u.dy&&(a=l,l=u,u=a),s.dy&&rt(u,s,i,r,o),l.dy&&rt(u,l,i,r,o)}function at(t){return t*(2-t)}function st(t){t.parentNode&&t.parentNode.removeChild(t)}function lt(t,e,n){if(t=new Ft(t.lng,t.lat),e){var i=new Ft(t.lng-360,t.lat),r=new Ft(t.lng+360,t.lat),o=n.locationPoint(t).distSqr(e);n.locationPoint(i).distSqr(e)<o?t=i:n.locationPoint(r).distSqr(e)<o&&(t=r)}for(;Math.abs(t.lng-n.center.lng)>180;){var a=n.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=n.width&&a.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}function ut(t,e,n){var i=t.classList;for(var r in ni)i.remove("mapboxgl-"+n+"-anchor-"+r);i.add("mapboxgl-"+n+"-anchor-"+e)}function ct(t,e,n){var i,r,o,a,s,l,u=n&&n.maxWidth||100,c=t._container.clientHeight/2,h=(i=t.unproject([0,c]),r=t.unproject([u,c]),o=Math.PI/180,a=i.lat*o,s=r.lat*o,l=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((r.lng-i.lng)*o),6371e3*Math.acos(Math.min(l,1)));if(n&&"imperial"===n.unit){var p=3.2808*h;p>5280?ht(e,u,p/5280,"mi"):ht(e,u,p,"ft")}else n&&"nautical"===n.unit?ht(e,u,h/1852,"nm"):ht(e,u,h,"m")}function ht(t,e,n,i){var r,o,a,s=(r=n,(o=Math.pow(10,(""+Math.floor(r)).length-1))*(a=(a=r/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:1)),l=s/n;"m"===i&&s>=1e3&&(s/=1e3,i="km"),t.style.width=e*l+"px",t.innerHTML=s+i}var pt,ft=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===n[t]&&(n[t]=function(t){var n=document.createElement("canvas"),i=Object.create(e.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",i)||n.probablySupportsContext("experimental-webgl",i):n.supportsContext?n.supportsContext("webgl",i)||n.supportsContext("experimental-webgl",i):n.getContext("webgl",i)||n.getContext("experimental-webgl",i)}(t)),n[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var n={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),dt={create:function(e,n,i){var r=t.default$1.document.createElement(e);return n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.default$1.document.createElementNS(e,n)}},mt=t.default$1.document?t.default$1.document.documentElement.style:null,yt=e(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);dt.disableDrag=function(){mt&&yt&&(pt=mt[yt],mt[yt]="none")},dt.enableDrag=function(){mt&&yt&&(mt[yt]=pt)};var gt=e(["transform","WebkitTransform"]);dt.setTransform=function(t,e){t.style[gt]=e};var vt=!1;try{var _t=Object.defineProperty({},"passive",{get:function(){vt=!0}});t.default$1.addEventListener("test",_t,_t),t.default$1.removeEventListener("test",_t,_t)}catch(t){vt=!1}dt.addEventListener=function(t,e,n,i){void 0===i&&(i={}),"passive"in i&&vt?t.addEventListener(e,n,i):t.addEventListener(e,n,i.capture)},dt.removeEventListener=function(t,e,n,i){void 0===i&&(i={}),"passive"in i&&vt?t.removeEventListener(e,n,i):t.removeEventListener(e,n,i.capture)};var xt=function(e){e.preventDefault(),e.stopPropagation(),t.default$1.removeEventListener("click",xt,!0)};dt.suppressClick=function(){t.default$1.addEventListener("click",xt,!0),t.default$1.setTimeout(function(){t.default$1.removeEventListener("click",xt,!0)},0)},dt.mousePos=function(e,n){var i=e.getBoundingClientRect();return n=n.touches?n.touches[0]:n,new t.default(n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop)},dt.touchPos=function(e,n){for(var i=e.getBoundingClientRect(),r=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)r.push(new t.default(o[a].clientX-i.left-e.clientLeft,o[a].clientY-i.top-e.clientTop));return r},dt.mouseButton=function(e){return void 0!==t.default$1.InstallTrigger&&2===e.button&&e.ctrlKey&&t.default$1.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},dt.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var bt={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},wt="See https://www.mapbox.com/api-documentation/#access-tokens",St=function(t,e){if(!i(t))return t;var o=r(t);return o.path="/fonts/v1"+o.path,n(o,e)},Et=function(t,e){if(!i(t))return t;var o=r(t);return o.path="/v4/"+o.authority+".json",o.params.push("secure"),n(o,e)},kt=function(t,e,a,s){var l=r(t);return i(t)?(l.path="/styles/v1"+l.path+"/sprite"+e+a,n(l,s)):(l.path+=""+e+a,o(l))},Tt=/(\.(png|jpg)\d*)(?=$)/,At=function(e,n,a){if(!n||!i(n))return e;var s=r(e),l=t.default$2.devicePixelRatio>=2||512===a?"@2x":"",u=t.default$2.supportsWebp?".webp":"$1";return s.path=s.path.replace(Tt,""+l+u),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(bt.ACCESS_TOKEN||""))}(s.params),o(s)},It=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/,zt=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new t.default$3(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new t.RGBAImage({width:64,height:64}),this.dirty=!0};zt.prototype.isLoaded=function(){return this.loaded},zt.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var i=n[e],r=i.ids,o=i.callback;this._notify(r,o)}this.requestors=[]}},zt.prototype.getImage=function(t){return this.images[t]},zt.prototype.addImage=function(t,e){this.images[t]=e},zt.prototype.removeImage=function(t){delete this.images[t];var e=this.patterns[t];e&&(this.shelfPack.unref(e.bin),delete this.patterns[t])},zt.prototype.listImages=function(){return Object.keys(this.images)},zt.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var i=0,r=t;i<r.length;i+=1){var o=r[i];this.images[o]||(n=!1)}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},zt.prototype._notify=function(t,e){for(var n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=this.images[o];a&&(n[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,n)},zt.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},zt.prototype.getPattern=function(e){var n=this.patterns[e];if(n)return n.position;var i=this.getImage(e);if(!i)return null;var r=i.data.width+2,o=i.data.height+2,a=this.shelfPack.packOne(r,o);if(!a)return null;this.atlasImage.resize(this.getPixelSize());var s=i.data,l=this.atlasImage,u=a.x+1,c=a.y+1,h=s.width,p=s.height;t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c},{width:h,height:p}),t.RGBAImage.copy(s,l,{x:0,y:p-1},{x:u,y:c-1},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c+p},{width:h,height:1}),t.RGBAImage.copy(s,l,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:p}),t.RGBAImage.copy(s,l,{x:0,y:0},{x:u+h,y:c},{width:1,height:p}),this.dirty=!0;var f=new t.ImagePosition(a,i);return this.patterns[e]={bin:a,position:f},f},zt.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.default$4(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)};var Ct=a,Mt=1e20;a.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=e.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?Mt:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?Mt:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(s(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),s(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var o=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return n};var Pt=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};Pt.prototype.setURL=function(t){this.url=t},Pt.prototype.getGlyphs=function(e,n){var i=this,r=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var l=s[a];r.push({stack:o,id:l})}t.asyncAll(r,function(t,e){var n=t.stack,r=t.id,o=i.entries[n];o||(o=i.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[r];if(void 0===a)if(a=i._tinySDF(o,n,r))e(null,{stack:n,id:r,glyph:a});else{var s=Math.floor(r/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var l=o.requests[s];l||(l=o.requests[s]=[],Pt.loadGlyphRange(n,s,i.url,i.requestTransform,function(t,e){if(e)for(var n in e)o.glyphs[+n]=e[+n];for(var i=0,r=l;i<r.length;i+=1)(0,r[i])(t,e);delete o.requests[s]})),l.push(function(t,i){t?e(t):i&&e(null,{stack:n,id:r,glyph:i[r]||null})})}}else e(null,{stack:n,id:r,glyph:a})},function(t,e){if(t)n(t);else if(e){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r],s=a.stack,l=a.id,u=a.glyph;(i[s]||(i[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}n(null,i)}})},Pt.prototype._tinySDF=function(e,n,i){var r=this.localIdeographFontFamily;if(r&&(t.default$6["CJK Unified Ideographs"](i)||t.default$6["Hangul Syllables"](i))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new Pt.TinySDF(24,3,8,.25,r,a)}return{id:i,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Pt.loadGlyphRange=function(e,n,i,r,o){var a=256*n,s=a+255,l=r(St(i).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,function(e,n){if(e)o(e);else if(n){for(var i={},r=0,a=t.default$5(n.data);r<a.length;r+=1){var s=a[r];i[s.id]=s}o(null,i)}})},Pt.TinySDF=Ct;var Lt=function(){this.specification=t.default$7.light.position};Lt.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},Lt.prototype.interpolate=function(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i)}};var Dt=new t.Properties({anchor:new t.DataConstantProperty(t.default$7.light.anchor),position:new Lt,color:new t.DataConstantProperty(t.default$7.light.color),intensity:new t.DataConstantProperty(t.default$7.light.intensity)}),Rt=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(Dt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var n in e){var i=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),i):this._transitionable.setValue(n,i)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.default$7})))},n}(t.Evented),Bt=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};Bt.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},Bt.prototype.addDash=function(e,n){var i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,l=s/2,u=e.length%2==1,c=-i;c<=i;c++)for(var h=this.nextRow+i+c,p=this.width*h,f=u?-e[e.length-1]:0,d=e[0],m=1,y=0;y<this.width;y++){for(;d<y/s;)f=d,d+=e[m],u&&m===e.length-1&&(d+=e[0]),m++;var g=Math.abs(y-f*s),v=Math.abs(y-d*s),_=Math.min(g,v),x=m%2==1,b=void 0;if(n){var w=i?c/i*(l+1):0;if(x){var S=l-Math.abs(w);b=Math.sqrt(_*_+S*S)}else b=l-Math.sqrt(_*_+w*w)}else b=(x?1:-1)*_;this.data[3+4*(p+y)]=Math.max(0,Math.min(255,b+128))}var E={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=r,this.dirty=!0,E},Bt.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var Ot=function e(n,i){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var r=this.workerPool.acquire(this.id),o=0;o<r.length;o++){var a=r[o],s=new e.Actor(a,i,this.id);s.name="Worker "+o,this.actors.push(s)}};Ot.prototype.broadcast=function(e,n,i){i=i||function(){},t.asyncAll(this.actors,function(t,i){t.send(e,n,i)},i)},Ot.prototype.send=function(t,e,n,i){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,e,n),i},Ot.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},Ot.Actor=t.default$9;var Ft=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ft.prototype.wrap=function(){return new Ft(t.wrap(this.lng,-180,180),this.lat)},Ft.prototype.toArray=function(){return[this.lng,this.lat]},Ft.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ft.prototype.toBounds=function(t){var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Vt(new Ft(this.lng-n,this.lat-e),new Ft(this.lng+n,this.lat+e))},Ft.convert=function(t){if(t instanceof Ft)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Ft(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Ft(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Vt=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Vt.prototype.setNorthEast=function(t){return this._ne=t instanceof Ft?new Ft(t.lng,t.lat):Ft.convert(t),this},Vt.prototype.setSouthWest=function(t){return this._sw=t instanceof Ft?new Ft(t.lng,t.lat):Ft.convert(t),this},Vt.prototype.extend=function(t){var e,n,i=this._sw,r=this._ne;if(t instanceof Ft)e=t,n=t;else{if(!(t instanceof Vt))return Array.isArray(t)?t.every(Array.isArray)?this.extend(Vt.convert(t)):this.extend(Ft.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return i||r?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),r.lng=Math.max(n.lng,r.lng),r.lat=Math.max(n.lat,r.lat)):(this._sw=new Ft(e.lng,e.lat),this._ne=new Ft(n.lng,n.lat)),this},Vt.prototype.getCenter=function(){return new Ft((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Vt.prototype.getSouthWest=function(){return this._sw},Vt.prototype.getNorthEast=function(){return this._ne},Vt.prototype.getNorthWest=function(){return new Ft(this.getWest(),this.getNorth())},Vt.prototype.getSouthEast=function(){return new Ft(this.getEast(),this.getSouth())},Vt.prototype.getWest=function(){return this._sw.lng},Vt.prototype.getSouth=function(){return this._sw.lat},Vt.prototype.getEast=function(){return this._ne.lng},Vt.prototype.getNorth=function(){return this._ne.lat},Vt.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Vt.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Vt.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Vt.convert=function(t){return!t||t instanceof Vt?t:new Vt(t)};var Nt=function(t,e,n){this.bounds=Vt.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24};Nt.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},Nt.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),n=Math.floor(this.latY(this.bounds.getNorth(),t.z)),i=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),r=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<i&&t.y>=n&&t.y<r},Nt.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},Nt.prototype.latY=function(e,n){var i=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),r=Math.pow(2,n)/(2*Math.PI);return Math.pow(2,n-1)+.5*Math.log((1+i)/(1-i))*-r};var jt=function(e){function n(n,i,r,o){if(e.call(this),this.id=n,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(i,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),u(this._options,this.map._transformRequest,function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new Nt(i.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){function i(t,i){return e.aborted?n(null):t?n(t):(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}var r=At(e.tileID.canonical.url(this.tiles,this.scheme),this.url),o={request:this.map._transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.default$2.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};o.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",o,i.bind(this)):"loading"===e.state?e.reloadCallback=n:this.dispatcher.send("reloadTile",o,i.bind(this),e.workerID)},n.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),$t=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),u(this._options,this.map._transformRequest,function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),
i.bounds&&(e.tileBounds=new Nt(i.bounds,e.minzoom,e.maxzoom)),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var i=this,r=At(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(r,t.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){i.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,s=a.gl;e.texture=i.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.default$4(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",n(null)}})},n.prototype.abortTile=function(t,e){t.request&&(t.request.abort(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),qt=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},i),this.encoding=i.encoding||"mapbox"}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var i=At(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(i,r){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData(r),delete r.cacheControl,delete r.expires;var o=t.default$2.getImageData(r),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+i)%i,s=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},n}($t),Ut=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=r,this.setEventedParent(o),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution);var a=t.default$10/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:t.default$10,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.default$10,radius:(i.clusterRadius||50)*a,log:!1}},i.workerOptions)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(n){if(n)e.fire(new t.ErrorEvent(n));else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",i))}})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)return n.fire(new t.ErrorEvent(e));var i={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(i.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",i))}),this},n.prototype._updateWorkerData=function(e){var n=this,i=t.extend({},this.workerOptions),r=this._data;"string"==typeof r?(i.request=this.map._transformRequest(t.default$2.resolveURL(r),t.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(r),this.workerID=this.dispatcher.send(this.type+".loadData",i,function(t,r){n._removed||r&&r.abandoned||(n._loaded=!0,r&&r.resourceTiming&&r.resourceTiming[n.id]&&(n._resourceTiming=r.resourceTiming[n.id].slice(0)),n.dispatcher.send(n.type+".coalesce",{source:i.source},null,n.workerID),e(t))},this.workerID)},n.prototype.loadTile=function(e,n){var i=this,r=void 0===e.workerID?"loadTile":"reloadTile",o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.default$2.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(r,o,function(t,o){return e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,i.map.painter,"reloadTile"===r),n(null))},this.workerID)},n.prototype.abortTile=function(t){t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},n.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),Zt=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Zt.prototype.bind=function(t,e,n,i,r,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==i.length,u=0;!l&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(l=!0);var c=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||c?this.freshBind(e,n,i,r,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind())},Zt.prototype.freshBind=function(t,e,n,i,r,o,a){var s,l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var h=l;h<s;h++)c.disableVertexAttribArray(h)}e.enableAttributes(c,t);for(var p=0,f=n;p<f.length;p+=1)f[p].enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,r);for(var d=0,m=n;d<m.length;d+=1){var y=m[d];y.bind(),y.setVertexAttribPointers(c,t,r)}o&&(o.bind(),o.setVertexAttribPointers(c,t,r)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,r)),u.currentNumAttributes=l},Zt.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Gt=function(e){function n(t,n,i,r){e.call(this),this.id=t,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(r),this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(e.image=t.default$2.getImageData(i),e._finishLoading())})},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){this.coordinates=e;var n=this.map,i=e.map(function(t){return n.transform.locationCoordinate(Ft.convert(t)).zoomTo(0)}),r=this.centerCoord=t.getCoordinatesCenter(i);r.column=Math.floor(r.column),r.row=Math.floor(r.row),this.tileID=new t.CanonicalTileID(r.zoom,r.column,r.row),this.minzoom=this.maxzoom=r.zoom;var o=i.map(function(e){var n=e.zoomTo(r.zoom);return new t.default(Math.round((n.column-r.column)*t.default$10),Math.round((n.row-r.row)*t.default$10))});return this._boundsArray=new t.RasterBoundsArray,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.default$10,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.default$10),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.default$10,t.default$10),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.default$11.members)),this.boundsVAO||(this.boundsVAO=new Zt),this.texture||(this.texture=new t.default$4(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),Wt=function(e){function n(t,n,i,r){e.call(this,t,n,i,r),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this,n=this.options;this.urls=[];for(var i=0,r=n.urls;i<r.length;i+=1){var o=r[i];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,function(n,i){n?e.fire(new t.ErrorEvent(n)):i&&(e.video=i,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map._rerender()}),e.map&&e.video.play(),e._finishLoading())})},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.default$11.members)),this.boundsVAO||(this.boundsVAO=new Zt),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.default$4(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(Gt),Xt=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.default$12("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.default$12("sources."+n,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.default$12("sources."+n,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.default$1.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.default$12("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.default$12("sources."+n,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.default$1.HTMLCanvasElement?this.options.canvas:t.default$1.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,i=n.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,t.default$11.members)),this.boundsVAO||(this.boundsVAO=new Zt),this.texture?e?this.texture.update(this.canvas):this._playing&&(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.canvas)):(this.texture=new t.default$4(n,this.canvas,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[r];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(Gt),Ht={vector:jt,raster:$t,"raster-dem":qt,geojson:Ut,video:Wt,image:Gt,canvas:Xt},Kt=function(e,n,i,r){var o=new Ht[n.type](e,n,i,r);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o},Jt=function(t,e){this.max=t,this.onRemove=e,this.reset()};Jt.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var i=n[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},Jt.prototype.add=function(t,e,n){var i=this,r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout(function(){i.remove(t,o)},n)),this.data[r].push(o),this.order.push(r),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Jt.prototype.has=function(t){return t.wrapped().key in this.data},Jt.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},Jt.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},Jt.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},Jt.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this},Jt.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var Yt=function(t,e,n){this.context=t;var i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};Yt.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},Yt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Yt.prototype.updateData=function(t){var e=this.context.gl;this.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},Yt.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var Qt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},te=function(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;var r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};te.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},te.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},te.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],r=e.attributes[i.name];void 0!==r&&t.enableVertexAttribArray(r)}},te.prototype.setVertexAttribPointers=function(t,e,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[Qt[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}},te.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var ee=function(e){this.context=e,this.current=t.default$8.transparent};ee.prototype.get=function(){return this.current},ee.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t)};var ne=function(t){this.context=t,this.current=1};ne.prototype.get=function(){return this.current},ne.prototype.set=function(t){this.current!==t&&(this.context.gl.clearDepth(t),this.current=t)};var ie=function(t){this.context=t,this.current=0};ie.prototype.get=function(){return this.current},ie.prototype.set=function(t){this.current!==t&&(this.context.gl.clearStencil(t),this.current=t)};var re=function(t){this.context=t,this.current=[!0,!0,!0,!0]};re.prototype.get=function(){return this.current},re.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t)};var oe=function(t){this.context=t,this.current=!0};oe.prototype.get=function(){return this.current},oe.prototype.set=function(t){this.current!==t&&(this.context.gl.depthMask(t),this.current=t)};var ae=function(t){this.context=t,this.current=255};ae.prototype.get=function(){return this.current},ae.prototype.set=function(t){this.current!==t&&(this.context.gl.stencilMask(t),this.current=t)};var se=function(t){this.context=t,this.current={func:t.gl.ALWAYS,ref:0,mask:255}};se.prototype.get=function(){return this.current},se.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t)};var le=function(t){this.context=t;var e=this.context.gl;this.current=[e.KEEP,e.KEEP,e.KEEP]};le.prototype.get=function(){return this.current},le.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t)};var ue=function(t){this.context=t,this.current=!1};ue.prototype.get=function(){return this.current},ue.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t}};var ce=function(t){this.context=t,this.current=[0,1]};ce.prototype.get=function(){return this.current},ce.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.depthRange(t[0],t[1]),this.current=t)};var he=function(t){this.context=t,this.current=!1};he.prototype.get=function(){return this.current},he.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t}};var pe=function(t){this.context=t,this.current=t.gl.LESS};pe.prototype.get=function(){return this.current},pe.prototype.set=function(t){this.current!==t&&(this.context.gl.depthFunc(t),this.current=t)};var fe=function(t){this.context=t,this.current=!1};fe.prototype.get=function(){return this.current},fe.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t}};var de=function(t){this.context=t;var e=this.context.gl;this.current=[e.ONE,e.ZERO]};de.prototype.get=function(){return this.current},de.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.blendFunc(t[0],t[1]),this.current=t)};var me=function(e){this.context=e,this.current=t.default$8.transparent};me.prototype.get=function(){return this.current},me.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t)};var ye=function(t){this.context=t,this.current=null};ye.prototype.get=function(){return this.current},ye.prototype.set=function(t){this.current!==t&&(this.context.gl.useProgram(t),this.current=t)};var ge=function(t){this.context=t,this.current=t.gl.TEXTURE0};ge.prototype.get=function(){return this.current},ge.prototype.set=function(t){this.current!==t&&(this.context.gl.activeTexture(t),this.current=t)};var ve=function(t){this.context=t;var e=this.context.gl;this.current=[0,0,e.drawingBufferWidth,e.drawingBufferHeight]};ve.prototype.get=function(){return this.current},ve.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t)};var _e=function(t){this.context=t,this.current=null};_e.prototype.get=function(){return this.current},_e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t}};var xe=function(t){this.context=t,this.current=null};xe.prototype.get=function(){return this.current},xe.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t}};var be=function(t){this.context=t,this.current=null};be.prototype.get=function(){return this.current},be.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t}};var we=function(t){this.context=t,this.current=null};we.prototype.get=function(){return this.current},we.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t}};var Se=function(t){this.context=t,this.current=null};Se.prototype.get=function(){return this.current},Se.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t};var Ee=function(t){this.context=t,this.current=null};Ee.prototype.get=function(){return this.current},Ee.prototype.set=function(t){this.current!==t&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t)};var ke=function(t){this.context=t,this.current=4};ke.prototype.get=function(){return this.current},ke.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t}};var Te=function(t){this.context=t,this.current=!1};Te.prototype.get=function(){return this.current},Te.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t}};var Ae=function(t,e){this.context=t,this.current=null,this.parent=e};Ae.prototype.get=function(){return this.current};var Ie=function(t){function e(e,n){t.call(this,e,n),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(Ae),ze=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t}},e}(Ae),Ce=function(t,e,n){this.context=t,this.width=e,this.height=n;var i=t.gl,r=this.framebuffer=i.createFramebuffer();this.colorAttachment=new Ie(t,r),this.depthAttachment=new ze(t,r)};Ce.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n),t.deleteFramebuffer(this.framebuffer)};var Me=function(t,e,n){this.func=t,this.mask=e,this.range=n};Me.ReadOnly=!1,Me.ReadWrite=!0,Me.disabled=new Me(519,Me.ReadOnly,[0,1]);var Pe=function(t,e,n,i,r,o){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o};Pe.disabled=new Pe({func:519,mask:0},0,0,7680,7680,7680);var Le=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};Le.Replace=[1,0],Le.disabled=new Le(Le.Replace,t.default$8.transparent,[!1,!1,!1,!1]),Le.unblended=new Le(Le.Replace,t.default$8.transparent,[!0,!0,!0,!0]),Le.alphaBlended=new Le([1,771],t.default$8.transparent,[!0,!0,!0,!0]);var De=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ee(this),this.clearDepth=new ne(this),this.clearStencil=new ie(this),this.colorMask=new re(this),this.depthMask=new oe(this),this.stencilMask=new ae(this),this.stencilFunc=new se(this),this.stencilOp=new le(this),this.stencilTest=new ue(this),this.depthRange=new ce(this),this.depthTest=new he(this),this.depthFunc=new pe(this),this.blend=new fe(this),this.blendFunc=new de(this),this.blendColor=new me(this),this.program=new ye(this),this.activeTexture=new ge(this),this.viewport=new ve(this),this.bindFramebuffer=new _e(this),this.bindRenderbuffer=new xe(this),this.bindTexture=new be(this),this.bindVertexBuffer=new we(this),this.bindElementBuffer=new Se(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ee(this),this.pixelStoreUnpack=new ke(this),this.pixelStoreUnpackPremultiplyAlpha=new Te(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};De.prototype.createIndexBuffer=function(t,e){return new Yt(this,t,e)},De.prototype.createVertexBuffer=function(t,e,n){return new te(this,t,e,n)},De.prototype.createRenderbuffer=function(t,e,n){var i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r},De.prototype.createFramebuffer=function(t,e){return new Ce(this,t,e)},De.prototype.clear=function(t){var e=t.color,n=t.depth,i=this.gl,r=0;e&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(r|=i.DEPTH_BUFFER_BIT,this.clearDepth.set(n),this.depthMask.set(!0)),i.clear(r)},De.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},De.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},De.prototype.setColorMode=function(e){t.default$13(e.blendFunction,Le.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)};var Re=function(e){function n(n,i,r){var o=this;e.call(this),this.id=n,this.dispatcher=r,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=Kt(n,i,r,this),this._tiles={},this._cache=new Jt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={},this._state=new t.default$16}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1
;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[e].upload(t)},n.prototype.getIds=function(){var e=this;return Object.keys(this._tiles).map(Number).sort(function(n,i){var r=e._tiles[n].tileID,o=e._tiles[i].tileID,a=new t.default(r.canonical.x,r.canonical.y).rotate(e.transform.angle),s=new t.default(o.canonical.x,o.canonical.y).rotate(e.transform.angle);return r.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})},n.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0,{});return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,i,r){if(r)return e.state="errored",void(404!==r.status?this._source.fire(new t.ErrorEvent(r,{tile:e})):this.update(this.transform));e.timeAdded=t.default$2.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null)},n.prototype._backfillDEM=function(t){function e(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}for(var n=this.getRenderableIds(),i=0;i<n.length;i++){var r=n[i];if(t.neighboringTiles&&t.neighboringTiles[r]){var o=this.getTileByID(r);e(t,o),e(o,t)}}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},n.prototype._findLoadedChildren=function(t,e,n){var i=!1;for(var r in this._tiles){var o=this._tiles[r];if(!(n[r]||!o.hasData()||o.tileID.overscaledZ<=t.overscaledZ||o.tileID.overscaledZ>e)){var a=Math.pow(2,o.tileID.canonical.z-t.canonical.z);if(Math.floor(o.tileID.canonical.x/a)===t.canonical.x&&Math.floor(o.tileID.canonical.y/a)===t.canonical.y)for(n[r]=o.tileID,i=!0;o&&o.tileID.overscaledZ-1>t.overscaledZ;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);if(!s)break;(o=this._tiles[s.key])&&o.hasData()&&(delete n[r],n[s.key]=s)}}}return i},n.prototype.findLoadedParent=function(t,e,n){for(var i=t.overscaledZ-1;i>=e;i--){var r=t.scaledTo(i);if(!r)return;var o=String(r.key),a=this._tiles[o];if(a&&a.hasData())return n[o]=r,a;if(this._cache.has(r))return n[o]=r,this._cache.get(r)}},n.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),n=Math.floor(5*e),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(i)},n.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,n=Math.round(e);if(this._prevLng=t,n){var i={};for(var r in this._tiles){var o=this._tiles[r];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),i[o.tileID.key]=o}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},n.prototype.update=function(e){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter(function(t){return i._source.hasTile(t)}))):r=[];var o,a=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),s=Math.max(a-n.maxOverzooming,this._source.minzoom),l=Math.max(a+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(r,a),c={};if(f(this._source.type))for(var h=Object.keys(u),p=0;p<h.length;p++){var d=h[p],m=u[d],y=i._tiles[d];if(y&&(void 0===y.fadeEndTime||y.fadeEndTime>=t.default$2.now())){i._findLoadedChildren(m,l,u)&&(u[d]=m);var g=i.findLoadedParent(m,s,c);g&&i._addTile(g.tileID)}}for(o in c)u[o]||(i._coveredTiles[o]=!0);for(o in c)u[o]=c[o];for(var v=t.keysDifference(this._tiles,u),_=0;_<v.length;_++)i._removeTile(v[_])}},n.prototype._updateRetainedTiles=function(t,e){for(var i={},r={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s=0;s<t.length;s++){var l=t[s],u=this._addTile(l),c=!1;if(u.hasData())i[l.key]=l;else{c=u.wasRequested(),i[l.key]=l;var h=!0;if(e+1>this._source.maxzoom){var p=l.children(this._source.maxzoom)[0],f=this.getTile(p);f&&f.hasData()?i[p.key]=p:h=!1}else{this._findLoadedChildren(l,a,i);for(var d=l.children(this._source.maxzoom),m=0;m<d.length;m++)if(!i[d[m].key]){h=!1;break}}if(!h)for(var y=l.overscaledZ-1;y>=o;--y){var g=l.scaledTo(y);if(r[g.key])break;if(r[g.key]=!0,!(u=this.getTile(g))&&c&&(u=this._addTile(g)),u&&(i[g.key]=g,c=u.wasRequested(),u.hasData()))break}}}return i},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var i=Boolean(n);return i||(n=new t.default$14(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,i||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout(function(){n._reloadTile(t,"expired"),delete n._timers[t]},i))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n){for(var i=[],r=this.getIds(),o=1/0,a=1/0,s=-1/0,l=-1/0,u=e[0].zoom,c=0;c<e.length;c++){var h=e[c];o=Math.min(o,h.column),a=Math.min(a,h.row),s=Math.max(s,h.column),l=Math.max(l,h.row)}for(var f=0;f<r.length;f++){var d=this._tiles[r[f]],m=d.tileID,y=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),g=n*d.queryPadding*t.default$10/d.tileSize/y,v=[p(m,new t.default$15(o,a,u)),p(m,new t.default$15(s,l,u))];if(v[0].x-g<t.default$10&&v[0].y-g<t.default$10&&v[1].x+g>=0&&v[1].y+g>=0){for(var _=[],x=0;x<e.length;x++)_.push(p(m,e[x]));i.push({tile:d,tileID:m,queryGeometry:[_],scale:y})}}return i},n.prototype.getVisibleCoordinates=function(){for(var t=this,e=this.getRenderableIds().map(function(e){return t._tiles[e].tileID}),n=0,i=e;n<i.length;n+=1){var r=i[n];r.posMatrix=t.transform.calculatePosMatrix(r.toUnwrapped())}return e},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(f(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.default$2.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){t=t||"_geojsonTileLayer",this._state.updateState(t,e,n)},n.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},n}(t.Evented);Re.maxOverzooming=10,Re.maxUnderzooming=3;var Be,Oe=function(){this.active={}};Oe.prototype.acquire=function(t){if(!this.workers){var e=hi.workerCount;for(this.workers=[];this.workers.length<e;)this.workers.push(new d)}return this.active[t]=!0,this.workers.slice()},Oe.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)};var Fe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Ve=function(t,e,n){var i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};Ve.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ve.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Ve.prototype.insertCircle=function(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)},Ve.prototype._insertBoxCell=function(t,e,n,i,r,o){this.boxCells[r].push(o)},Ve.prototype._insertCircleCell=function(t,e,n,i,r,o){this.circleCells[r].push(o)},Ve.prototype._query=function(t,e,n,i,r,o){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return o?a.filter(o):a}var p={hitTest:r,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,n,i,this._queryCell,a,p,o),r?a.length>0:a},Ve.prototype._queryCircle=function(t,e,n,i,r){var o=t-n,a=t+n,s=e-n,l=e+n;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var u=[],c={hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,r),i?u.length>0:u},Ve.prototype.query=function(t,e,n,i,r){return this._query(t,e,n,i,!1,r)},Ve.prototype.hitTest=function(t,e,n,i,r){return this._query(t,e,n,i,!0,r)},Ve.prototype.hitTestCircle=function(t,e,n,i){return this._queryCircle(t,e,n,!0,i)},Ve.prototype._queryCell=function(t,e,n,i,r,o,a,s){var l=a.seenUids,u=this.boxCells[r];if(null!==u)for(var c=this.bboxes,h=0,p=u;h<p.length;h+=1){var f=p[h];if(!l.box[f]){l.box[f]=!0;var d=4*f;if(t<=c[d+2]&&e<=c[d+3]&&n>=c[d+0]&&i>=c[d+1]&&(!s||s(this.boxKeys[f]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[f],x1:c[d],y1:c[d+1],x2:c[d+2],y2:c[d+3]})}}}var m=this.circleCells[r];if(null!==m)for(var y=this.circles,g=0,v=m;g<v.length;g+=1){var _=v[g];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(y[x],y[x+1],y[x+2],t,e,n,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var b=y[x],w=y[x+1],S=y[x+2];o.push({key:this.circleKeys[_],x1:b-S,y1:w-S,x2:b+S,y2:w+S})}}}},Ve.prototype._queryCellCircle=function(t,e,n,i,r,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[r];if(null!==c)for(var h=this.bboxes,p=0,f=c;p<f.length;p+=1){var d=f[p];if(!u.box[d]){u.box[d]=!0;var m=4*d;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var y=this.circleCells[r];if(null!==y)for(var g=this.circles,v=0,_=y;v<_.length;v+=1){var x=_[v];if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circlesCollide(g[b],g[b+1],g[b+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return o.push(!0),!0}}},Ve.prototype._forEachCell=function(t,e,n,i,r,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i),p=l;p<=c;p++)for(var f=u;f<=h;f++){var d=this.xCellCount*f+p;if(r.call(this,t,e,n,i,d,o,a,s))return}},Ve.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Ve.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Ve.prototype._circlesCollide=function(t,e,n,i,r,o){var a=i-t,s=r-e,l=n+o;return l*l>a*a+s*s},Ve.prototype._circleAndRectCollide=function(t,e,n,i,r,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(l>s+n)return!1;var u=(a-r)/2,c=Math.abs(e-(r+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=n*n};var Ne=t.default$18.layout,je=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]),$e=function(t,e,n){void 0===e&&(e=new Ve(t.width+200,t.height+200,25)),void 0===n&&(n=new Ve(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};$e.prototype.placeCollisionBox=function(t,e,n,i,r){var o=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,u=t.x2*a+o.point.x,c=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!e&&this.grid.hitTest(s,l,u,c,r)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},$e.prototype.approximateTileDistance=function(t,e,n,i,r){var o=r?1:i/this.pitchfactor,a=t.lastSegmentViewportDistance*n;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},$e.prototype.placeCollisionCircles=function(e,n,i,r,o,a,s,l,u,c,h,p,f,d){var m=[],y=this.projectAnchor(c,a.anchorX,a.anchorY),g=u/24,v=a.lineOffsetX*u,_=a.lineOffsetY*u,x=new t.default(a.anchorX,a.anchorY),b=C(g,l,v,_,!1,A(x,h).point,x,a,s,h,{},!0),w=!1,S=!1,E=!0,k=y.perspectiveRatio*r,T=1/(r*i),I=0,z=0;b&&(I=this.approximateTileDistance(b.first.tileDistance,b.first.angle,T,y.cameraDistance,f),z=this.approximateTileDistance(b.last.tileDistance,b.last.angle,T,y.cameraDistance,f));for(var M=0;M<e.length;M+=5){var P=e[M],L=e[M+1],D=e[M+2],R=e[M+3];if(!b||R<-I||R>z)O(e,M,!1);else{var B=this.projectPoint(c,P,L),F=D*k;if(m.length>0){var V=B.x-m[m.length-4],N=B.y-m[m.length-3];if(F*F*2>V*V+N*N&&M+8<e.length){var j=e[M+8];if(j>-I&&j<z){O(e,M,!1);continue}}}var $=M/5;m.push(B.x,B.y,F,$),O(e,M,!0);var q=B.x-F,U=B.y-F,Z=B.x+F,G=B.y+F;if(E=E&&this.isOffscreen(q,U,Z,G),S=S||this.isInsideGrid(q,U,Z,G),!n&&this.grid.hitTestCircle(B.x,B.y,F,d)){if(!p)return{circles:[],offscreen:!1};w=!0}}}return{circles:w||!S?[]:m,offscreen:E}},$e.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],i=1/0,r=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var u=l[s],c=new t.default(u.x+100,u.y+100);i=Math.min(i,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),n.push(c)}for(var h={},p={},f=0,d=this.grid.query(i,r,o,a).concat(this.ignoredGrid.query(i,r,o,a));f<d.length;f+=1){var m=d[f],y=m.key;if(void 0===h[y.bucketInstanceId]&&(h[y.bucketInstanceId]={}),!h[y.bucketInstanceId][y.featureIndex]){var g=[new t.default(m.x1,m.y1),new t.default(m.x2,m.y1),new t.default(m.x2,m.y2),new t.default(m.x1,m.y2)];t.polygonIntersectsPolygon(n,g)&&(h[y.bucketInstanceId][y.featureIndex]=!0,void 0===p[y.bucketInstanceId]&&(p[y.bucketInstanceId]=[]),p[y.bucketInstanceId].push(y.featureIndex))}}return p},$e.prototype.insertCollisionBox=function(t,e,n,i,r){var o={bucketInstanceId:n,featureIndex:i,collisionGroupID:r};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},$e.prototype.insertCollisionCircles=function(t,e,n,i,r){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:i,collisionGroupID:r},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},$e.prototype.projectAnchor=function(t,e,n){var i=[e,n,0,1];return B(i,i,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5,cameraDistance:i[3]}},$e.prototype.projectPoint=function(e,n,i){var r=[n,i,0,1];return B(r,r,e),new t.default((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100)},$e.prototype.projectAndGetPerspectiveRatio=function(e,n,i){var r=[n,i,0,1];return B(r,r,e),{point:new t.default((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}},$e.prototype.isOffscreen=function(t,e,n,i){return n<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary},$e.prototype.isInsideGrid=function(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary};var qe=t.default$18.layout,Ue=function(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n};Ue.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Ze=function(t,e,n,i,r){this.text=new Ue(t?t.text:null,e,n,r),this.icon=new Ue(t?t.icon:null,e,i,r)};Ze.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ge=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},We=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};We.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var Xe=function(t,e,n){this.transform=t.clone(),this.collisionIndex=new $e(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new We(n)};Xe.prototype.placeLayerTile=function(e,n,i,r){var o=n.getBucket(e),a=n.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=n.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/t.default$10,h=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),p=k(h,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,F(n,1,this.transform.zoom)),f=k(h,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,F(n,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID),this.placeLayerBucket(o,h,p,f,u,c,i,r,s)}},Xe.prototype.placeLayerBucket=function(e,n,i,r,o,a,s,l,u){for(var c=e.layers[0].layout,h=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,qe.properties["text-size"]),p=!e.hasTextData()||c.get("text-optional"),f=!e.hasIconData()||c.get("icon-optional"),d=this.collisionGroups.get(e.sourceID),m=0,y=e.symbolInstances;m<y.length;m+=1){var g=y[m];if(!l[g.crossTileID]){var v=void 0!==g.feature.text,_=void 0!==g.feature.icon,x=!0,b=null,w=null,S=null,E=0,k=0;g.collisionArrays||(g.collisionArrays=e.deserializeCollisionBoxes(u,g.textBoxStartIndex,g.textBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex)),g.collisionArrays.textFeatureIndex&&(E=g.collisionArrays.textFeatureIndex),g.collisionArrays.textBox&&(v=(b=this.collisionIndex.placeCollisionBox(g.collisionArrays.textBox,c.get("text-allow-overlap"),a,n,d.predicate)).box.length>0,x=x&&b.offscreen);var T=g.collisionArrays.textCircles;if(T){var A=e.text.placedSymbolArray.get(g.placedTextSymbolIndices[0]),I=t.evaluateSizeForFeature(e.textSizeData,h,A);w=this.collisionIndex.placeCollisionCircles(T,c.get("text-allow-overlap"),o,a,g.key,A,e.lineVertexArray,e.glyphOffsetArray,I,n,i,s,"map"===c.get("text-pitch-alignment"),d.predicate),v=c.get("text-allow-overlap")||w.circles.length>0,x=x&&w.offscreen}g.collisionArrays.iconFeatureIndex&&(k=g.collisionArrays.iconFeatureIndex),g.collisionArrays.iconBox&&(_=(S=this.collisionIndex.placeCollisionBox(g.collisionArrays.iconBox,c.get("icon-allow-overlap"),a,n,d.predicate)).box.length>0,x=x&&S.offscreen),p||f?f?p||(_=_&&v):v=_&&v:_=v=_&&v,v&&b&&this.collisionIndex.insertCollisionBox(b.box,c.get("text-ignore-placement"),e.bucketInstanceId,E,d.ID),_&&S&&this.collisionIndex.insertCollisionBox(S.box,c.get("icon-ignore-placement"),e.bucketInstanceId,k,d.ID),v&&w&&this.collisionIndex.insertCollisionCircles(w.circles,c.get("text-ignore-placement"),e.bucketInstanceId,E,d.ID),this.placements[g.crossTileID]=new Ge(v,_,x||e.justReloaded),l[g.crossTileID]=!0}}e.justReloaded=!1},Xe.prototype.commit=function(t,e){this.commitTime=e;var n=!1,i=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,r=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=r[o];s?(this.opacities[o]=new Ze(s,i,a.text,a.icon),n=n||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new Ze(null,i,a.text,a.icon,a.skipFade),n=n||a.text||a.icon)}for(var l in r){var u=r[l];if(!this.opacities[l]){var c=new Ze(u,i,!1,!1);c.isHidden()||(this.opacities[l]=c,n=n||u.text.placed||u.icon.placed)}}n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},Xe.prototype.updateLayerOpacities=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},Xe.prototype.updateBucketOpacities=function(t,e,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();for(var i=t.layers[0].layout,r=new Ze(null,0,!1,!1,!0),o=new Ze(null,0,i.get("text-allow-overlap"),i.get("icon-allow-overlap"),!0),a=0;a<t.symbolInstances.length;a++){var s=t.symbolInstances[a],l=e[s.crossTileID],u=this.opacities[s.crossTileID];l?u=r:u||(u=o,this.opacities[s.crossTileID]=u),e[s.crossTileID]=!0;var c=s.numGlyphVertices>0||s.numVerticalGlyphVertices>0,h=s.numIconVertices>0;if(c){for(var p=N(u.text),f=(s.numGlyphVertices+s.numVerticalGlyphVertices)/4,d=0;d<f;d++)t.text.opacityVertexArray.emplaceBack(p);for(var m=0,y=s.placedTextSymbolIndices;m<y.length;m+=1){var g=y[m];t.text.placedSymbolArray.get(g).hidden=u.text.isHidden()}}if(h){for(var v=N(u.icon),_=0;_<s.numIconVertices/4;_++)t.icon.opacityVertexArray.emplaceBack(v);t.icon.placedSymbolArray.get(a).hidden=u.icon.isHidden()}s.collisionArrays||(s.collisionArrays=t.deserializeCollisionBoxes(n,s.textBoxStartIndex,s.textBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex));var x=s.collisionArrays;if(x){x.textBox&&t.hasCollisionBoxData()&&V(t.collisionBox.collisionVertexArray,u.text.placed,!1),x.iconBox&&t.hasCollisionBoxData()&&V(t.collisionBox.collisionVertexArray,u.icon.placed,!1);var b=x.textCircles;if(b&&t.hasCollisionCircleData())for(var w=0;w<b.length;w+=5){var S=l||0===b[w+4];V(t.collisionCircle.collisionVertexArray,u.text.placed,S)}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},Xe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},Xe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Xe.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},Xe.prototype.setStale=function(){this.stale=!0};var He=Math.pow(2,25),Ke=Math.pow(2,24),Je=Math.pow(2,17),Ye=Math.pow(2,16),Qe=Math.pow(2,9),tn=Math.pow(2,8),en=Math.pow(2,1),nn=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};nn.prototype.continuePlacement=function(t,e,n,i,r){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(i,o,n,this._seenCrossTileIDs),this._currentTileIndex++,r())return!0}};var rn=function(t,e,n,i,r,o){this.placement=new Xe(t,r,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1};rn.prototype.isDone=function(){return this._done},rn.prototype.continuePlacement=function(e,n,i){for(var r=this,o=t.default$2.now(),a=function(){var e=t.default$2.now()-o;return!r._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[r._currentPlacementIndex]],l=r.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(r._inProgressLayer||(r._inProgressLayer=new nn),r._inProgressLayer.continuePlacement(i[s.source],r.placement,r._showCollisionBoxes,s,a))return;delete r._inProgressLayer}r._currentPlacementIndex--}this._done=!0},rn.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var on=512/t.default$10/2,an=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)})}};an.prototype.getScaledCoordinates=function(e,n){var i=n.canonical.z-this.tileID.canonical.z,r=on/Math.pow(2,i),o=e.anchor;return{x:Math.floor((n.canonical.x*t.default$10+o.x)*r),y:Math.floor((n.canonical.y*t.default$10+o.y)*r)}},an.prototype.findMatches=function(t,e,n){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),r=0,o=t;r<o.length;r+=1){var a=o[r];if(!a.crossTileID){var s=this.indexedSymbolInstances[a.key];if(s)for(var l=this.getScaledCoordinates(a,e),u=0,c=s;u<c.length;u+=1){var h=c[u];if(Math.abs(h.coord.x-l.x)<=i&&Math.abs(h.coord.y-l.y)<=i&&!n[h.crossTileID]){n[h.crossTileID]=!0,a.crossTileID=h.crossTileID;break}}}}};var sn=function(){this.maxCrossTileID=0};sn.prototype.generate=function(){return++this.maxCrossTileID};var ln=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ln.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var i=this.indexes[n],r={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),r[a.tileID.key]=a}this.indexes[n]=r}this.lng=t},ln.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0,r=e.symbolInstances;i<r.length;i+=1)r[i].crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var o=this.usedCrossTileIDs[t.overscaledZ];for(var a in this.indexes){var s=this.indexes[a];if(Number(a)>t.overscaledZ)for(var l in s){var u=s[l];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,o)}else{var c=s[t.scaledTo(Number(a)).key];c&&c.findMatches(e.symbolInstances,t,o)}}for(var h=0,p=e.symbolInstances;h<p.length;h+=1){var f=p[h];f.crossTileID||(f.crossTileID=n.generate(),o[f.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new an(t,e.symbolInstances,e.bucketInstanceId),!0},ln.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var i=0,r=e.indexedSymbolInstances[n];i<r.length;i+=1){var o=r[i];delete this.usedCrossTileIDs[t][o.crossTileID]}},ln.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var i=this.indexes[n];for(var r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e};var un=function(){this.layerIndexes={},this.crossTileIDs=new sn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};un.prototype.addLayer=function(t,e,n){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new ln);var r=!1,o={};i.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.getBucket(t);u&&t.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,u,this.crossTileIDs)&&(r=!0),o[u.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(r=!0),r},un.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var cn=function(e,n){return t.emitValidationErrors(e,n&&n.filter(function(t){return"source.canvas"!==t.identifier}))},hn=t.pick(Fe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),pn=t.pick(Fe,["setCenter","setZoom","setBearing","setPitch"]),fn=function(e){function o(n,i){var r=this;void 0===i&&(i={}),e.call(this),this.map=n,this.dispatcher=new Ot((Be||(Be=new Oe),Be),this),this.imageManager=new zt,this.glyphManager=new Pt(n._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new Bt(256,512),this.crossTileSymbolIndex=new un,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.default$21,this._loaded=!1,this._resetUpdates();var a=this
;this._rtlTextPluginCallback=o.registerForPluginAvailability(function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=r.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var i in r._layers){var o=r._layers[i];o.source===n.id&&r._validateLayer(o)}}}})}return e&&(o.__proto__=e),o.prototype=Object.create(e&&e.prototype),o.prototype.constructor=o,o.prototype.loadURL=function(e,o){var a=this;void 0===o&&(o={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var s="boolean"==typeof o.validate?o.validate:!i(e);e=function(t,e){if(!i(t))return t;var o=r(t);return o.path="/styles/v1"+o.path,n(o,e)}(e,o.accessToken);var l=this.map._transformRequest(e,t.ResourceType.Style);t.getJSON(l,function(e,n){e?a.fire(new t.ErrorEvent(e)):n&&a._load(n,s)})},o.prototype.loadJSON=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),t.default$2.frame(function(){i._load(e,!1!==n.validate)})},o.prototype._load=function(e,n){var i=this;if(!n||!cn(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)i.addSource(r,e.sources[r],{validate:!1});e.sprite?function(e,n,i){function r(){if(s)i(s);else if(o&&a){var e=t.default$2.getImageData(a),n={};for(var r in o){var l=o[r],u=l.width,c=l.height,h=l.x,p=l.y,f=l.sdf,d=l.pixelRatio,m=new t.RGBAImage({width:u,height:c});t.RGBAImage.copy(e,m,{x:h,y:p},{x:0,y:0},{width:u,height:c}),n[r]={data:m,pixelRatio:d,sdf:f}}i(null,n)}}var o,a,s,l=t.default$2.devicePixelRatio>1?"@2x":"";t.getJSON(n(kt(e,l,".json"),t.ResourceType.SpriteJSON),function(t,e){s||(s=t,o=e,r())}),t.getImage(n(kt(e,l,".png"),t.ResourceType.SpriteImage),function(t,e){s||(s=t,a=e,r())})}(e.sprite,this.map._transformRequest,function(e,n){if(e)i.fire(new t.ErrorEvent(e));else if(n)for(var r in n)i.imageManager.addImage(r,n[r]);i.imageManager.setLoaded(!0),i.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=y(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var l=s[a];(l=t.default$20(l)).setEventedParent(i,{layer:{id:l.id}}),i._layers[l.id]=l}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Rt(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},o.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var i=e.sourceLayer;if(i){var r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+r.id+'" as specified by style layer "'+e.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(t){var e=this;return t.map(function(t){return e._layers[t].serialize()})},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(e){if(this._loaded){if(this._changed){var n=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var r in(n.length||i.length)&&this._updateWorkerLayers(n,i),this._updatedSources){var o=this._updatedSources[r];"reload"===o?this._reloadSource(r):"clear"===o&&this._clearSource(r)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];h.recalculate(e),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},o.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},o.prototype.setState=function(e){var n=this;if(this._checkLoaded(),cn(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=y(e.layers);var i=E(this.serialize(),e).filter(function(t){return!(t.command in pn)});if(0===i.length)return!1;var r=i.filter(function(t){return!(t.command in hn)});if(r.length>0)throw new Error("Unimplemented: "+r.map(function(t){return t.command}).join(", ")+".");return i.forEach(function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)}),this.stylesheet=e,!0},o.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this.fire(new t.Event("data",{dataType:"style"}))},o.prototype.getImage=function(t){return this.imageManager.getImage(t)},o.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(e,n,i){var r=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,i))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Re(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:r.loaded(),source:o.serialize(),sourceId:e}}),o.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},o.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},o.prototype.addLayer=function(e,n,i){this._checkLoaded();var r=e.id;if(this.getLayer(r))this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" already exists on this map')));else if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone(e),e=t.extend(e,{source:r})),!this._validate(t.validateStyle.layer,"layers."+r,e,{arrayIndex:-1},i)){var o=t.default$20(e);this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}});var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=o,this._removedLayers[r]&&o.source){var s=this._removedLayers[r];delete this._removedLayers[r],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o)}}},o.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var i=this._order.indexOf(e);this._order.splice(i,1);var r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(r,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e]}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(t){return this._layers[t]},o.prototype.setLayerZoomRange=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(e,n){this._checkLoaded();var i=this.getLayer(e);if(i){if(!t.default$13(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.validateStyle.filter,"layers."+i.id+".filter",n)||(i.filter=t.clone(n),this._updateLayer(i)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},o.prototype.setLayoutProperty=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?t.default$13(r.getLayoutProperty(n),i)||(r.setLayoutProperty(n,i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},o.prototype.setPaintProperty=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?t.default$13(r.getPaintProperty(n),i)||(r.setPaintProperty(n,i)&&this._updateLayer(r),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},o.prototype.setFeatureState=function(e,n){this._checkLoaded();var i=e.source,r=e.sourceLayer,o=this.sourceCaches[i];void 0!==o?"vector"!==o.getSource().type||r?o.setFeatureState(r,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))):this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,i=e.sourceLayer,r=this.sourceCaches[n];if(void 0!==r){if("vector"!==r.getSource().type||i)return r.getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){var e=this;return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._order.map(function(t){return e._layers[t].serialize()})},function(t){return void 0!==t})},o.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},o.prototype._flattenRenderedFeatures=function(t){for(var e=[],n=this._order.length-1;n>=0;n--)for(var i=this._order[n],r=0,o=t;r<o.length;r+=1){var a=o[r][i];if(a)for(var s=0,l=a;s<l.length;s+=1){var u=l[s];e.push(u)}}return e},o.prototype.queryRenderedFeatures=function(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter);var r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];r[l.source]=!0}}var u=[];for(var p in this.sourceCaches)n.layers&&!r[p]||u.push(c(this.sourceCaches[p],this._layers,e.worldCoordinate,n,i));return this.placement&&u.push(function(t,e,n,i,r,o){for(var a={},s=r.queryRenderedSymbols(n),l=[],u=0,c=Object.keys(s).map(Number);u<c.length;u+=1){var p=c[u];l.push(o[p])}l.sort(h);for(var f=0,d=l;f<d.length;f+=1)!function(){var e=d[f],n=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,i.filter,i.layers,t);for(var r in n){var o=a[r]=a[r]||[],l=n[r];l.sort(function(t,n){var i=e.featureSortOrder;if(i){var r=i.indexOf(t.featureIndex);return i.indexOf(n.featureIndex)-r}return n.featureIndex-t.featureIndex});for(var u=0,c=l;u<c.length;u+=1){var h=c[u];o.push(h.feature)}}}();for(var m in a)!function(n){a[n].forEach(function(i){var r=t[n],o=e[r.source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o})}(m);return a}(this._layers,this.sourceCaches,e.viewport,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},o.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter);var i=this.sourceCaches[e];return i?function(t,e){for(var n=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),i=[],r={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;r[s]||(r[s]=!0,a.querySourceFeatures(i,e))}return i}(i,n):[]},o.prototype.addSourceType=function(t,e,n){return o.getSourceType(t)?n(new Error('A source type called "'+t+'" already exists.')):(o.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},n):n(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(e){this._checkLoaded();var n=this.light.getLight(),i=!1;for(var r in e)if(!t.default$13(e[r],n[r])){i=!0;break}if(i){var o={now:t.default$2.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},o.prototype._validate=function(e,n,i,r,o){return(!o||!1!==o.validate)&&cn(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.default$7},r)))},o.prototype._remove=function(){for(var e in t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},o.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},o.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},o.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},o.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},o.prototype._updatePlacement=function(e,n,i,r){for(var o=!1,a=!1,s={},l=0,u=this._order;l<u.length;l+=1){var c=u[l],h=this._layers[c];if("symbol"===h.type){if(!s[h.source]){var p=this.sourceCaches[h.source];s[h.source]=p.getRenderableIds().map(function(t){return p.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var f=this.crossTileSymbolIndex.addLayer(h,s[h.source],e.center.lng);o=o||f}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.default$2.now()))&&(this.pauseablePlacement=new rn(e,this._order,d,n,i,r),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,t.default$2.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var m=0,y=this._order;m<y.length;m+=1){var g=y[m],v=this._layers[g];"symbol"===v.type&&this.placement.updateLayerOpacities(v,s[v.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.default$2.now())},o.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n)},o.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},o}(t.Evented);fn.getSourceType=function(t){return Ht[t]},fn.setSourceType=function(t,e){Ht[t]=e},fn.registerForPluginAvailability=t.registerForPluginAvailability;var dn=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),mn={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{
fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",
vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},yn=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;for(var gn in mn)!function(t){var e=mn[t],n={};e.fragmentSource=e.fragmentSource.replace(yn,function(t,e,i,r,o){return n[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(yn,function(t,e,i,r,o){var a="float"===r?"vec2":"vec4";return n[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = unpack_mix_"+a+"(a_"+o+", a_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"})}(gn);var vn=mn,_n=function(e,n,i,r){var o=e.gl;this.program=o.createProgram();var a=i.defines().concat("#define DEVICE_PIXEL_RATIO "+t.default$2.devicePixelRatio.toFixed(1));r&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(vn.prelude.fragmentSource,n.fragmentSource).join("\n"),l=a.concat(vn.prelude.vertexSource,n.vertexSource).join("\n"),u=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(u,s),o.compileShader(u),o.attachShader(this.program,u);var c=o.createShader(o.VERTEX_SHADER);o.shaderSource(c,l),o.compileShader(c),o.attachShader(this.program,c);for(var h=i.layoutAttributes||[],p=0;p<h.length;p++)o.bindAttribLocation(this.program,p,h[p].name);o.linkProgram(this.program),this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var f=0;f<this.numAttributes;f++){var d=o.getActiveAttrib(this.program,f);d&&(this.attributes[d.name]=o.getAttribLocation(this.program,d.name))}for(var m=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS),y=0;y<m;y++){var g=o.getActiveUniform(this.program,y);g&&(this.uniforms[g.name]=o.getUniformLocation(this.program,g.name))}};_n.prototype.draw=function(t,e,n,i,r,o,a,s,l){for(var u,c=t.gl,h=(u={},u[c.LINES]=2,u[c.TRIANGLES]=3,u)[e],p=0,f=o.get();p<f.length;p+=1){var d=f[p],m=d.vaos||(d.vaos={});(m[n]||(m[n]=new Zt)).bind(t,this,i,a?a.getPaintVertexBuffers():[],r,d.vertexOffset,s,l),c.drawElements(e,d.primitiveLength*h,c.UNSIGNED_SHORT,d.primitiveOffset*h*2)}};var xn=t.identity(new Float32Array(16)),bn=t.default$18.layout,wn=function(t,e){if(!t)return!1;var n=e.imageManager.getPattern(t.from),i=e.imageManager.getPattern(t.to);return!n||!i},Sn=function(t,e,n){var i=e.context,r=i.gl,o=e.imageManager.getPattern(t.from),a=e.imageManager.getPattern(t.to);r.uniform1i(n.uniforms.u_image,0),r.uniform2fv(n.uniforms.u_pattern_tl_a,o.tl),r.uniform2fv(n.uniforms.u_pattern_br_a,o.br),r.uniform2fv(n.uniforms.u_pattern_tl_b,a.tl),r.uniform2fv(n.uniforms.u_pattern_br_b,a.br);var s=e.imageManager.getPixelSize(),l=s.width,u=s.height;r.uniform2fv(n.uniforms.u_texsize,[l,u]),r.uniform1f(n.uniforms.u_mix,t.t),r.uniform2fv(n.uniforms.u_pattern_size_a,o.displaySize),r.uniform2fv(n.uniforms.u_pattern_size_b,a.displaySize),r.uniform1f(n.uniforms.u_scale_a,t.fromScale),r.uniform1f(n.uniforms.u_scale_b,t.toScale),i.activeTexture.set(r.TEXTURE0),e.imageManager.bind(e.context)},En=function(t,e,n){var i=e.context.gl;i.uniform1f(n.uniforms.u_tile_units_to_pixels,1/F(t,1,e.transform.tileZoom));var r=Math.pow(2,t.tileID.overscaledZ),o=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=o*(t.tileID.canonical.x+t.tileID.wrap*r),s=o*t.tileID.canonical.y;i.uniform2f(n.uniforms.u_pixel_coord_upper,a>>16,s>>16),i.uniform2f(n.uniforms.u_pixel_coord_lower,65535&a,65535&s)},kn={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],
z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},Tn={symbol:function(t,e,n,i){if("translucent"===t.renderPass){var r=t.context;r.setStencilMode(Pe.disabled),r.setColorMode(t.colorModeForRenderPass()),0!==n.paint.get("icon-opacity").constantOr(1)&&q(t,e,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright")),0!==n.paint.get("text-opacity").constantOr(1)&&q(t,e,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright")),e.map.showCollisionBoxes&&function(t,e,n,i){$(t,e,n,i,!1),$(t,e,n,i,!0)}(t,e,n,i)}},circle:function(t,e,n,i){if("translucent"===t.renderPass){var r=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity");if(0!==r.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=t.context,l=s.gl;s.setDepthMode(t.depthModeForSublayer(0,Me.ReadOnly)),s.setStencilMode(Pe.disabled),s.setColorMode(t.colorModeForRenderPass());for(var u=!0,c=0;c<i.length;c++){var h=i[c],p=e.getTile(h),f=p.getBucket(n);if(f){var d=t.context.program.get(),m=f.programConfigurations.get(n.id),y=t.useProgram("circle",m);if((u||y.program!==d)&&(m.setUniforms(s,y,n.paint,{zoom:t.transform.zoom}),u=!1),l.uniform1f(y.uniforms.u_camera_to_center_distance,t.transform.cameraToCenterDistance),l.uniform1i(y.uniforms.u_scale_with_map,"map"===n.paint.get("circle-pitch-scale")?1:0),"map"===n.paint.get("circle-pitch-alignment")){l.uniform1i(y.uniforms.u_pitch_with_map,1);var g=F(p,1,t.transform.zoom);l.uniform2f(y.uniforms.u_extrude_scale,g,g)}else l.uniform1i(y.uniforms.u_pitch_with_map,0),l.uniform2fv(y.uniforms.u_extrude_scale,t.transform.pixelsToGLUnits);l.uniformMatrix4fv(y.uniforms.u_matrix,!1,t.translatePosMatrix(h.posMatrix,p,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor"))),y.draw(s,l.TRIANGLES,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,m)}}}}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl;o.setDepthMode(e.depthModeForSublayer(0,Me.ReadOnly)),o.setStencilMode(Pe.disabled),function(t,e,n){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{var o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4),function t(e,n,i,r){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),r.colorAttachment.set(i),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,r.colorAttachment.setDirty(),t(e,n,i,r))}(t,e,o,r)}}(o,e,i),o.clear({color:t.default$8.transparent}),o.setColorMode(new Le([a.ONE,a.ONE],t.default$8.transparent,[!0,!0,!0,!0]));for(var s=!0,l=0;l<r.length;l++){var u=r[l];if(!n.hasRenderableParent(u)){var c=n.getTile(u),h=c.getBucket(i);if(h){var p=e.context.program.get(),f=h.programConfigurations.get(i.id),d=e.useProgram("heatmap",f),m=e.transform.zoom;(s||d.program!==p)&&(f.setUniforms(e.context,d,i.paint,{zoom:m}),s=!1),a.uniform1f(d.uniforms.u_extrude_scale,F(c,1,m)),a.uniform1f(d.uniforms.u_intensity,i.paint.get("heatmap-intensity")),a.uniformMatrix4fv(d.uniforms.u_matrix,!1,u.posMatrix),d.draw(o,a.TRIANGLES,i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,f)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var i=e.context,r=i.gl,o=n.heatmapFbo;if(o){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.default$4(i,n.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),i.setDepthMode(Me.disabled),i.setStencilMode(Pe.disabled);var s=e.useProgram("heatmapTexture"),l=n.paint.get("heatmap-opacity");r.uniform1f(s.uniforms.u_opacity,l),r.uniform1i(s.uniforms.u_image,0),r.uniform1i(s.uniforms.u_color_ramp,1);var u=t.create();t.ortho(u,0,e.width,e.height,0,0,1),r.uniformMatrix4fv(s.uniforms.u_matrix,!1,u),r.uniform2f(s.uniforms.u_world,r.drawingBufferWidth,r.drawingBufferHeight),e.viewportVAO.bind(e.context,s,e.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)}}(e,i))},line:function(t,e,n,i){if("translucent"===t.renderPass){var r=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0!==r.constantOr(1)&&0!==o.constantOr(1)){var a=t.context;a.setDepthMode(t.depthModeForSublayer(0,Me.ReadOnly)),a.setColorMode(t.colorModeForRenderPass());for(var s,l=n.paint.get("line-dasharray")?"lineSDF":n.paint.get("line-pattern")?"linePattern":n.paint.get("line-gradient")?"lineGradient":"line",u=!0,c=0,h=i;c<h.length;c+=1){var p=h[c],f=e.getTile(p),d=f.getBucket(n);if(d){var m=d.programConfigurations.get(n.id),y=t.context.program.get(),g=t.useProgram(l,m),v=u||g.program!==y,_=s!==f.tileID.overscaledZ;v&&m.setUniforms(t.context,g,n.paint,{zoom:t.transform.zoom}),W(g,t,f,d,n,p,m,v,_),s=f.tileID.overscaledZ,u=!1}}}}},fill:function(e,n,i,r){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.context;s.setColorMode(e.colorModeForRenderPass());var l=i.paint.get("fill-pattern")||1!==o.constantOr(t.default$8.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===l&&(s.setDepthMode(e.depthModeForSublayer(1,"opaque"===e.renderPass?Me.ReadWrite:Me.ReadOnly)),X(e,n,i,r,H)),"translucent"===e.renderPass&&i.paint.get("fill-antialias")&&(s.setDepthMode(e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Me.ReadOnly)),X(e,n,i,r,K))}},"fill-extrusion":function(e,n,i,r){if(0!==i.paint.get("fill-extrusion-opacity"))if("offscreen"===e.renderPass){!function(e,n){var i=e.context,r=i.gl,o=n.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new t.default$4(i,{width:e.width,height:e.height,data:null},r.RGBA);a.bind(r.LINEAR,r.CLAMP_TO_EDGE),(o=n.viewportFrame=i.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}i.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(i.clear({depth:1}),e.depthRboNeedsClear=!1),i.clear({color:t.default$8.transparent}),i.setStencilMode(Pe.disabled),i.setDepthMode(new Me(r.LEQUAL,Me.ReadWrite,[0,1])),i.setColorMode(e.colorModeForRenderPass())}(e,i);for(var o=!0,a=0,s=r;a<s.length;a+=1){var l=s[a],u=n.getTile(l),c=u.getBucket(i);c&&(Y(e,0,i,u,l,c,o),o=!1)}}else"translucent"===e.renderPass&&function(e,n){var i=n.viewportFrame;if(i){var r=e.context,o=r.gl,a=e.useProgram("extrusionTexture");r.setStencilMode(Pe.disabled),r.setDepthMode(Me.disabled),r.setColorMode(e.colorModeForRenderPass()),r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i.colorAttachment.get()),o.uniform1f(a.uniforms.u_opacity,n.paint.get("fill-extrusion-opacity")),o.uniform1i(a.uniforms.u_image,0);var s=t.create();t.ortho(s,0,e.width,e.height,0,0,1),o.uniformMatrix4fv(a.uniforms.u_matrix,!1,s),o.uniform2f(a.uniforms.u_world,o.drawingBufferWidth,o.drawingBufferHeight),e.viewportVAO.bind(r,a,e.viewportBuffer,[]),o.drawArrays(o.TRIANGLE_STRIP,0,4)}}(e,i)},hillshade:function(t,e,n,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var r=t.context,o=e.getSource().maxzoom;r.setDepthMode(t.depthModeForSublayer(0,Me.ReadOnly)),r.setStencilMode(Pe.disabled),r.setColorMode(t.colorModeForRenderPass());for(var a=0,s=i;a<s.length;a+=1){var l=s[a],u=e.getTile(l);u.needsHillshadePrepare&&"offscreen"===t.renderPass?tt(t,u,o):"translucent"===t.renderPass&&Q(t,u,n)}r.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,i){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")){var r,o,a=t.context,s=a.gl,l=e.getSource(),u=t.useProgram("raster");a.setStencilMode(Pe.disabled),a.setColorMode(t.colorModeForRenderPass()),s.uniform1f(u.uniforms.u_brightness_low,n.paint.get("raster-brightness-min")),s.uniform1f(u.uniforms.u_brightness_high,n.paint.get("raster-brightness-max")),s.uniform1f(u.uniforms.u_saturation_factor,(r=n.paint.get("raster-saturation"))>0?1-1/(1.001-r):-r),s.uniform1f(u.uniforms.u_contrast_factor,(o=n.paint.get("raster-contrast"))>0?1/(1-o):1+o),s.uniform3fv(u.uniforms.u_spin_weights,function(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}(n.paint.get("raster-hue-rotate"))),s.uniform1f(u.uniforms.u_buffer_scale,1),s.uniform1i(u.uniforms.u_image0,0),s.uniform1i(u.uniforms.u_image1,1);for(var c=i.length&&i[0].overscaledZ,h=0,p=i;h<p.length;h+=1){var f=p[h];a.setDepthMode(t.depthModeForSublayer(f.overscaledZ-c,1===n.paint.get("raster-opacity")?Me.ReadWrite:Me.ReadOnly,s.LESS));var d=e.getTile(f),m=t.transform.calculatePosMatrix(f.toUnwrapped(),!0);d.registerFadeDuration(n.paint.get("raster-fade-duration")),s.uniformMatrix4fv(u.uniforms.u_matrix,!1,m);var y=e.findLoadedParent(f,0,{}),g=et(d,y,e,n,t.transform),v=void 0,_=void 0;if(a.activeTexture.set(s.TEXTURE0),d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.activeTexture.set(s.TEXTURE1),y?(y.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),v=Math.pow(2,y.tileID.overscaledZ-d.tileID.overscaledZ),_=[d.tileID.canonical.x*v%1,d.tileID.canonical.y*v%1]):d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),s.uniform2fv(u.uniforms.u_tl_parent,_||[0,0]),s.uniform1f(u.uniforms.u_scale_parent,v||1),s.uniform1f(u.uniforms.u_fade_t,g.mix),s.uniform1f(u.uniforms.u_opacity,g.opacity*n.paint.get("raster-opacity")),l instanceof Gt){var x=l.boundsBuffer;l.boundsVAO.bind(a,u,x,[]),s.drawArrays(s.TRIANGLE_STRIP,0,x.length)}else if(d.maskedBoundsBuffer&&d.maskedIndexBuffer&&d.segments)u.draw(a,s.TRIANGLES,n.id,d.maskedBoundsBuffer,d.maskedIndexBuffer,d.segments);else{var b=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(a,u,b,[]),s.drawArrays(s.TRIANGLE_STRIP,0,b.length)}}}},background:function(t,e,n){var i=n.paint.get("background-color"),r=n.paint.get("background-opacity");if(0!==r){var o=t.context,a=o.gl,s=t.transform,l=s.tileSize,u=n.paint.get("background-pattern"),c=u||1!==i.a||1!==r?"translucent":"opaque";if(t.renderPass===c){var h;if(o.setStencilMode(Pe.disabled),o.setDepthMode(t.depthModeForSublayer(0,"opaque"===c?Me.ReadWrite:Me.ReadOnly)),o.setColorMode(t.colorModeForRenderPass()),u){if(wn(u,t))return;h=t.useProgram("backgroundPattern"),Sn(u,t,h),t.tileExtentPatternVAO.bind(o,h,t.tileExtentBuffer,[])}else h=t.useProgram("background"),a.uniform4fv(h.uniforms.u_color,[i.r,i.g,i.b,i.a]),t.tileExtentVAO.bind(o,h,t.tileExtentBuffer,[]);a.uniform1f(h.uniforms.u_opacity,r);for(var p=0,f=s.coveringTiles({tileSize:l});p<f.length;p+=1){var d=f[p];u&&En({tileID:d,tileSize:l},t,h),a.uniformMatrix4fv(h.uniforms.u_matrix,!1,t.transform.calculatePosMatrix(d.toUnwrapped())),a.drawArrays(a.TRIANGLE_STRIP,0,t.tileExtentBuffer.length)}}}},debug:function(t,e,n){for(var i=0;i<n.length;i++)nt(t,e,n[i])}},An=function(e,n){this.context=new De(e),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Re.maxUnderzooming+Re.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.default$22,this.crossTileSymbolIndex=new un};An.prototype.resize=function(e,n){var i=this.context.gl;if(this.width=e*t.default$2.devicePixelRatio,this.height=n*t.default$2.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var r=0,o=this.style._order;r<o.length;r+=1){var a=o[r];this.style._layers[a].resize()}this.depthRbo&&(i.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},An.prototype.setup=function(){var e=this.context,n=new t.PosArray;n.emplaceBack(0,0),n.emplaceBack(t.default$10,0),n.emplaceBack(0,t.default$10),n.emplaceBack(t.default$10,t.default$10),this.tileExtentBuffer=e.createVertexBuffer(n,dn.members),this.tileExtentVAO=new Zt,this.tileExtentPatternVAO=new Zt;var i=new t.PosArray;i.emplaceBack(0,0),i.emplaceBack(t.default$10,0),i.emplaceBack(t.default$10,t.default$10),i.emplaceBack(0,t.default$10),i.emplaceBack(0,0),this.debugBuffer=e.createVertexBuffer(i,dn.members),this.debugVAO=new Zt;var r=new t.RasterBoundsArray;r.emplaceBack(0,0,0,0),r.emplaceBack(t.default$10,0,t.default$10,0),r.emplaceBack(0,t.default$10,0,t.default$10),r.emplaceBack(t.default$10,t.default$10,t.default$10,t.default$10),this.rasterBoundsBuffer=e.createVertexBuffer(r,t.default$11.members),this.rasterBoundsVAO=new Zt;var o=new t.PosArray;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,dn.members),this.viewportVAO=new Zt},An.prototype.clearStencil=function(){var e=this.context,n=e.gl;e.setColorMode(Le.disabled),e.setDepthMode(Me.disabled),e.setStencilMode(new Pe({func:n.ALWAYS,mask:0},0,255,n.ZERO,n.ZERO,n.ZERO));var i=t.create();t.ortho(i,0,this.width,this.height,0,0,1),t.scale(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]);var r=this.useProgram("clippingMask");n.uniformMatrix4fv(r.uniforms.u_matrix,!1,i),this.viewportVAO.bind(e,r,this.viewportBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,4)},An.prototype._renderTileClippingMasks=function(t){var e=this.context,n=e.gl;e.setColorMode(Le.disabled),e.setDepthMode(Me.disabled);var i=1;this._tileClippingMaskIDs={};for(var r=0,o=t;r<o.length;r+=1){var a=o[r],s=this._tileClippingMaskIDs[a.key]=i++;e.setStencilMode(new Pe({func:n.ALWAYS,mask:0},s,255,n.KEEP,n.KEEP,n.REPLACE));var l=this.useProgram("clippingMask");n.uniformMatrix4fv(l.uniforms.u_matrix,!1,a.posMatrix),this.tileExtentVAO.bind(this.context,l,this.tileExtentBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},An.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Pe({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},An.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Le([e.CONSTANT_COLOR,e.ONE],new t.default$8(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Le.unblended:Le.alphaBlended},An.prototype.depthModeForSublayer=function(t,e,n){var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,r=i-1+this.depthRange;return new Me(n||this.context.gl.LEQUAL,e,[r,i])},An.prototype.render=function(e,n){var i=this;for(var r in this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.default$2.now()),e.sourceCaches){var o=i.style.sourceCaches[r];o.used&&o.prepare(i.context)}var a=this.style._order,s=t.filterObject(this.style.sourceCaches,function(t){return"raster"===t.getSource().type||"raster-dem"===t.getSource().type});for(var l in s)!function(e){var n=s[e];!function(e,n){for(var i=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),r=0;r<i.length;r++){var o={},a=i[r],s=i.slice(r+1);j(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,n)}}(n.getVisibleCoordinates().map(function(t){return n.getTile(t)}),i.context)}(l);this.renderPass="offscreen";var u,c=[];this.depthRboNeedsClear=!0;for(var h=0;h<a.length;h++){var p=i.style._layers[a[h]];p.hasOffscreenPass()&&!p.isHidden(i.transform.zoom)&&(p.source!==(u&&u.id)&&(c=[],(u=i.style.sourceCaches[p.source])&&(c=u.getVisibleCoordinates()).reverse()),c.length&&i.renderLayer(i,u,p,c))}this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.default$8.black:t.default$8.transparent,depth:1}),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var f,d=[];for(this.currentLayer=a.length-1,this.currentLayer;this.currentLayer>=0;this.currentLayer--){var m=i.style._layers[a[i.currentLayer]];m.source!==(f&&f.id)&&(d=[],(f=i.style.sourceCaches[m.source])&&(i.clearStencil(),d=f.getVisibleCoordinates(),f.getSource().isTileClipped&&i._renderTileClippingMasks(d))),i.renderLayer(i,f,m,d)}this.renderPass="translucent";var y,g=[];for(this.currentLayer=0,this.currentLayer;this.currentLayer<a.length;this.currentLayer++){var v=i.style._layers[a[i.currentLayer]];v.source!==(y&&y.id)&&(g=[],(y=i.style.sourceCaches[v.source])&&(i.clearStencil(),g=y.getVisibleCoordinates(),y.getSource().isTileClipped&&i._renderTileClippingMasks(g)),g.reverse()),i.renderLayer(i,y,v,g)}if(this.options.showTileBoundaries){var _=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];_&&Tn.debug(this,_,_.getVisibleCoordinates())}},An.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},An.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||i.length)&&(this.id=n.id,Tn[n.type](t,e,n,i))},An.prototype.translatePosMatrix=function(e,n,i,r,o){if(!i[0]&&!i[1])return e;var a=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var u=[o?i[0]:F(n,i[0],this.transform.zoom),o?i[1]:F(n,i[1],this.transform.zoom),0],c=new Float32Array(16);return t.translate(c,e,u),c},An.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},An.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},An.prototype._createProgramCached=function(t,e){this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new _n(this.context,vn[t],e,this._showOverdrawInspector)),this.cache[n]},An.prototype.useProgram=function(t,e){var n=this._createProgramCached(t,e||this.emptyProgramConfiguration);return this.context.program.set(n.program),n};var In=function(t,e,n){this.tileSize=512,this._renderWorldCopies=void 0===n||n,this._minZoom=t||0,this._maxZoom=e||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new Ft(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},zn={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};In.prototype.clone=function(){var t=new In(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},zn.minZoom.get=function(){return this._minZoom},zn.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},zn.maxZoom.get=function(){return this._maxZoom},zn.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},zn.renderWorldCopies.get=function(){return this._renderWorldCopies},zn.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},zn.worldSize.get=function(){return this.tileSize*this.scale},zn.centerPoint.get=function(){return this.size._div(2)},zn.size.get=function(){return new t.default(this.width,this.height)},zn.bearing.get=function(){return-this.angle/Math.PI*180},zn.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$4(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},zn.pitch.get=function(){return this._pitch/Math.PI*180},zn.pitch.set=function(e){var n=t.clamp(e,0,60)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},zn.fov.get=function(){return this._fov/Math.PI*180},zn.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},zn.zoom.get=function(){return this._zoom},zn.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},zn.center.get=function(){return this._center},zn.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},In.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},In.prototype.getVisibleUnwrappedCoordinates=function(e){var n=this.pointCoordinate(new t.default(0,0),0),i=this.pointCoordinate(new t.default(this.width,0),0),r=Math.floor(n.column),o=Math.floor(i.column),a=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var s=r;s<=o;s++)0!==s&&a.push(new t.UnwrappedTileID(s,e));return a},In.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),i=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var r=this.pointCoordinate(this.centerPoint,n),o=new t.default(r.column-.5,r.row-.5);return function(e,n,i,r){function o(n,o,l){var u,c,h,p;if(l>=0&&l<=a)for(u=n;u<o;u++)c=Math.floor(u/a),h=(u%a+a)%a,0!==c&&!0!==r||(p=new t.OverscaledTileID(i,c,e,h,l),s[p.key]=p)}void 0===r&&(r=!0);var a=1<<e,s={};return ot(n[0],n[1],n[2],0,a,o),ot(n[2],n[3],n[0],0,a,o),Object.keys(s).map(function(t){return s[t]})}(n,[this.pointCoordinate(new t.default(0,0),n),this.pointCoordinate(new t.default(this.width,0),n),this.pointCoordinate(new t.default(this.width,this.height),n),this.pointCoordinate(new t.default(0,this.height),n)],e.reparseOverscaled?i:n,this._renderWorldCopies).sort(function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)})},In.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},zn.unmodified.get=function(){return this._unmodified},In.prototype.zoomScale=function(t){return Math.pow(2,t)},In.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},In.prototype.project=function(e){return new t.default(this.lngX(e.lng),this.latY(e.lat))},In.prototype.unproject=function(t){return new Ft(this.xLng(t.x),this.yLat(t.y))},zn.x.get=function(){return this.lngX(this.center.lng)},zn.y.get=function(){return this.latY(this.center.lat)},zn.point.get=function(){return new t.default(this.x,this.y)},In.prototype.lngX=function(t){return(180+t)*this.worldSize/360},In.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},In.prototype.xLng=function(t){return 360*t/this.worldSize-180},In.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},In.prototype.setLocationAtPoint=function(t,e){var n=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(n)),this._renderWorldCopies&&(this.center=this.center.wrap())},In.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},In.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},In.prototype.locationCoordinate=function(e){return new t.default$15(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},In.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new Ft(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},In.prototype.pointCoordinate=function(e,n){void 0===n&&(n=this.tileZoom);var i=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var o=i[3],a=r[3],s=i[0]/o,l=r[0]/a,u=i[1]/o,c=r[1]/a,h=i[2]/o,p=r[2]/a,f=h===p?0:(0-h)/(p-h);return new t.default$15(t.number(s,l,f)/this.tileSize,t.number(u,c,f)/this.tileSize,this.zoom)._zoomTo(n)},In.prototype.coordinatePoint=function(e){var n=e.zoomTo(this.zoom),i=[n.column*this.tileSize,n.row*this.tileSize,0,1];return t.transformMat4(i,i,this.pixelMatrix),new t.default(i[0]/i[3],i[1]/i[3])},In.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.default$10,a/t.default$10,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),r[i]=new Float32Array(l),r[i]},In.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,i,r,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;o=this.latY(h[1]),e=(a=this.latY(h[0]))-o<u.y?u.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=this.lngX(p[0]),n=(l=this.lngX(p[1]))-s<u.x?u.x/(l-s):0}var f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.default(n?(l+s)/2:this.x,e?(a+o)/2:this.y)),this.zoom+=this.scaleZoom(f),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,m=u.y/2;d-m<o&&(r=o+m),d+m>a&&(r=a-m)}if(this.lngRange){var y=this.x,g=u.x/2;y-g<s&&(i=s+g),y+g>l&&(i=l-g)}void 0===i&&void 0===r||(this.center=this.unproject(new t.default(void 0!==i?i:this.x,void 0!==r?r:this.y))),this._unmodified=c,this._constraining=!1}},In.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,n=Math.PI/2+this._pitch,i=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-n-e),r=this.x,o=this.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*i+this.cameraToCenterDistance),s=new Float64Array(16);t.perspective(s,this._fov,this.width/this.height,1,a),t.scale(s,s,[1,-1,1]),t.translate(s,s,[0,0,-this.cameraToCenterDistance]),t.rotateX(s,s,this._pitch),t.rotateZ(s,s,this.angle),t.translate(s,s,[-r,-o,0]);var l=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));t.scale(s,s,[1,1,l,1]),this.projMatrix=s;var u=this.width%2/2,c=this.height%2/2,h=Math.cos(this.angle),p=Math.sin(this.angle),f=r-Math.round(r)+h*u+p*c,d=o-Math.round(o)+h*c+p*u,m=new Float64Array(s);if(t.translate(m,m,[f>.5?f-1:f,d>.5?d-1:d,0]),this.alignedProjMatrix=m,s=t.create(),t.scale(s,s,[this.width/2,-this.height/2,1]),t.translate(s,s,[1,-1,0]),this.pixelMatrix=t.multiply(new Float64Array(16),s,this.projMatrix),!(s=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=s,this._posMatrixCache={},this._alignedPosMatrixCache={}}},In.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.default(0,0)).zoomTo(this.zoom),n=[e.column*this.tileSize,e.row*this.tileSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(In.prototype,zn);var Cn=function(){var e,n,i,r,o;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),n=300,i=!1,r=0,o=function(){r=0,i&&(e(),r=setTimeout(o,n),i=!1)},function(){return i=!0,r||o(),r})};Cn.prototype.addTo=function(e){return this._map=e,t.default$1.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Cn.prototype.remove=function(){return t.default$1.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Cn.prototype.getHashString=function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,i),o=Math.round(e.lng*r)/r,a=Math.round(e.lat*r)/r,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=t?"#/"+o+"/"+a+"/"+n:"#"+n+"/"+a+"/"+o,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},Cn.prototype._onHashChange=function(){var e=t.default$1.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},Cn.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.default$1.history.replaceState(t.default$1.history.state,"",e)};var Mn=function(e){function n(n,i,r,o){void 0===o&&(o={});var a=dt.mousePos(i.getCanvasContainer(),r),s=i.unproject(a);e.call(this,n,t.extend({point:a,lngLat:s,originalEvent:r},o)),this._defaultPrevented=!1,this.target=i}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),Pn=function(e){function n(n,i,r){var o=dt.touchPos(i.getCanvasContainer(),r),a=o.map(function(t){return i.unproject(t)}),s=o.reduce(function(t,e,n,i){return t.add(e.div(i.length))},new t.default(0,0)),l=i.unproject(s);e.call(this,n,{points:o,point:s,lngLats:a,lngLat:l,originalEvent:r}),this._defaultPrevented=!1}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(t.Event),Ln=function(t){function e(e,n,i){t.call(this,e,{originalEvent:i}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),Dn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Dn.prototype.isEnabled=function(){return!!this._enabled},Dn.prototype.isActive=function(){return!!this._active},Dn.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},Dn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Dn.prototype.onWheel=function(e){if(this.isEnabled()){
var n=e.deltaMode===t.default$1.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,i=t.default$2.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this.isActive()||this._start(e)),e.preventDefault()}},Dn.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},Dn.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var n=dt.mousePos(this._el,e);this._around=Ft.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Dn.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==r&&(r=1/r);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*r))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a=!1;if("wheel"===this._type){var s=Math.min((t.default$2.now()-this._lastWheelEventTime)/200,1),l=this._easing(s);n.zoom=t.number(this._startZoom,this._targetZoom,l),s<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):a=!0}else n.zoom=this._targetZoom,a=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),a&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},Dn.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var i=this._prevEase,r=(t.default$2.now()-i.start)/i.duration,o=i.easing(r+.01)-i.easing(r),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.default$2.now(),duration:e,easing:n},n};var Rn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Rn.prototype.isEnabled=function(){return!!this._enabled},Rn.prototype.isActive=function(){return!!this._active},Rn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Rn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Rn.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.default$1.document.addEventListener("mousemove",this._onMouseMove,!1),t.default$1.document.addEventListener("keydown",this._onKeyDown,!1),t.default$1.document.addEventListener("mouseup",this._onMouseUp,!1),dt.disableDrag(),this._startPos=this._lastPos=dt.mousePos(this._el,e),this._active=!0)},Rn.prototype._onMouseMove=function(t){var e=dt.mousePos(this._el,t);if(!this._lastPos.equals(e)){var n=this._startPos;this._lastPos=e,this._box||(this._box=dt.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(n.x,e.x),r=Math.max(n.x,e.x),o=Math.min(n.y,e.y),a=Math.max(n.y,e.y);dt.setTransform(this._box,"translate("+i+"px,"+o+"px)"),this._box.style.width=r-i+"px",this._box.style.height=a-o+"px"}},Rn.prototype._onMouseUp=function(e){if(0===e.button){var n=this._startPos,i=dt.mousePos(this._el,e),r=(new Vt).extend(this._map.unproject(n)).extend(this._map.unproject(i));this._finish(),dt.suppressClick(),n.x===i.x&&n.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitBounds(r,{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e,boxZoomBounds:r}))}},Rn.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},Rn.prototype._finish=function(){this._active=!1,t.default$1.document.removeEventListener("mousemove",this._onMouseMove,!1),t.default$1.document.removeEventListener("keydown",this._onKeyDown,!1),t.default$1.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(dt.remove(this._box),this._box=null),dt.enableDrag(),delete this._startPos,delete this._lastPos},Rn.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Bn=t.bezier(0,0,.25,1),On=function(e,n){this._map=e,this._el=n.element||e.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};On.prototype.isEnabled=function(){return"disabled"!==this._state},On.prototype.isActive=function(){return"active"===this._state},On.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},On.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},On.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=dt.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==dt.mouseButton(e))return;this._eventButton=0}dt.disableDrag(),t.default$1.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default$1.document.addEventListener("mouseup",this._onMouseUp),t.default$1.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.default$2.now(),this._map.getBearing()]],this._startPos=this._lastPos=dt.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},On.prototype._onMouseMove=function(t){var e=dt.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},On.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var n=this._map.transform,i=this._startPos,r=this._lastPos,o=.8*(i.x-r.x),a=-.5*(i.y-r.y),s=n.bearing-o,l=n.pitch-a,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([t.default$2.now(),this._map._normalizeBearing(s,c[1])]),n.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),n.pitch=l),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._startPos=this._lastPos}},On.prototype._onMouseUp=function(t){if(dt.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",dt.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},On.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},On.prototype._unbind=function(){t.default$1.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.default$1.document.removeEventListener("mouseup",this._onMouseUp),t.default$1.removeEventListener("blur",this._onBlur),dt.enableDrag()},On.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},On.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,i=n.getBearing(),r=this._inertia,o=function(){Math.abs(i)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(r.length<2)o();else{var a=r[0],s=r[r.length-1],l=r[r.length-2],u=n._normalizeBearing(i,l[1]),c=s[1]-a[1],h=c<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==c&&0!==p){var f=Math.abs(c*(.25/p));f>180&&(f=180);var d=f/180;u+=h*f*(d/2),Math.abs(n._normalizeBearing(u,0))<this._bearingSnap&&(u=n._normalizeBearing(0,u)),n.rotateTo(u,{duration:1e3*d,easing:Bn,noMoveStart:!0},{originalEvent:t})}else o()}},On.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},On.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.default$2.now();e.length>0&&n-e[0][0]>160;)e.shift()};var Fn=t.bezier(0,0,.3,1),Vn=function(e){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Vn.prototype.isEnabled=function(){return"disabled"!==this._state},Vn.prototype.isActive=function(){return"active"===this._state},Vn.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Vn.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Vn.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==dt.mouseButton(e)||(dt.addEventListener(t.default$1.document,"mousemove",this._onMove,{capture:!0}),dt.addEventListener(t.default$1.document,"mouseup",this._onMouseUp),this._start(e)))},Vn.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(dt.addEventListener(t.default$1.document,"touchmove",this._onMove,{capture:!0,passive:!1}),dt.addEventListener(t.default$1.document,"touchend",this._onTouchEnd),this._start(e)))},Vn.prototype._start=function(e){t.default$1.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._lastPos=dt.mousePos(this._el,e),this._inertia=[[t.default$2.now(),this._startPos]]},Vn.prototype._onMove=function(e){e.preventDefault();var n=dt.mousePos(this._el,e);this._lastPos.equals(n)||(this._lastMoveEvent=e,this._lastPos=n,this._drainInertiaBuffer(),this._inertia.push([t.default$2.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Vn.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._startPos=this._lastPos,delete this._lastMoveEvent}},Vn.prototype._onMouseUp=function(t){if(0===dt.mouseButton(t))switch(this._state){case"active":this._state="enabled",dt.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Vn.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},Vn.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},Vn.prototype._unbind=function(){dt.removeEventListener(t.default$1.document,"touchmove",this._onMove,{capture:!0,passive:!1}),dt.removeEventListener(t.default$1.document,"touchend",this._onTouchEnd),dt.removeEventListener(t.default$1.document,"mousemove",this._onMove,{capture:!0}),dt.removeEventListener(t.default$1.document,"mouseup",this._onMouseUp),dt.removeEventListener(t.default$1,"blur",this._onBlur)},Vn.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},Vn.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var n=e[e.length-1],i=e[0],r=n[1].sub(i[1]),o=(n[0]-i[0])/1e3;if(0===o||n[1].equals(i[1]))this._fireEvent("moveend",t);else{var a=r.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var l=s/750,u=a.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:Fn,noMoveStart:!0},{originalEvent:t})}}},Vn.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},Vn.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.default$2.now();e.length>0&&n-e[0][0]>160;)e.shift()};var Nn=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};Nn.prototype.isEnabled=function(){return!!this._enabled},Nn.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Nn.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Nn.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,i=0,r=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?i=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),l={duration:300,delayEndEvents:500,easing:at,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*i,offset:[100*-r,100*-o],center:a.getCenter()};a.easeTo(l,{originalEvent:t})}};var jn=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};jn.prototype.isEnabled=function(){return!!this._enabled},jn.prototype.isActive=function(){return!!this._active},jn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},jn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},jn.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},jn.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},jn.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},jn.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var $n=t.bezier(0,0,.15,1),qn=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};qn.prototype.isEnabled=function(){return!!this._enabled},qn.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},qn.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},qn.prototype.disableRotation=function(){this._rotationDisabled=!0},qn.prototype.enableRotation=function(){this._rotationDisabled=!1},qn.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var n=dt.mousePos(this._el,e.touches[0]),i=dt.mousePos(this._el,e.touches[1]);this._startVec=n.sub(i),this._gestureIntent=void 0,this._inertia=[],dt.addEventListener(t.default$1.document,"touchmove",this._onMove,{passive:!1}),dt.addEventListener(t.default$1.document,"touchend",this._onEnd)}},qn.prototype._getTouchEventData=function(t){var e=dt.mousePos(this._el,t.touches[0]),n=dt.mousePos(this._el,t.touches[1]),i=e.sub(n);return{vec:i,center:e.add(n).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},qn.prototype._onMove=function(e){if(2===e.touches.length){var n=this._getTouchEventData(e),i=n.vec,r=n.scale,o=n.bearing;if(!this._gestureIntent){var a=Math.abs(1-r)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=i)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},qn.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var i=this._getTouchEventData(this._lastTouchEvent),r=i.center,o=i.bearing,a=i.scale,s=n.pointLocation(r),l=n.locationPoint(s);"rotate"===e&&(n.bearing=this._startBearing+o),n.zoom=n.scaleZoom(this._startScale*a),n.setLocationAtPoint(s,l),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.default$2.now(),a,r])}},qn.prototype._onEnd=function(e){dt.removeEventListener(t.default$1.document,"touchmove",this._onMove,{passive:!1}),dt.removeEventListener(t.default$1.document,"touchend",this._onEnd);var n=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,n){this._map.fire(new t.Event(n+"end",{originalEvent:e})),this._drainInertiaBuffer();var r=this._inertia,o=this._map;if(r.length<2)o.snapToNorth({},{originalEvent:e});else{var a=r[r.length-1],s=r[0],l=o.transform.scaleZoom(i*a[1]),u=o.transform.scaleZoom(i*s[1]),c=l-u,h=(a[0]-s[0])/1e3,p=a[2];if(0!==h&&l!==u){var f=.15*c/h;Math.abs(f)>2.5&&(f=f>0?2.5:-2.5);var d=1e3*Math.abs(f/(12*.15)),m=l+f*d/2e3;m<0&&(m=0),o.easeTo({zoom:m,duration:d,easing:$n,around:this._aroundCenter?o.getCenter():o.unproject(p),noMoveStart:!0},{originalEvent:e})}else o.snapToNorth({},{originalEvent:e})}}},qn.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.default$2.now();e.length>2&&n-e[0][0]>160;)e.shift()};var Un={scrollZoom:Dn,boxZoom:Rn,dragRotate:On,dragPan:Vn,keyboard:Nn,doubleClickZoom:jn,touchZoomRotate:qn},Zn=function(e){function n(n,i){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getCenter=function(){return this.transform.center},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,i){return e=t.default.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)},n.prototype.panTo=function(e,n,i){return this.easeTo(t.extend({center:e},n),i)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.rotateTo=function(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){if("number"==typeof(n=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){var i=n.padding;n.padding={top:i,bottom:i,right:i,left:i}}if(t.default$13(Object.keys(n.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){e=Vt.convert(e);var r=[(n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2],o=Math.min(n.padding.right,n.padding.left),a=Math.min(n.padding.top,n.padding.bottom);n.offset=[n.offset[0]+r[0],n.offset[1]+r[1]];var s=t.default.convert(n.offset),l=this.transform,u=l.project(e.getNorthWest()),c=l.project(e.getSouthEast()),h=c.sub(u),p=(l.width-2*o-2*Math.abs(s.x))/h.x,f=(l.height-2*a-2*Math.abs(s.y))/h.y;if(!(f<0||p<0))return n.center=l.unproject(u.add(c).div(2)),n.zoom=Math.min(l.scaleZoom(l.scale*Math.min(p,f)),n.maxZoom),n.bearing=0,n;t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},n.prototype.fitBounds=function(e,n,i){var r=this.cameraForBounds(e,n);return r?(n=t.extend(r,n)).linear?this.easeTo(n,i):this.flyTo(n,i):this},n.prototype.jumpTo=function(e,n){this.stop();var i=this.transform,r=!1,o=!1,a=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=Ft.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(a=!0,i.pitch=+e.pitch),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var i=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var r=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,c="pitch"in e?+e.pitch:s,h=r.centerPoint.add(t.default.convert(e.offset)),p=r.pointLocation(h),f=Ft.convert(e.center||p);this._normalizeCenter(f);var d,m,y=r.project(p),g=r.project(f).sub(y),v=r.zoomScale(l-o);return e.around&&(d=Ft.convert(e.around),m=r.locationPoint(d)),this._zooming=l!==o,this._rotating=a!==u,this._pitching=c!==s,this._prepareEase(n,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(i._zooming&&(r.zoom=t.number(o,l,e)),i._rotating&&(r.bearing=t.number(a,u,e)),i._pitching&&(r.pitch=t.number(s,c,e)),d)r.setLocationAtPoint(d,m);else{var p=r.zoomScale(r.zoom-o),f=l>o?Math.min(2,v):Math.max(.5,v),_=Math.pow(f,1-e),x=r.unproject(y.add(g.mult(e*_)).mult(p));r.setLocationAtPoint(r.renderWorldCopies?x.wrap():x,h)}i._fireMoveEvents(n)},function(){e.delayEndEvents?i._easeEndTimeoutID=setTimeout(function(){return i._afterEase(n)},e.delayEndEvents):i._afterEase(n)},e),this},n.prototype._prepareEase=function(e,n){this._moving=!0,n||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e){var n=this._zooming,i=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,n&&this.fire(new t.Event("zoomend",e)),i&&this.fire(new t.Event("rotateend",e)),r&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},n.prototype.flyTo=function(e,n){function i(t){var e=(w*w-b*b+(t?-1:1)*T*T*S*S)/(2*(t?w:b)*T*S);return Math.log(Math.sqrt(e*e+1)-e)}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}var a=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var s=this.transform,l=this.getZoom(),u=this.getBearing(),c=this.getPitch(),h="zoom"in e?t.clamp(+e.zoom,s.minZoom,s.maxZoom):l,p="bearing"in e?this._normalizeBearing(e.bearing,u):u,f="pitch"in e?+e.pitch:c,d=s.zoomScale(h-l),m=s.centerPoint.add(t.default.convert(e.offset)),y=s.pointLocation(m),g=Ft.convert(e.center||y);this._normalizeCenter(g);var v=s.project(y),_=s.project(g).sub(v),x=e.curve,b=Math.max(s.width,s.height),w=b/d,S=_.mag();if("minZoom"in e){var E=t.clamp(Math.min(e.minZoom,l,h),s.minZoom,s.maxZoom),k=b/s.zoomScale(E-l);x=Math.sqrt(k/S*2)}var T=x*x,A=i(0),I=function(t){return o(A)/o(A+x*t)},z=function(t){return b*((o(A)*(r(e=A+x*t)/o(e))-r(A))/T)/S;var e},C=(i(1)-A)/x;if(Math.abs(S)<1e-6||!isFinite(C)){if(Math.abs(b-w)<1e-6)return this.easeTo(e,n);var M=w<b?-1:1;C=Math.abs(Math.log(w/b))/x,z=function(){return 0},I=function(t){return Math.exp(M*x*t)}}if("duration"in e)e.duration=+e.duration;else{var P="screenSpeed"in e?+e.screenSpeed/x:+e.speed;e.duration=1e3*C/P}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==p,this._pitching=f!==c,this._prepareEase(n,!1),this._ease(function(e){var i=e*C,r=1/I(i);s.zoom=l+s.scaleZoom(r),a._rotating&&(s.bearing=t.number(u,p,e)),a._pitching&&(s.pitch=t.number(c,f,e));var o=s.unproject(v.add(_.mult(z(i))).mult(r));s.setLocationAtPoint(s.renderWorldCopies?o.wrap():o,m),a._fireMoveEvents(n)},function(){return a._afterEase(n)},e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},n.prototype._ease=function(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.default$2.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.default$2.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),Gn=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Gn.prototype.getDefaultPosition=function(){return"bottom-right"},Gn.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Gn.prototype.onRemove=function(){dt.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Gn.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:bt.ACCESS_TOKEN}];if(t){var n=e.reduce(function(t,n,i){return n.value&&(t+=n.key+"="+n.value+(i<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+n+(this._map._hash?this._map._hash.getHashString(!0):"")}},Gn.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},Gn.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var i in n){var r=n[i].getSource();r.attribution&&t.indexOf(r.attribution)<0&&t.push(r.attribution)}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},Gn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Wn=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};Wn.prototype.onAdd=function(t){this._map=t,this._container=dt.create("div","mapboxgl-ctrl");var e=dt.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Wn.prototype.onRemove=function(){dt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Wn.prototype.getDefaultPosition=function(){return"bottom-left"},Wn.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Wn.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},Wn.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var Xn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Xn.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},Xn.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n+=1){var r=i[n];if(r.id===t)return void(r.cancelled=!0)}},Xn.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e+=1){var i=n[e];if(!i.cancelled&&(i.callback(),this._cleared))break}
this._cleared=!1,this._currentlyRunning=!1},Xn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Hn=t.default$1.HTMLImageElement,Kn=t.default$1.HTMLElement,Jn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Yn=function(e){function n(n){if(null!=(n=t.extend({},Jn,n)).minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than minZoom");var i=new In(n.minZoom,n.maxZoom,n.renderWorldCopies);e.call(this,i,n),this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=n.preserveDrawingBuffer,this._trackResize=n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=n.collectResourceTiming,this._renderTaskQueue=new Xn;var r=n.transformRequest;if(this._transformRequest=r?function(t,e){return r(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof n.container){var o=t.default$1.document.getElementById(n.container);if(!o)throw new Error("Container '"+n.container+"' not found.");this._container=o}else{if(!(n.container instanceof Kn))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==t.default$1&&(t.default$1.addEventListener("online",this._onWindowOnline,!1),t.default$1.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var n=t.getCanvasContainer(),i=null,r=!1,o=null;for(var a in Un)t[a]=new Un[a](t,e),e.interactive&&e[a]&&t[a].enable(e[a]);dt.addEventListener(n,"mouseout",function(e){t.fire(new Mn("mouseout",t,e))}),dt.addEventListener(n,"mousedown",function(i){r=!0,o=dt.mousePos(n,i);var a=new Mn("mousedown",t,i);t.fire(a),a.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))}),dt.addEventListener(n,"mouseup",function(e){var n=t.dragRotate.isActive();i&&!n&&t.fire(new Mn("contextmenu",t,i)),i=null,r=!1,t.fire(new Mn("mouseup",t,e))}),dt.addEventListener(n,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var i=e.target;i&&i!==n;)i=i.parentNode;i===n&&t.fire(new Mn("mousemove",t,e))}}),dt.addEventListener(n,"mouseover",function(e){for(var i=e.target;i&&i!==n;)i=i.parentNode;i===n&&t.fire(new Mn("mouseover",t,e))}),dt.addEventListener(n,"touchstart",function(n){var i=new Pn("touchstart",t,n);t.fire(i),i.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(n),t.touchZoomRotate.onStart(n),t.doubleClickZoom.onTouchStart(i))},{passive:!1}),dt.addEventListener(n,"touchmove",function(e){t.fire(new Pn("touchmove",t,e))},{passive:!1}),dt.addEventListener(n,"touchend",function(e){t.fire(new Pn("touchend",t,e))}),dt.addEventListener(n,"touchcancel",function(e){t.fire(new Pn("touchcancel",t,e))}),dt.addEventListener(n,"click",function(e){dt.mousePos(n,e).equals(o)&&t.fire(new Mn("click",t,e))}),dt.addEventListener(n,"dblclick",function(e){var n=new Mn("dblclick",t,e);t.fire(n),n.defaultPrevented||t.doubleClickZoom.onDblClick(n)}),dt.addEventListener(n,"contextmenu",function(e){var n=t.dragRotate.isActive();r||n?r&&(i=e):t.fire(new Mn("contextmenu",t,e)),e.preventDefault()}),dt.addEventListener(n,"wheel",function(e){var n=new Ln("wheel",t,e);t.fire(n),n.defaultPrevented||t.scrollZoom.onWheel(e)},{passive:!1})}(this,n),this._hash=n.hash&&(new Cn).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),this.resize(),n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new Gn),this.addControl(new Wn,n.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var i={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return n.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var n=t.onAdd(this),i=this._controlPositions[e];return-1!==e.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this},n.prototype.removeControl=function(t){return t.onRemove(this),this},n.prototype.resize=function(e){var n=this._containerDimensions(),i=n[0],r=n[1];return this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e))},n.prototype.getBounds=function(){var e=new Vt(this.transform.pointLocation(new t.default(0,this.transform.height)),this.transform.pointLocation(new t.default(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(e.extend(this.transform.pointLocation(new t.default(this.transform.size.x,0))),e.extend(this.transform.pointLocation(new t.default(0,this.transform.size.y)))),e},n.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new Vt([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},n.prototype.setMaxBounds=function(t){if(t){var e=Vt.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null==t&&(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},n.prototype.setMinZoom=function(t){if((t=null==t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},n.prototype.getMinZoom=function(){return this.transform.minZoom},n.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},n.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},n.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update(),this},n.prototype.getMaxZoom=function(){return this.transform.maxZoom},n.prototype.project=function(t){return this.transform.locationPoint(Ft.convert(t))},n.prototype.unproject=function(e){return this.transform.pointLocation(t.default.convert(e))},n.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},n.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},n.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},n.prototype.on=function(t,n,i){var r,o=this;if(void 0===i)return e.prototype.on.call(this,t,n);var a=function(){if("mouseenter"===t||"mouseover"===t){var e=!1;return{layer:n,listener:i,delegates:{mousemove:function(r){var a=o.getLayer(n)?o.queryRenderedFeatures(r.point,{layers:[n]}):[];a.length?e||(e=!0,i.call(o,new Mn(t,o,r.originalEvent,{features:a}))):e=!1},mouseout:function(){e=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:n,listener:i,delegates:{mousemove:function(e){(o.getLayer(n)?o.queryRenderedFeatures(e.point,{layers:[n]}):[]).length?a=!0:a&&(a=!1,i.call(o,new Mn(t,o,e.originalEvent)))},mouseout:function(e){a&&(a=!1,i.call(o,new Mn(t,o,e.originalEvent)))}}}}return{layer:n,listener:i,delegates:(r={},r[t]=function(t){var e=o.getLayer(n)?o.queryRenderedFeatures(t.point,{layers:[n]}):[];e.length&&(t.features=e,i.call(o,t),delete t.features)},r)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},n.prototype.off=function(t,n,i){if(void 0===i)return e.prototype.off.call(this,t,n);if(this._delegatedListeners&&this._delegatedListeners[t])for(var r=this._delegatedListeners[t],o=0;o<r.length;o++){var a=r[o];if(a.layer===n&&a.listener===i){for(var s in a.delegates)this.off(s,a.delegates[s]);return r.splice(o,1),this}}return this},n.prototype.queryRenderedFeatures=function(e,n){var i;return 2===arguments.length?(e=arguments[0],n=arguments[1]):1===arguments.length&&((i=arguments[0])instanceof t.default||Array.isArray(i))?(e=arguments[0],n={}):1===arguments.length?(e=void 0,n=arguments[0]):(e=void 0,n={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(e),n,this.transform):[]},n.prototype._makeQueryGeometry=function(e){var n,i=this;if(void 0===e&&(e=[t.default.convert([0,0]),t.default.convert([this.transform.width,this.transform.height])]),e instanceof t.default||"number"==typeof e[0])n=[t.default.convert(e)];else{var r=[t.default.convert(e[0]),t.default.convert(e[1])];n=[r[0],new t.default(r[1].x,r[0].y),r[1],new t.default(r[0].x,r[1].y),r[0]]}return{viewport:n,worldCoordinate:n.map(function(t){return i.transform.pointCoordinate(t)})}},n.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},n.prototype.setStyle=function(e,n){if((!n||!1!==n.diff&&!n.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new fn(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},n.prototype.getStyle=function(){if(this.style)return this.style.serialize()},n.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},n.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},n.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},n.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var i in n){var r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0},n.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},n.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},n.prototype.getSource=function(t){return this.style.getSource(t)},n.prototype.addImage=function(e,n,i){void 0===i&&(i={});var r=i.pixelRatio;void 0===r&&(r=1);var o=i.sdf;if(void 0===o&&(o=!1),n instanceof Hn){var a=t.default$2.getImageData(n),s=a.width,l=a.height,u=a.data;this.style.addImage(e,{data:new t.RGBAImage({width:s,height:l},u),pixelRatio:r,sdf:o})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=n.width,h=n.height,p=n.data;this.style.addImage(e,{data:new t.RGBAImage({width:c,height:h},new Uint8Array(p)),pixelRatio:r,sdf:o})}},n.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},n.prototype.removeImage=function(t){this.style.removeImage(t)},n.prototype.loadImage=function(e,n){t.getImage(this._transformRequest(e,t.ResourceType.Image),n)},n.prototype.listImages=function(){return this.style.listImages()},n.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},n.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},n.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},n.prototype.getLayer=function(t){return this.style.getLayer(t)},n.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},n.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0),this},n.prototype.getFilter=function(t){return this.style.getFilter(t)},n.prototype.setPaintProperty=function(t,e,n){return this.style.setPaintProperty(t,e,n),this._update(!0),this},n.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},n.prototype.setLayoutProperty=function(t,e,n){return this.style.setLayoutProperty(t,e,n),this._update(!0),this},n.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},n.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},n.prototype.getLight=function(){return this.style.getLight()},n.prototype.setFeatureState=function(t,e){this.style.setFeatureState(t,e),this._update()},n.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},n.prototype.getContainer=function(){return this._container},n.prototype.getCanvasContainer=function(){return this._canvasContainer},n.prototype.getCanvas=function(){return this._canvas},n.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},n.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.default$1.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},n.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=dt.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=dt.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=dt.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var n=this._containerDimensions();this._resizeCanvas(n[0],n[1]);var i=this._controlContainer=dt.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){r[t]=dt.create("div","mapboxgl-ctrl-"+t,i)})},n.prototype._resizeCanvas=function(e,n){var i=t.default$1.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},n.prototype._setupPainter=function(){var e=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},ft.webGLContextAttributes),n=this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);n?this.painter=new An(n,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},n.prototype._contextLost=function(e){e.preventDefault(),this._frameId&&(t.default$2.cancelFrame(this._frameId),this._frameId=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},n.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},n.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},n.prototype._update=function(t){this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender())},n.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},n.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},n.prototype._render=function(){this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var n=this.transform.zoom,i=t.default$2.now();this.style.zoomHistory.update(n,i);var r=new t.default$23(n,{now:i,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=r.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(r)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},n.prototype.remove=function(){this._hash&&this._hash.remove(),t.default$2.cancelFrame(this._frameId),this._renderTaskQueue.clear(),this._frameId=null,this.setStyle(null),void 0!==t.default$1&&(t.default$1.removeEventListener("resize",this._onWindowResize,!1),t.default$1.removeEventListener("online",this._onWindowOnline,!1));var e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),st(this._canvasContainer),st(this._controlContainer),st(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},n.prototype._rerender=function(){var e=this;this.style&&!this._frameId&&(this._frameId=t.default$2.frame(function(){e._frameId=null,e._render()}))},n.prototype._onWindowOnline=function(){this._update()},n.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(t){this._repaint=t,this._update()},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(t){this._vertices=t,this._update()},n.prototype._onData=function(e){this._update("style"===e.dataType),this.fire(new t.Event(e.dataType+"data",e))},n.prototype._onDataLoading=function(e){this.fire(new t.Event(e.dataType+"dataloading",e))},Object.defineProperties(n.prototype,i),n}(Zn),Qn={showCompass:!0,showZoom:!0},ti=function(e){var n=this;this.options=t.extend({},Qn,e),this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return n._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return n._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return n._map.resetNorth()}),this._compassArrow=dt.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};ti.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},ti.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new On(t,{button:"left",element:this._compass}),dt.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},ti.prototype.onRemove=function(){dt.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),dt.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},ti.prototype._createButton=function(t,e,n){var i=dt.create("button",t,this._container);return i.type="button",i.setAttribute("aria-label",e),i.addEventListener("click",n),i};var ei,ni={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ii=function(e){function n(n){if(e.call(this),(arguments[0]instanceof t.default$1.HTMLElement||2===arguments.length)&&(n=t.extend({element:n},arguments[1])),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._draggable=n&&n.draggable||!1,this._state="inactive",n&&n.element)this._element=n.element,this._offset=t.default.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=dt.create("div");var i=dt.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var r=dt.createNS("http://www.w3.org/2000/svg","g");r.setAttributeNS(null,"stroke","none"),r.setAttributeNS(null,"stroke-width","1"),r.setAttributeNS(null,"fill","none"),r.setAttributeNS(null,"fill-rule","evenodd");var o=dt.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");var a=dt.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"transform","translate(3.0, 29.0)"),a.setAttributeNS(null,"fill","#000000");for(var s=0,l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];s<l.length;s+=1){var u=l[s],c=dt.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",u.rx),c.setAttributeNS(null,"ry",u.ry),a.appendChild(c)}var h=dt.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);var p=dt.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(p);var f=dt.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var d=dt.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(d);var m=dt.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");var y=dt.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=dt.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var v=dt.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),y.appendChild(g),y.appendChild(v),o.appendChild(a),o.appendChild(h),o.appendChild(f),o.appendChild(m),o.appendChild(y),i.appendChild(o),this._element.appendChild(i),this._offset=t.default.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),delete this._map),dt.remove(this._element),this._popup&&this._popup.remove(),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=Ft.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},n.prototype.getElement=function(){return this._element},n.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},n.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},n.prototype.getPopup=function(){return this._popup},n.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},n.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=lt(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),dt.setTransform(this._element,ni[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),ut(this._element,this._anchor,"marker"))},n.prototype.getOffset=function(){return this._offset},n.prototype.setOffset=function(e){return this._offset=t.default.convert(e),this._update(),this},n.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},n.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},n.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},n.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},n.prototype.isDraggable=function(){return this._draggable},n}(t.Evented),ri={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},oi=function(e){function n(n){e.call(this),this.options=t.extend({},ri,n),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(e){var n;return this._map=e,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==ei?n(ei):void 0!==t.default$1.navigator.permissions?t.default$1.navigator.permissions.query({name:"geolocation"}).then(function(t){ei="denied"!==t.state,n(ei)}):(ei=!!t.default$1.navigator.geolocation,n(ei)),this._container},n.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.default$1.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),dt.remove(this._container),this._map=void 0},n.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),
this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},n.prototype._updateCamera=function(t){var e=new Ft(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy;this._map.fitBounds(e.toBounds(n),this.options.fitBoundsOptions,{geolocateSource:!0})},n.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},n.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},n.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},n.prototype._setupUI=function(e){var n=this;!1!==e&&(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=dt.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=dt.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ii(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==n._watchState||(n._watchState="BACKGROUND",n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),n.fire(new t.Event("trackuserlocationend")))}))},n.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.default$1.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.default$1.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},n.prototype._clearWatch=function(){t.default$1.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},n}(t.Evented),ai={maxWidth:100,unit:"metric"},si=function(e){this.options=t.extend({},ai,e),t.bindAll(["_onMove","setUnit"],this)};si.prototype.getDefaultPosition=function(){return"bottom-left"},si.prototype._onMove=function(){ct(this._map,this._container,this.options)},si.prototype.onAdd=function(t){return this._map=t,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},si.prototype.onRemove=function(){dt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},si.prototype.setUnit=function(t){this.options.unit=t,ct(this._map,this._container,this.options)};var li=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.default$1.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.default$1.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.default$1.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.default$1.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};li.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=dt.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},li.prototype.onRemove=function(){dt.remove(this._container),this._map=null,t.default$1.document.removeEventListener(this._fullscreenchange,this._changeIcon)},li.prototype._checkFullscreenSupport=function(){return!!(t.default$1.document.fullscreenEnabled||t.default$1.document.mozFullScreenEnabled||t.default$1.document.msFullscreenEnabled||t.default$1.document.webkitFullscreenEnabled)},li.prototype._setupUI=function(){var e=this._fullscreenButton=dt.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.default$1.document.addEventListener(this._fullscreenchange,this._changeIcon)},li.prototype._isFullscreen=function(){return this._fullscreen},li.prototype._changeIcon=function(){(t.default$1.document.fullscreenElement||t.default$1.document.mozFullScreenElement||t.default$1.document.webkitFullscreenElement||t.default$1.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},li.prototype._onClickFullscreen=function(){this._isFullscreen()?t.default$1.document.exitFullscreen?t.default$1.document.exitFullscreen():t.default$1.document.mozCancelFullScreen?t.default$1.document.mozCancelFullScreen():t.default$1.document.msExitFullscreen?t.default$1.document.msExitFullscreen():t.default$1.document.webkitCancelFullScreen&&t.default$1.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var ui={closeButton:!0,closeOnClick:!0,className:""},ci=function(e){function n(n){e.call(this),this.options=t.extend(Object.create(ui),n),t.bindAll(["_update","_onClickClose"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},n.prototype.isOpen=function(){return!!this._map},n.prototype.remove=function(){return this._content&&dt.remove(this._content),this._container&&(dt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},n.prototype.getLngLat=function(){return this._lngLat},n.prototype.setLngLat=function(t){return this._lngLat=Ft.convert(t),this._pos=null,this._update(),this},n.prototype.setText=function(e){return this.setDOMContent(t.default$1.document.createTextNode(e))},n.prototype.setHTML=function(e){var n,i=t.default$1.document.createDocumentFragment(),r=t.default$1.document.createElement("body");for(r.innerHTML=e;n=r.firstChild;)i.appendChild(n);return this.setDOMContent(i)},n.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},n.prototype._createContent=function(){this._content&&dt.remove(this._content),this._content=dt.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=dt.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},n.prototype._update=function(){var e=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=dt.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=dt.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)})),this._map.transform.renderWorldCopies&&(this._lngLat=lt(this._lngLat,this._pos,this._map.transform));var n=this._pos=this._map.project(this._lngLat),i=this.options.anchor,r=function e(n){if(n){if("number"==typeof n){var i=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.default(0,0),top:new t.default(0,n),"top-left":new t.default(i,i),"top-right":new t.default(-i,i),bottom:new t.default(0,-n),"bottom-left":new t.default(i,-i),"bottom-right":new t.default(-i,-i),left:new t.default(n,0),right:new t.default(-n,0)}}if(n instanceof t.default||Array.isArray(n)){var r=t.default.convert(n);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.default.convert(n.center||[0,0]),top:t.default.convert(n.top||[0,0]),"top-left":t.default.convert(n["top-left"]||[0,0]),"top-right":t.default.convert(n["top-right"]||[0,0]),bottom:t.default.convert(n.bottom||[0,0]),"bottom-left":t.default.convert(n["bottom-left"]||[0,0]),"bottom-right":t.default.convert(n["bottom-right"]||[0,0]),left:t.default.convert(n.left||[0,0]),right:t.default.convert(n.right||[0,0])}}return e(new t.default(0,0))}(this.options.offset);if(!i){var o,a=this._container.offsetWidth,s=this._container.offsetHeight;o=n.y+r.bottom.y<s?["top"]:n.y>this._map.transform.height-s?["bottom"]:[],n.x<a/2?o.push("left"):n.x>this._map.transform.width-a/2&&o.push("right"),i=0===o.length?"bottom":o.join("-")}var l=n.add(r[i]).round();dt.setTransform(this._container,ni[i]+" translate("+l.x+"px,"+l.y+"px)"),ut(this._container,i,"popup")}},n.prototype._onClickClose=function(){this.remove()},n}(t.Evented),hi={version:"0.46.0",supported:ft,workerCount:Math.max(Math.floor(t.default$2.hardwareConcurrency/2),1),setRTLTextPlugin:t.setRTLTextPlugin,Map:Yn,NavigationControl:ti,GeolocateControl:oi,AttributionControl:Gn,ScaleControl:si,FullscreenControl:li,Popup:ci,Marker:ii,Style:fn,LngLat:Ft,LngLatBounds:Vt,Point:t.default,Evented:t.Evented,config:bt,get accessToken(){return bt.ACCESS_TOKEN},set accessToken(t){bt.ACCESS_TOKEN=t},workerUrl:""};return hi}),i}),function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(r).remove(),t(o).each(function(){var i=t(this),r=e(i),o={relatedTarget:this};r.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(r[0],n.target)||(r.trigger(n=t.Event("hide.bs.dropdown",o)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),r.removeClass("open").trigger(t.Event("hidden.bs.dropdown",o)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof e&&i[e].call(n)})}var r=".dropdown-backdrop",o='[data-toggle="tsml-dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.7",a.prototype.toggle=function(i){var r=t(this);if(!r.is(".disabled, :disabled")){var o=e(r),a=o.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var s={relatedTarget:this};if(o.trigger(i=t.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(t.Event("shown.bs.dropdown",s))}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var r=e(i),a=r.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&r.find(o).trigger("focus"),i.trigger("click");var s=r.find(".dropdown-menu li:not(.disabled):visible a");if(s.length){var l=s.index(n.target);38==n.which&&l>0&&l--,40==n.which&&l<s.length-1&&l++,~l||(l=0),s.eq(l).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,a.prototype.toggle).on("keydown.bs.dropdown.data-api",o,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery);var infowindow,searchLocation,searchMarker,tsmlmap,markers=[],bounds,mapMode="none",locationIcon,searchIcon;jQuery(function(t){function e(){var e=[];t("#type li.active a").each(function(){t(this).attr("data-id")&&e.push(t(this).attr("data-id"))});var i={action:"meetings",query:t("#meetings #search input[name=query]").val().trim(),mode:t("#search li.active a").attr("data-id"),region:t("#region li.region.active a").attr("data-id"),district:t("#region li.district.active a").attr("data-id"),day:t("#day li.active a").attr("data-id"),time:t("#time li.active a").attr("data-id"),type:e.length?e.join(","):void 0,distance:t("#distance li.active a").attr("data-id"),view:t("#meetings .toggle-view.active").attr("data-id")};searchLocation=null,tsml.debug&&console.log("doing search"),tsml.debug&&console.log(i);var o={};if(o["tsml-day"]=i.day?i.day:"any","search"!=i.mode&&i.distance!=tsml.defaults.distance&&(o["tsml-distance"]=i.distance),i.mode&&i.mode!=tsml.defaults.mode&&(o["tsml-mode"]=i.mode),i.query&&i.query!=tsml.defaults.query&&(o["tsml-query"]=i.query),"search"==i.mode&&(i.region!=tsml.defaults.region?o["tsml-region"]=i.region:i.district!=tsml.defaults.district&&(o["tsml-district"]=i.district)),i.time&&i.time!=tsml.defaults.time&&(o["tsml-time"]=i.time),i.type&&i.type!=tsml.defaults.type&&(o["tsml-type"]=i.type),i.view!=tsml.defaults.view&&(o["tsml-view"]=i.view),o=t.param(o),history.pushState){var a=window.location.protocol+"//"+window.location.host+window.location.pathname;o.length&&(a=a+"?"+o),location.search.indexOf("post_type=tsml_meeting")>-1&&(a=a+(a.indexOf("?")>-1?"&":"?")+"post_type=tsml_meeting"),window.history.pushState({path:a},"",a)}t("#meetings").attr("data-mode",i.mode),"search"==i.mode?(u(),removeSearchMarker(),n(i)):"location"==i.mode?(l(),i.query?(t("#search button i").removeClass().addClass("glyphicon glyphicon-refresh spinning"),t.getJSON(tsml.ajaxurl,{action:"tsml_geocode",address:i.query,nonce:tsml.nonce},function(e){tsml.debug&&console.log("geocoded",e),t("#search button i").removeClass().addClass("glyphicon glyphicon-map-marker"),"error"==e.status?(removeSearchMarker(),r("loc_error")):(y.val(e.formatted_address),i.latitude=e.latitude,i.longitude=e.longitude,i.query="",searchLocation={latitude:i.latitude,longitude:i.longitude},n(i))})):r("loc_empty")):"me"==i.mode&&(i.query&&(t("#meetings #search input[name=query]").val(""),i.query=""),t("#search button i").removeClass().addClass("glyphicon glyphicon-refresh spinning"),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t("#search button i").removeClass().addClass("glyphicon glyphicon-user"),i.latitude=e.coords.latitude,i.longitude=e.coords.longitude,searchLocation={latitude:i.latitude,longitude:i.longitude},n(i)},function(){t("#search button i").removeClass().addClass("glyphicon glyphicon-user"),removeSearchMarker(),r("geo_error")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e5}):(t("#search button i").removeClass().addClass("glyphicon glyphicon-user"),removeSearchMarker(),r("geo_error_browser")))}function n(n){n.distance_units=tsml.distance_units,n.nonce=tsml.nonce,t.post(tsml.ajaxurl,n,function(a){if("object"!=typeof a)t("#meetings").addClass("empty"),r("data_error");else if(a.length){t("#meetings").removeClass("empty"),r(),locations=[];var s=t("#meetings_tbody").html("");t.each(a,function(e,r){-1!=t.inArray("M",r.types)?r.name+=" <small>"+tsml.strings.men+"</small>":-1!=t.inArray("W",r.types)&&(r.name+=" <small>"+tsml.strings.women+"</small>"),locations[r.location_id]||(locations[r.location_id]={name:r.location,formatted_address:r.formatted_address,latitude:r.latitude,longitude:r.longitude,url:r.location_url,meetings:[]}),locations[r.location_id].meetings[locations[r.location_id].meetings.length]={name:r.name,time:r.time_formatted,day:r.day,notes:r.notes,url:r.url};for(var o=r.day+"-"+("00:00"==r.time?"23:59":r.time),a=0;a<r.types.length;a++)r.types[a]=tsml.types[r.types[a]];r.types.sort(),r.types=r.types.join(", ");var l="<tr";r.notes.length&&(l+=' class="notes"'),l+=">";for(var a=0;a<tsml.columns.length;a++)switch(tsml.columns[a]){case"time":l+='<td class="time" data-sort="'+o+"-"+i(r.location)+'"><span>'+(n.day||!r.day?r.time_formatted:tsml.days[r.day]+"</span><span>"+r.time_formatted)+"</span></td>";break;case"distance":l+='<td class="distance" data-sort="'+r.distance+'">'+r.distance+" "+tsml.distance_units+"</td>";break;case"name":l+='<td class="name" data-sort="'+i(r.name)+"-"+o+'">'+formatLink(r.url,r.name,"post_type")+"</td>";break;case"location":l+='<td class="location" data-sort="'+i(r.location)+"-"+o+'">'+r.location+"</td>";break;case"address":l+='<td class="address" data-sort="'+i(r.formatted_address)+"-"+o+'">'+formatAddress(r.formatted_address,tsml.street_only)+"</td>";break;case"region":l+='<td class="region" data-sort="'+i(r.sub_region||r.region||"")+"-"+o+'">'+(r.sub_region||r.region||"")+"</td>";break;case"district":l+='<td class="district" data-sort="'+i(r.sub_district||r.district||"")+"-"+o+'">'+(r.sub_district||r.district||"")+"</td>";break;case"types":l+='<td class="types" data-sort="'+i(r.types)+"-"+o+'">'+r.types+"</td>"}s.append(l+"</tr>")}),o(),"search"==n.mode&&n.query&&t("#tsml td").not(".time").mark(n.query),"map"==n.view&&createMap(!0,locations,searchLocation)}else{if(n.query&&(void 0!==n.day||void 0!==n.region||void 0!==n.time||void 0!==n.type))return t("#day li").removeClass("active").first().addClass("active"),t("#time li").removeClass("active").first().addClass("active"),t("#region li").removeClass("active").first().addClass("active"),t("#type li").removeClass("active").first().addClass("active"),t("#day span.selected").html(t("#day li:first-child a").html()),t("#time span.selected").html(t("#time li:first-child a").html()),t("#region span.selected").html(t("#region li:first-child a").html()),t("#type span.selected").html(t("#type li:first-child a").html()),e();t("#meetings").addClass("empty"),r("no_meetings")}},"json")}function i(t){t=t.replace(/^\s+|\s+$/g,""),t=t.toLowerCase();for(var e="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc------",i=0,r=e.length;i<r;i++)t=t.replace(new RegExp(e.charAt(i),"g"),n.charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function r(e){void 0===e?t("#alert").html("").addClass("hidden"):t("#alert").html(tsml.strings[e]).removeClass("hidden")}function o(){for(var e=t("#meetings table thead th[data-sort]").first(),n=(e.attr("class"),e.attr("data-sort")),i=document.getElementById("meetings_tbody"),r=[],o=t("#meetings table thead th").index(e),a=0,s=i.rows.length;a<s;a++){var l=i.rows[a];r.push([l.cells[o].getAttribute("data-sort"),l])}r.sort(function(t,e){return t[0]>e[0]?"asc"==n?1:-1:t[0]<e[0]?"asc"==n?-1:1:0});for(var a=0,s=r.length;a<s;a++)i.appendChild(r[a][1])}function a(){var e=(new Date).getDay(),n=t("#day li.active a").first().attr("data-id"),i=t("#time li.active a").first().attr("data-id");e!=n?(t("#time li.upcoming").addClass("hidden"),"upcoming"==i&&(t("#time li.active").removeClass("active"),t("#time li").first().addClass("active"),t("#time span.selected").html(t("#time li a").first().text()))):t("#time li.upcoming").removeClass("hidden")}function s(t,e){"function"==typeof ga&&(tsml.debug&&console.log("sending "+t+": "+e+" to google analytics"),ga("send","event","12 Step Meeting List",t,e))}function l(){p&&(p=!1,t('#meetings #search input[name="query"]').typeahead("destroy"))}function u(){p||(tsml.debug&&console.log("enabling typeahead"),p=!0,t('#meetings #search input[name="query"]').typeahead({highlight:!0},{name:"tsml_regions",display:"value",source:f,templates:{header:"<h3>"+tsml.strings.regions+"</h3>"}},{name:"tsml_groups",display:"value",source:d,templates:{header:"<h3>"+tsml.strings.groups+"</h3>"}},{name:"tsml_locations",display:"value",source:m,templates:{header:"<h3>"+tsml.strings.locations+"</h3>"}}).on("typeahead:selected",function(n,i){if("region"==i.type){t("#region li").removeClass("active");var r=t('#region li a[data-id="'+i.id+'"]');r.parent().addClass("active"),t("#region span.selected").html(r.html()),t('#search input[name="query"]').val("").typeahead("val",""),s("region",r.text()),e()}else"location"==i.type?(s("location",i.value),location.href=i.url):"group"==i.type&&(s("group",i.value),e())}))}function c(t,e,n){n||(n=window.location.href);var i,r=new RegExp("([?&])"+t+"=.*?(&|#|$)(.*)","gi");if(r.test(n))return void 0!==e&&null!==e?n.replace(r,"$1"+t+"="+e+"$2$3"):(i=n.split("#"),n=i[0].replace(r,"$1$3").replace(/(&|\?)$/,""),void 0!==i[1]&&null!==i[1]&&(n+="#"+i[1]),n);if(void 0!==e&&null!==e){var o=-1!==n.indexOf("?")?"&":"?";return i=n.split("#"),n=i[0]+o+t+"="+e,void 0!==i[1]&&null!==i[1]&&(n+="#"+i[1]),n}return n}var h=t("body"),p=!1;if("object"!=typeof tsml_map){var f=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.nonword("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:tsml.ajaxurl+"?action=tsml_regions",cache:!1}}),d=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:tsml.ajaxurl+"?action=tsml_groups",cache:!1}}),m=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:tsml.ajaxurl+"?action=tsml_locations",cache:!1}});a();var y=t("#meetings #search input[name=query]");y.size()&&y.val().length&&t("#tsml td").not(".time").mark(y.val());var g=t("#search li.active a").attr("data-id");"search"==g?(u(),t('a.toggle-view[data-id="map"]').hasClass("active")&&createMap(!0,locations)):"location"==g&&y.val().length?e():"me"==g&&e()}else{void 0===tsml_map.location_url?tsml_map.location:formatLink(tsml_map.location_url,tsml_map.location,"tsml_meeting");locations={},locations[tsml_map.location_id]={latitude:tsml_map.latitude,longitude:tsml_map.longitude,formatted_address:tsml_map.formatted_address,name:tsml_map.location,meetings:[],directions:tsml_map.directions,directions_url:tsml_map.directions_url,url:tsml_map.location_url},createMap(!1,locations)}var v=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);h.on("click","a.tsml-directions",function(e){e.preventDefault();var n=(v?"maps://?":"https://maps.google.com/?")+t.param({daddr:t(this).attr("data-latitude")+","+t(this).attr("data-longitude"),saddr:"Current Location",q:t(this).attr("data-location")});window.open(n)}),t(".panel-expandable").on("click",".panel-heading",function(e){t(this).closest(".panel-expandable").toggleClass("expanded"),tsml.debug&&console.log("expanding region")}),t("#meeting #feedback").validate({onfocusout:!1,onkeyup:function(t){},highlight:function(e,n,i){t(e).parent().addClass("has-error")},unhighlight:function(e,n,i){t(e).parent().removeClass("has-error")},errorPlacement:function(t,e){},submitHandler:function(e){var n=t(e),i=n.closest("#feedback");return n.hasClass("running"),t.post(tsml.ajaxurl,n.serialize(),function(t){n.removeClass("running"),i.find(".list-group").html('<li class="list-group-item has-info">'+t+"</li>")}).fail(function(t){n.removeClass("running"),i.find(".list-group").html('<li class="list-group-item has-error">'+tsml.strings.email_not_sent+"</li>")}),n.addClass("running"),!1}}),t("#meetings table thead").on("click","th",function(){var e,n=t(this).attr("class");e=t(this).attr("data-sort")&&"asc"==t(this).attr("data-sort")?"desc":"asc",t("#meetings table thead th").removeAttr("data-sort"),t("#meetings table thead th."+n).attr("data-sort",e),o()}),t("#meetings .controls").on("submit","#search",function(){return s("search",y.val()),e(),!1}).on("click","div.expand",function(e){e.preventDefault(),e.stopPropagation(),t(this).next("ul.children").toggleClass("expanded"),t(this).toggleClass("expanded")}).on("click",".dropdown-menu a",function(n){n.preventDefault(),tsml.debug&&console.log("dropdown click");var i=t(this).closest("div").attr("id");if("mode"==i)tsml.debug&&console.log("search mode"),t("#mode li").removeClass("active"),t("#meetings").addClass("empty"),"search"==t(this).attr("data-id")?(y.prop("disabled",!1),t("#search button i").removeClass().addClass("glyphicon glyphicon-search")):"location"==t(this).attr("data-id")?(y.prop("disabled",!1),t("#search button i").removeClass().addClass("glyphicon glyphicon-map-marker"),r("loc_thinking")):"me"==t(this).attr("data-id")&&(y.prop("disabled",!0),t("#search button i").removeClass().addClass("glyphicon glyphicon-user"),r("geo_thinking")),y.attr("placeholder",t(this).text());else if("distance"==i)tsml.debug&&console.log("distance"),t("#distance li").removeClass("active"),t("#distance span.selected").html(t(this).html()),s("distance",t(this).text());else if("region"==i){if(t(this).hasClass("switch")){tsml.debug&&console.log("switching between region and district");var o=t(this).parent().hasClass("region")?"district":"region";return t(this).closest("#meetings").attr("tax-mode",o),void n.stopPropagation()}tsml.debug&&console.log("region or district"),t("#region li").removeClass("active"),t("#region span.selected").html(t(this).html()),s("region",t(this).text())}else"day"==i?(tsml.debug&&console.log("day"),t("#day li").removeClass("active"),t("#day span.selected").html(t(this).html()),s("day",t(this).text())):"time"==i?(tsml.debug&&console.log("time"),t("#time li").removeClass("active"),t("#time span.selected").html(t(this).html()),s("time",t(this).text())):"type"==i&&(tsml.debug&&console.log("type"),n.metaKey||t("#type li").removeClass("active"),s("type",t(this).text()));if(t(this).parent().toggleClass("active"),"type"==i)if(t("#type li.active a[data-id]").size()){tsml.debug&&console.log(t("#type li.active a[data-id]").size()+" types selected");var l=[];t("#type li.active a[data-id]").each(function(){l.push(t(this).text())}),t("#type span.selected").html(l.join(" + "))}else tsml.debug&&console.log("no types selected"),t("#type span.selected").html(t(this).text());var u="";t("#meetings #day li.active").index()&&(u+=t("#meetings #day span.selected").text()),t("#meetings #time li.active").index()&&(u+=" "+t("#meetings #time span.selected").text()),t("#meetings #type li.active").index()&&(u+=" "+t("#meetings #type span.selected").text()),u+=" "+tsml.program+" Meetings",t("#meetings #region li.active").index()&&(u+=" in "+t("#meetings #region span.selected").text()),document.title=u,t("#tsml #meetings .title h1").text(u),a(),e()}),t("#meetings #action .toggle-view").click(function(e){e.preventDefault();var n=t(this).attr("data-id");if(n!=t("#meetings").attr("data-view")&&(t("#meetings #action .toggle-view").toggleClass("active"),t("#meetings").attr("data-view",n),"map"==n&&createMap(!0,locations,searchLocation),history.pushState)){if(n==tsml.defaults.view)var i=c("tsml-view");else var i=c("tsml-view",n);window.history.pushState({path:i},"",i)}}),t(window).resize(function(e){if(t("#meetings").hasClass("tsml_fullscreen")){var n=map.getCenter(),i=t(window).height()-79;h.hasClass("admin-bar")&&(i-=32),t("#map").css("height",i),google.maps.event.trigger(map,"resize"),map.setCenter(n)}})});